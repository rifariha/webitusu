function _rhc_check_visibility(){jQuery(document).ready(function(e){var t=!1;e(".fullCalendar").each(function(n,a){e(a).is(":visible")&&e(a).find(".fc-content").height()<10?e(a).fullCalendar("render"):e(a).find(".fc-content").height()<10&&(t=!0)}),t&&setTimeout("_rhc_check_visibility()",300)})}function _rhc_check_init_rhc(){jQuery(".rhc_holder").each(function(e,t){return!!jQuery(this).data("Calendarize")||(init_rhc(),!1)}),setTimeout("_rhc_check_init_rhc()",1e3)}function rhc_in_array(e,t){var n=jQuery.inArray(e,t);return void 0!=n&&-1!=n}function _rhc_widget_link_click(e,t){var n=jQuery(t).data("rhc_event")||!1;if(n&&n.fc_click_target)a=n.fc_click_target;else var a="_self";if(e.event_rdate||e.gotodate){jQuery("form#calendarizeit_repeat_instance").remove();jQuery('<form id="calendarizeit_repeat_instance" method="post"></form>').attr("action",e.url).attr("target",a).appendTo("BODY"),e.gotodate&&jQuery('<input type="hidden" name="gotodate" value="'+e.gotodate+'"/>').appendTo("form#calendarizeit_repeat_instance"),e.event_rdate&&jQuery('<input type="hidden" name="event_rdate" value="'+e.event_rdate+'" />').appendTo("form#calendarizeit_repeat_instance"),jQuery("form#calendarizeit_repeat_instance").submit(function(t){t.stopPropagation();var n=e.url;return!(null==n||n.indexOf("javascript:void(0);")>0)}).submit()}else{var r=e.url;if(null!=r&&0==r.indexOf("javascript:void(0);"))return!1;"_blank"==a?window.open(r):location.href=r}return!1}function _rhc_sort_events(e,t){return e.start>t.start?1:e.start<t.start?-1:0}function fc_mouseover(e,t,n){}function fc_event_details(e,t,n){e.id=e.id.replace(/[^a-zA-Z0-9]/g,"_"),e.gcal&&e.description&&(e.description=e.description.replace(/\n/g,"<br />")),jQuery(document).ready(function(a){var r=n.calendar.options.tooltip.target||"_self";e.fc_click_target&&(r=e.fc_click_target),n.calendar.rhc_search(n.calendar,t,!0);var i="fct-"+e.id;if(a("BODY").find("#"+i).length>0&&a("BODY").find("#"+i).remove(),0==a("BODY").find("#"+i).length&&a("BODY").find("#fct-item-template").clone().attr("id",i).addClass("fct-tooltip").bind("close-tooltip",function(e){a(this).animate({opacity:0},"fast","swing",function(e){a(this).remove()})}).find(".fc-close-tooltip a").on("click",function(e){a(".fct-tooltip").trigger("close-tooltip")}).end().appendTo("BODY"),a("BODY").find("#"+i).length>0){var o=a(t.target).offset(),s=n.element.offset(),l=o.left<s.left+n.element.width()/2,d=l?"fc-tip-left":"fc-tip-right";a(".fct-tooltip:not(#"+i+")").trigger("close-tooltip");var c=a("BODY").find("#"+i);if(a("BODY").trigger("rhc_tooltip_before_show",[e,c,n]),c.stop().addClass(d).find(".fc-description").html(e.description).end().css("opacity",0).show(),e.color&&c.css("border-left-color",e.color),e.source&&e.source.fc_click_target&&"_nolink"==e.source.fc_click_target&&(e.url=!1),parseInt(n.calendar.options.tooltip.image)||(e.image=!1),e.url){var f=e.url;if(e.fc_rrule&&e.fc_rrule,tooltip_click=function(t){jQuery("form#calendarizeit_repeat_instance").remove();return jQuery('<form id="calendarizeit_repeat_instance" method="post"></form>').attr("target",r).attr("action",e.url).appendTo("BODY"),e.gotodate&&jQuery('<input type="hidden" name="gotodate" value="'+e.gotodate+'"/>').appendTo("form#calendarizeit_repeat_instance"),e.event_rdate&&jQuery('<input type="hidden" name="event_rdate" value="'+e.event_rdate+'" />').appendTo("form#calendarizeit_repeat_instance"),jQuery("form#calendarizeit_repeat_instance").submit(function(e){return e.stopPropagation(),!0}).submit(),!1},!!(n.calendar.options.tooltip&&n.calendar.options.tooltip.disableTitleLink&&"1"==n.calendar.options.tooltip.disableTitleLink)||e.gcal||"javascript:void(0);"==e.url)c.find(".fc-title").html(e.title);else if(e.direct_link)a("<a></a>").attr("href",f).html(e.title).attr("target",r).appendTo(c.find(".fc-title"));else{var u=a("<a></a>");-1!==f.indexOf(window.location.hostname)&&u.bind("click",tooltip_click),u.attr("href",f).html(e.title).html(e.title).attr("target",r).appendTo(c.find(".fc-title"))}e.image&&e.image[0]&&(disableTitleLink=void 0!==n.calendar.options.tooltip.disableTitleLink&&parseInt(n.calendar.options.tooltip.disableTitleLink),disableTitleLink?a("<img />").attr("src",e.image[0]).appendTo(c.find(".fc-image")):e.direct_link?a("<a></a>").attr("href",f).attr("target",r).append(a("<img />").attr("src",e.image[0])).appendTo(c.find(".fc-image")):a("<a></a>").attr("href",f).bind("click",tooltip_click).attr("target",r).append(a("<img />").attr("src",e.image[0])).appendTo(c.find(".fc-image")))}else c.find(".fc-title").html(e.title),e.image&&e.image[0]&&a("<img />").attr("src",e.image[0]).appendTo(c.find(".fc-image"));c.find(".fc-start,.fc-end,.fc-hide").hide(),e.allDay?(e.start&&c.find(".fc-start").append(a("<span></span>").html(a.fullCalendar.formatDate(e.start,n.calendar.options.tooltip.startDateAllDay,n.calendar.options))).show(),e.end&&c.find(".fc-end").append(a("<span></span>").html(a.fullCalendar.formatDate(e.end,n.calendar.options.tooltip.endDateAllDay||n.calendar.options.tooltip.startDateAllDay,n.calendar.options))).show()):(e.start&&c.find(".fc-start").append(a("<span></span>").html(a.fullCalendar.formatDate(e.start,n.calendar.options.tooltip.startDate,n.calendar.options))).show(),e.end&&c.find(".fc-end").append(a("<span></span>").html(a.fullCalendar.formatDate(e.end,n.calendar.options.tooltip.endDate||n.calendar.options.tooltip.startDate,n.calendar.options))).show()),e.terms&&e.terms.length>0&&a.each(e.terms,function(t,i){if(i.gaddress&&e.local_feed){var o=".fc-term-"+i.taxonomy+"-gaddress";c.find(o).find("a").length>0&&c.find(o).append('<span class="rhc-tooltip tax-term-divider"></span>'),a("<a></a>").attr("href","http://www.google.com/maps?f=q&hl=en&source=embed&q="+escape(i.gaddress)).html(i.gaddress).attr("target","_blank").appendTo(c.find(o).show())}c.find(".fc-tax-"+i.taxonomy).length>0&&(""==i.name?c.find(".fc-tax-"+i.taxonomy).hide():(c.find(".fc-tax-"+i.taxonomy).find("a").length>0&&c.find(".fc-tax-"+i.taxonomy).append('<span class="rhc-tooltip tax-term-divider"></span>'),i.gaddress&&0==e.local_feed?a("<a></a>").attr("href","http://www.google.com/maps?f=q&hl=en&source=embed&q="+escape(i.gaddress)).html(i.name).attr("target",r).appendTo(c.find(".fc-tax-"+i.taxonomy)):i.url&&""!=i.url&&n.calendar.options.tooltip.taxonomy_links?a("<a></a>").attr("href",i.url).html(i.name).attr("target",r).appendTo(c.find(".fc-tax-"+i.taxonomy)):a("<span></span>").html(i.name).appendTo(c.find(".fc-tax-"+i.taxonomy)),c.find(".fc-tax-"+i.taxonomy).find(".tax-label").html(i.taxonomy_label).end().show()))}),o.top=o.top-c.height()/2+a(t.srcElement).height()/2;var h=n.element.offset().top-o.top-5;h>0&&(o.top=o.top+h,c.find(".fct-arrow-holder").css("margin-top",-1*h)),o.left=l?o.left+a(t.target).width():o.left+-1*c.width(),"agendaDay"==n.name&&(o.left=o.left-c.width()+50),c.css("min-height","").css("height","auto").offset(o);var p=document.documentElement.clientWidth||window.innerWidth;client_right=a(document).scrollLeft()+p;var m=o.left+c.width();m>client_right&&(o.left=o.left-(m-client_right)-12,c.offset(o)),c.animate({opacity:1},"fast","swing"),c.unbind("mouseleave").bind("mouseleave",function(e){var t=this;return setTimeout(function(){if(a(t).is(":hover"))return!1;n.calendar.options.tooltip_on_hover&&"1"==n.calendar.options.tooltip_on_hover&&a(t).trigger("close-tooltip")},200),!0}),a("BODY").trigger("rhc_tooltip_after_show",[e,c,n])}})}function no_link(e,t,n){return t.stopPropagation(),!1}function fc_click_no_action(e,t,n){return t.stopPropagation(),!1}function fc_click(e,t,n){var a=e.fc_click_link?e.fc_click_link:"view";if(n&&"rhc_event"==n.name&&"view"==a&&(a="page"),"none"==a)return!1;if(void 0===e.fc_click_target&&(e.fc_click_target="_self"),e.url&&"page"==a){if("undefined"==typeof url)r=!1;else var r=-1==e.url.indexOf(window.location.hostname);return e.fc_click_target&&""!=e.fc_click_target&&!r?(fc_event_links_to_page(e,t,n),!1):(jQuery(this).prop("target",e.fc_click_target),!0)}return fc_event_details(e,t,n),!1}function fc_event_links_to_page(e,t,n){jQuery("form#calendarizeit_repeat_instance").remove();var a='<form id="calendarizeit_repeat_instance" method="post" target="'+e.fc_click_target+'"></form>';jQuery(a).attr("action",e.url).appendTo("BODY"),e.gotodate&&jQuery('<input type="hidden" name="gotodate" value="'+e.gotodate+'"/>').appendTo("form#calendarizeit_repeat_instance"),e.event_rdate&&jQuery('<input type="hidden" name="event_rdate" value="'+e.event_rdate+'" />').appendTo("form#calendarizeit_repeat_instance"),jQuery("form#calendarizeit_repeat_instance").submit(function(e){return e.stopPropagation(),!0}).submit()}function fc_select(e,t,n,a,r){jQuery(document).ready(function(e){var t=e(a.target).offset(),n=e(a.target).width();e(".fc-dialog").CalendarizeDialog("open",{offset:t,margin_left:n})})}function _add_param_to_url(e,t,n){if("javascript:void(0);"==e)return e;var a="",r=e.split("#");2==r.length?(e=r[0],hash="#"+r[1]):hash="";var o=(d=e.split("?"))[0],s=d[1],l="";if(s){var d=s.split("&");for(i=0;i<d.length;i++)d[i].split("=")[0]!=t&&(a+=l+d[i],l="&")}return o+"?"+a+(l+""+t+"="+n)+hash}function _add_repeat_instance_data_to_url(e){if(e.repeat_instance&&(e.fc_rrule&&""!=e.fc_rrule||e.fc_rdate&&""!=e.fc_rdate))if(e.using_calendar_url)(t=jQuery.fullCalendar.formatDate(e.start,"yyyy-MM-dd"))&&""!=t&&(e.url=_add_param_to_url(e.url,"gotodate",t));else if(e.src_start&&e.fc_date_time&&e.src_start==e.fc_date_time);else{var t=jQuery.fullCalendar.formatDate(e.start,"yyyyMMddHHmmss"),n=jQuery.fullCalendar.formatDate(e.end,"yyyyMMddHHmmss");t&&""!=t&&(n&&""!=n&&(t=t+","+n),e.url=""==e.url?"":_add_param_to_url(e.url,"event_rdate",t))}return e}function _add_repeat_instance_data_to_event(e){if(e.repeat_instance&&(e.fc_rrule&&""!=e.fc_rrule||e.fc_rdate&&""!=e.fc_rdate))if(e.using_calendar_url)(t=jQuery.fullCalendar.formatDate(e.start,"yyyy-MM-dd"))&&""!=t&&(e.gotodate=t);else if(e.src_start&&e.fc_date_time&&e.src_start==e.fc_date_time);else{var t=jQuery.fullCalendar.formatDate(e.start,"yyyyMMddHHmmss"),n=jQuery.fullCalendar.formatDate(e.end,"yyyyMMddHHmmss");t&&""!=t&&(n&&""!=n&&(t=t+","+n),e.event_rdate=t,e.url=""==e.url?"":_add_param_to_url(e.url,"event_rdate",e.event_rdate))}return e}function exdate_to_array_of_dates(e){if(void 0===e)return[];var t=""==e?[]:e.split(",");if(t.length>0){var n=[];for(a=0;a<t.length;a++){var r=t[a];n[n.length]=new Date(r.substring(0,4),r.substring(4,6)-1,r.substring(6,8),r.substring(9,11),r.substring(11,13),r.substring(13,15))}return n}return[]}function init_rhc(){jQuery(document).ready(function($){init_sc_ical_feed(),$("BODY").bind("dbox.loaded",function(){init_sc_ical_feed()}),$(".rhc_holder").each(function(i,el){var ui_theme=$(el).data("rhc_ui_theme");""!=ui_theme&&$("#fullcalendar-theme-css").attr("href",ui_theme);var rhc_options=$(el).data("rhc_options");eval("$(el).Calendarize("+rhc_options+")")}),$(".fc-button-custom").hover(function(){$(this).addClass("fc-state-hover")},function(){$(this).removeClass("fc-state-hover")}),$(window).resize(function(){$(".rhcalendar.not-widget .fullCalendar ").each(function(e,t){set_fc_small(t)})}),$("BODY").data("rhc_tooltip_before_show")||$("BODY").data("rhc_tooltip_before_show",!0).bind("rhc_tooltip_before_show",rhc_tooltip_before_show),$("BODY").data("rhc_tooltip_contend_loaded")||$("BODY").data("rhc_tooltip_contend_loaded",!0).bind("rhc_tooltip_contend_loaded",rhc_tooltip_contend_loaded),$(".rhc-next").on("click",function(e){})})}function init_sc_ical_feed(){jQuery(document).ready(function(e){e(".rhc-ical-feed-cont").length>0&&e(".rhc-ical-feed-cont").each(function(t,n){if("1"!=e(n).data("sc_ical_feed_init")){e(n).data("sc_ical_feed_init","1");var a=this,r=e(this).parent(),i=e(this).data("icalendar_button"),o=e(this).attr("data-theme"),s=(e(this).attr("data-title"),function(t,n){e(t).width(e(t).data("width"));var a=e(n.target).offset(),r=e(n.target).width();e(t).removeClass("ical-tooltip-holder").addClass("ical-tooltip").CalendarizeDialog("open",{offset:a,margin_left:r})});if(e(a).find(".ical-close").unbind("click").click(function(t){e(a).CalendarizeDialog("close")}),s){var l=e("<span class='fc-button fc-button-icalendar "+o+"-state-default '><span class='fc-button-inner'><span class='fc-button-content'>"+i+"</span><span class='fc-button-effect'><span></span></span></span></span>");l&&(l.click(function(e){l.hasClass(o+"-state-disabled")||s(a,e)}).mousedown(function(){l.not("."+o+"-state-active").not("."+o+"-state-disabled").addClass(o+"-state-down")}).mouseup(function(){l.removeClass(o+"-state-down")}).hover(function(){l.not("."+o+"-state-active").not("."+o+"-state-disabled").addClass(o+"-state-hover")},function(){l.removeClass(o+"-state-hover").removeClass(o+"-state-down")}).appendTo(r),l.addClass(o+"-corner-left"),l.addClass(o+"-corner-right"))}}})})}function init_rhc_date_local_tz(){jQuery(document).ready(function(e){(new Date).getTimezoneOffset();e(".rhc-local-tz .rhc_date").each(function(t,n){var a=e(n).closest(".rhc-local-tz").data("format_options");a="object"==typeof a?a:{};var r=e(n).data("udate");if(r){var i=e(n).data("fc_date_format");i&&e(n).html(jQuery.fullCalendar.formatDate(new Date(1e3*r),i,a)).addClass("rhc-local-tz-rend")}})})}function get_event_ocurrences(e){var t=jQuery.fullCalendar.parseDate(e.start);if(e.fc_rrule=""==e.fc_rrule?"FREQ=DAILY;INTERVAL=1;COUNT=1":e.fc_rrule,scheduler=new Scheduler(t,e.fc_rrule,!0),""!=e.fc_interval&&e.fc_exdate){var n=exdate_to_array_of_dates(e.fc_exdate);n.length>0&&scheduler.add_exception_dates(n)}if(e.fc_rdate&&""!=e.fc_rdate){var a=exdate_to_array_of_dates(e.fc_rdate);a.length>0&&scheduler.add_rdates(a)}occurrences=scheduler.occurrences_between(start,end)}function set_fc_small(e){if(jQuery(e).parent().hasClass("not-widget")){var t=parseInt(jQuery(e).width());if(mobile_width=RHC.mobile_width||480,t>0&&t<=mobile_width)"agendaWeek"==(n=jQuery(e).fullCalendar("getView")).name&&(jQuery(e).data("restore_agenda_week",!0),jQuery(e).fullCalendar("changeView","basicWeek")),"agendaDay"==n.name&&(jQuery(e).data("restore_agenda_day",!0),jQuery(e).fullCalendar("changeView","basicDay")),jQuery(e).parent().addClass("fc-small"),jQuery(e).find("td:first-child").each(function(e,t){jQuery(t).find("> div").css("min-height","")});else{jQuery(e).parent().removeClass("fc-small");var n=jQuery(e).fullCalendar("getView");"basicWeek"==n.name&&jQuery(e).data("restore_agenda_week")&&(jQuery(e).data("restore_agenda_week",!1),jQuery(e).fullCalendar("changeView","agendaWeek")),"basicDay"==n.name&&jQuery(e).data("restore_agenda_day")&&(jQuery(e).data("restore_agenda_day",!1),jQuery(e).fullCalendar("changeView","agendaDay"))}}}function rhc_tooltip_before_show(e,t,n,a){return jQuery(document).ready(function(r){if(a.calendar.options.tooltip.enableCustom&&t.local_feed)if(n.find(".fct-dbox").hide(),RHC.tooltip_details[t.id]&&"loading"==RHC.tooltip_details[t.id])setTimeout(function(){rhc_tooltip_before_show(e,t,n,a)},200);else if(RHC.tooltip_details[t.id]){if(!0===RHC.tooltip_details[t.id])return n.find(".fct-dbox").show(),!0;n.find(".fct-dbox").empty().show().append(RHC.tooltip_details[t.id].clone()),t.allDay?(t.start&&n.find(".postmeta-fc_start .fe-extrainfo-value,.postmeta-fc_start_datetime .fe-extrainfo-value").html(r.fullCalendar.formatDate(t.start,a.calendar.options.tooltip.startDateAllDay,a.calendar.options)),t.end&&n.find(".postmeta-fc_end .fe-extrainfo-value,.postmeta-fc_end_datetime .fe-extrainfo-value").html(r.fullCalendar.formatDate(t.end,a.calendar.options.tooltip.endDateAllDay||a.calendar.options.tooltip.startDateAllDay,a.calendar.options))):(t.start&&n.find(".postmeta-fc_start .fe-extrainfo-value,.postmeta-fc_start_datetime .fe-extrainfo-value").html(r.fullCalendar.formatDate(t.start,a.calendar.options.tooltip.startDate,a.calendar.options)),t.end&&n.find(".postmeta-fc_end .fe-extrainfo-value,.postmeta-fc_end_datetime .fe-extrainfo-value").html(r.fullCalendar.formatDate(t.end,a.calendar.options.tooltip.endDate||a.calendar.options.tooltip.startDate,a.calendar.options))),n.find(".rhc_date").each(function(e,n){field=jQuery(n).data("fc_field"),date_format=jQuery(n).data("fc_date_format"),(value=t[field])&&jQuery(n).html(jQuery.fullCalendar.formatDate(value,date_format,a.calendar.options))}),r("BODY").trigger("rhc_tooltip_contend_loaded",[e,t,n,a])}else r.post(RHC.ajaxurl,{rhc_action:"rhc_tooltip_detail",id:t.id,event_rdate:t.event_rdate},function(i){r(i).find(".fe-extrainfo-holder").length>0?(RHC.tooltip_details[t.id]=r(i).clone(),rhc_tooltip_before_show(e,t,n,a)):RHC.tooltip_details[t.id]=!0},"html")}),!0}function cb_event_mouseover(e,t,n){return jQuery(document).ready(function(t){if(n.calendar.options.tooltip.enableCustom&&e.local_feed)if(RHC.tooltip_details[e.id]);else{RHC.tooltip_details[e.id]="loading",url=RHC.ajaxurl,tmp=decodeURIComponent(url),res=tmp.split("?"),res.length>1?url=url+"&rhc_action=rhc_tooltip_detail&id="+e.id+"&event_rdate="+e.event_rdate:url=url+"?rhc_action=rhc_tooltip_detail&id="+e.id+"&event_rdate="+e.event_rdate;var a=new Date;ver=RHC.last_modified&&""!=RHC.last_modified?RHC.last_modified:a.getTime(),url=url+"&ver="+ver,queryString=url.substring(url.indexOf("?")+1),hash=CryptoJS.MD5(queryString),u=hash.toString(CryptoJS.enc.Hex),url=url+"&_="+u,t.get(url,{},function(n){t(n).find(".fe-extrainfo-holder").length>0?RHC.tooltip_details[e.id]=t(n).clone():RHC.tooltip_details[e.id]=!0},"html")}}),!0}function rhc_tooltip_contend_loaded(e){init_sc_ical_feed()}function calendar_widget_day_click(e,t,n,a,r,i,o){var s=jQuery(o).find(".rhc_calendar_widget_day_click_holder");return s.children().length>0?s.children().fadeOut("fast",function(){_calendar_widget_day_click(e,t,n,a,r,i,o)}):_calendar_widget_day_click(e,t,n,a,r,i,o),!0}function _calendar_widget_day_click(e,t,n,a,r,i,o){if(client_events=jQuery("#"+i.calendar_id).find(".fullCalendar").fullCalendar("clientEvents"),client_events.length>0){var s=[],l=[],d=jQuery.fullCalendar.cloneDate(e);d.setHours(0,0,0),jQuery.each(client_events,function(e,t){if(ev_uid=t.id+"-"+t._start.getTime(),-1==jQuery.inArray(ev_uid,s)){var n=jQuery.fullCalendar.cloneDate(t._start);n.setHours(0,0,0),n.getTime()==d.getTime()&&(s.push(ev_uid),l.push(t))}}),l.sort(_rhc_sort_events);var c=jQuery(o).find(".rhc_calendar_widget_day_click_holder"),f=jQuery(o).find(".rhc_calendar_widget_day_click_template").children();c.empty(),jQuery.each(l,function(e,t){t.fc_click_link="page";var n=f.clone();n.find(".rhc_title").append(jQuery(jQuery("<span></span>").html(t.title)).RHCLink(t,a)),jQuery(o).is(".rhc-image-full")?t.image_full&&t.image_full[0]&&n.find(".rhc_featured_image").append(jQuery(jQuery("<img />").attr("src",t.image_full[0])).RHCLink(t,a)):t.image&&t.image[0]&&n.find(".rhc_featured_image").append(jQuery(jQuery("<img />").attr("src",t.image[0])).RHCLink(t,a)),n.find(".rhc_date").each(function(e,n){field=jQuery(n).data("fc_field"),date_format=jQuery(n).data("fc_date_format"),(value=t[field])&&jQuery(n).html(jQuery.fullCalendar.formatDate(value,date_format,i))}),t.allDay&&n.find(".rhc-event-time").hide(),n.find(".rhc_description").html(t.description),t.terms&&t.terms.length>0&&jQuery.each(t.terms,function(e,t){if(n.find(".taxonomy-"+t.taxonomy).parent().find("a").length>0&&n.find(".taxonomy-"+t.taxonomy).parent().append('<span class="rhc-event-list tax-term-divider"></span>'),t.name&&""!=t.name&&n.find(".taxonomy-"+t.taxonomy).length>0&&(""==t.url?jQuery("<span>"+t.name+"</span>").appendTo(n.find(".taxonomy-"+t.taxonomy).show().parent().removeClass("rhc_event-empty-taxonomy")):jQuery("<a>"+t.name+"</a>").attr("href",t.url).appendTo(n.find(".taxonomy-"+t.taxonomy).show().parent().removeClass("rhc_event-empty-taxonomy"))),n.find(".taxonomy-"+t.taxonomy+"-gaddress").length>0&&t.gaddress&&""!=t.gaddress){n.find(".taxonomy-"+t.taxonomy+"-gaddress").parent().find("a").length>0&&n.find(".taxonomy-"+t.taxonomy+"-gaddress").parent().append('<span class="rhc-event-list tax-term-divider"></span>');var a="http://www.google.com/maps?f=q&hl=en&source=embed&q="+escape(t.gaddress);jQuery("<a>"+t.gaddress+"</a>").attr("href",a).attr("target","_blank").appendTo(n.find(".taxonomy-"+t.taxonomy+"-gaddress").show().parent().removeClass("rhc_event-empty-taxonomy").end())}});var r=t.color||t.source.color||"",s=t.textColor||t.source.textColor||"";s=s.length<=1?"#ffffff":s,r.length>1&&s.length>1&&n.find(".rhc-widget-event-list-date").css("background-color",r).css("color",s),i.widget_autoclick&&1==parseInt(i.widget_autoclick)?n.find(".rhc-widget-event-list-head").parents(".rhc-widget-event-list").addClass("open").find(".rhc-widget-event-list-body").show():n.find(".rhc-widget-event-list-head").unbind("click").bind("click",function(e){var t=jQuery(this).parents(".rhc-widget-event-list");t.toggleClass("open"),t.is(".open")?t.find(".rhc-widget-event-list-body").slideDown("fast"):t.find(".rhc-widget-event-list-body").slideUp("fast")}),i.widget_autohover&&1==parseInt(i.widget_autohover)?n.find(".rhc-widget-event-list-head").addClass("hover"):n.find(".rhc-widget-event-list-head").mouseenter(function(){jQuery(this).addClass("hover")}).mouseleave(function(){jQuery(this).removeClass("hover")});var l=t.local_id||0;if(l>0){var d=i.events_source+i.events_source_query,u=(d=d.replace("get_calendar_events","get_icalendar_events"))+"&ics=1";u=u+"&ID="+l,n.find(".rhc-icon-ical").click(function(e){window.open(u,"_self")})}t.terms&&t.terms.length>0&&jQuery.each(t.terms,function(e,a){var r=a.glon||!1,o=a.glat||!1,s=a.gaddress||!1,l="",d=n.find(".rhc-map-view"),c=d.data("size"),f=d.data("zoom"),u=d.data("maptype"),p=t.color||t.source.color||"";if(p=p.length>1?p.toUpperCase(p).replace("#","0x"):"blue",!1!==r&&!1!==o?l="http://maps.googleapis.com/maps/api/staticmap?center="+o+","+r+"&zoom="+f+"&size="+c+"&maptype="+u+"&markers=color:"+p+"%7C"+o+","+r:!1!==s&&""!=s&&(l="http://maps.googleapis.com/maps/api/staticmap?center="+escape(s)+"&zoom="+f+"&size="+c+"&maptype="+u+"&markers=color:"+p+"%7C"+escape(s)),""!=l&&"none"!=i.widget_google_map)if(n.find(".rhc-icon-map").unbind("click").bind("click",function(e){var t=n.find(".rhc-map-view .sws-gmap3-cont");if(t.data("gmap_inited"));else if(n.find(".rhc-map-view .sws-gmap3-cont").length>0){t.data("gmap_inited",!0),ratio=n.find(".rhc-map-view").data("ratio"),arr=ratio.split(":"),ratio=arr[1]/arr[0],w=n.find(".rhc-map-view").width(),h=w*ratio,t.height(h);var a=t.data("maptype"),r=t.data("uid"),i=t.data("address");return void rhc_gmap3_init({glat:t.data("glat"),glon:t.data("glon"),zoom:t.data("zoom"),disableDefaultUI:!1,map_type:google.maps.MapTypeId[a],uid:r,name:"",info_windows:"sws-gmap3-info-"+r,markers:"#sws-gmap3-marker-"+r,address:i,scrollwheel:1,traffic:!1})}jQuery(this).parents(".rhc-widget-event-list").find(".rhc-map-view").slideToggle("fast")}).show(),"static"==i.widget_google_map)""!=l&&n.find(".rhc-map-view").empty().hide().append(jQuery("<img />").attr("src",l));else if("interactive"==i.widget_google_map){var m='<div class="sws-gmap3-frame"><div id="map_canvas{uid}" class="sws-gmap3-cont"></div></div><div id="sws-gmap3-marker-{uid}" class="sws-gmap3-marker">|||::</div><div class="sws-gmap3-marker"><div id="sws-gmap3-info-{uid}" >{info_windows}</div></div>',v=t.id+"-"+t.start.getTime();m=(m=m.replace(/\{uid\}/g,v)).replace(/\{info_windows\}/g,a.name),n.find(".rhc-map-view").empty().append(m),n.find(".rhc-map-view .sws-gmap3-cont").data("glat",o).data("glon",r).data("zoom",f).data("maptype",u).data("uid",v).data("address",s)}}),"undefined"!=typeof rhp_vars&&(n.find(".rhc-icon-facebook").length>0&&n.find(".rhc-icon-facebook").show().unbind("click").bind("click",function(e){e.preventDefault(),FB.init({appId:rhp_vars.fb_appID,status:!0,cookie:!0,version:"v2.4"});var n={method:"share",href:t.url,link:t.url,name:t.title,caption:t.title,description:t.description};FB.ui(n,function(e){})}),n.find(".rhc-icon-twitter").length>0&&n.find(".rhc-icon-twitter").show().unbind("click").bind("click",function(e){encodeURIComponent(t.url),encodeURIComponent(t.description);var n="https://twitter.com/share?&url="+t.url+"&text="+t.title+"&counturl="+t.url;window.open(n,"Twitter","width=660,height=400,scrollbars=no;resizable=no")}),n.find(".rhc-icon-linkedin").length>0&&n.find(".rhc-icon-linkedin").show().unbind("click").bind("click",function(e){var n=encodeURIComponent(t.url),a="http://www.linkedin.com/shareArticle?mini=true&url="+n+"&title="+encodeURIComponent(t.title)+"&summary="+encodeURIComponent(t.description)+n+"&source="+encodeURIComponent(t.url);window.open(a,"LinkedIn","width=660,height=400,scrollbars=no;resizable=no")}),n.find(".rhc-icon-googleplus").length>0&&n.find(".rhc-icon-googleplus").show().unbind("click").bind("click",function(e){var n="https://plus.google.com/share?url="+encodeURIComponent(t.url);window.open(n,"Google+","width=660,height=400,scrollbars=no;resizable=no")})),n.hide(),c.append(n.fadeIn("fast"))}),jQuery("BODY").trigger("dbox.loaded")}}function _rhc_sort_events(e,t){return e.start>t.start?1:e.start<t.start?-1:0}function btn_tax_dropdown(e,t){}function dayclick_tooltip_evenlits(e,t,n,a,r,i){console.log("day click",e,i)}function rhc_console(){console&&console.log.apply(console,arguments)}jQuery(document).ready(function(e){RHC.visibility_check&&(jQuery(".fullCalendar").length>0&&setTimeout("_rhc_check_visibility()",200),setTimeout("_rhc_check_init_rhc()",500))}),jQuery.easing.jswing=jQuery.easing.swing,jQuery.extend(jQuery.easing,{def:"easeOutQuad",swing:function(e,t,n,a,r){return jQuery.easing[jQuery.easing.def](e,t,n,a,r)},easeInQuad:function(e,t,n,a,r){return a*(t/=r)*t+n},easeOutQuad:function(e,t,n,a,r){return-a*(t/=r)*(t-2)+n},easeInOutQuad:function(e,t,n,a,r){return(t/=r/2)<1?a/2*t*t+n:-a/2*(--t*(t-2)-1)+n},easeInCubic:function(e,t,n,a,r){return a*(t/=r)*t*t+n},easeOutCubic:function(e,t,n,a,r){return a*((t=t/r-1)*t*t+1)+n},easeInOutCubic:function(e,t,n,a,r){return(t/=r/2)<1?a/2*t*t*t+n:a/2*((t-=2)*t*t+2)+n},easeInQuart:function(e,t,n,a,r){return a*(t/=r)*t*t*t+n},easeOutQuart:function(e,t,n,a,r){return-a*((t=t/r-1)*t*t*t-1)+n},easeInOutQuart:function(e,t,n,a,r){return(t/=r/2)<1?a/2*t*t*t*t+n:-a/2*((t-=2)*t*t*t-2)+n},easeInQuint:function(e,t,n,a,r){return a*(t/=r)*t*t*t*t+n},easeOutQuint:function(e,t,n,a,r){return a*((t=t/r-1)*t*t*t*t+1)+n},easeInOutQuint:function(e,t,n,a,r){return(t/=r/2)<1?a/2*t*t*t*t*t+n:a/2*((t-=2)*t*t*t*t+2)+n},easeInSine:function(e,t,n,a,r){return-a*Math.cos(t/r*(Math.PI/2))+a+n},easeOutSine:function(e,t,n,a,r){return a*Math.sin(t/r*(Math.PI/2))+n},easeInOutSine:function(e,t,n,a,r){return-a/2*(Math.cos(Math.PI*t/r)-1)+n},easeInExpo:function(e,t,n,a,r){return 0==t?n:a*Math.pow(2,10*(t/r-1))+n},easeOutExpo:function(e,t,n,a,r){return t==r?n+a:a*(1-Math.pow(2,-10*t/r))+n},easeInOutExpo:function(e,t,n,a,r){return 0==t?n:t==r?n+a:(t/=r/2)<1?a/2*Math.pow(2,10*(t-1))+n:a/2*(2-Math.pow(2,-10*--t))+n},easeInCirc:function(e,t,n,a,r){return-a*(Math.sqrt(1-(t/=r)*t)-1)+n},easeOutCirc:function(e,t,n,a,r){return a*Math.sqrt(1-(t=t/r-1)*t)+n},easeInOutCirc:function(e,t,n,a,r){return(t/=r/2)<1?-a/2*(Math.sqrt(1-t*t)-1)+n:a/2*(Math.sqrt(1-(t-=2)*t)+1)+n},easeInElastic:function(e,t,n,a,r){var i=1.70158,o=0,s=a;if(0==t)return n;if(1==(t/=r))return n+a;if(o||(o=.3*r),s<Math.abs(a)){s=a;i=o/4}else i=o/(2*Math.PI)*Math.asin(a/s);return-s*Math.pow(2,10*(t-=1))*Math.sin((t*r-i)*(2*Math.PI)/o)+n},easeOutElastic:function(e,t,n,a,r){var i=1.70158,o=0,s=a;if(0==t)return n;if(1==(t/=r))return n+a;if(o||(o=.3*r),s<Math.abs(a)){s=a;i=o/4}else i=o/(2*Math.PI)*Math.asin(a/s);return s*Math.pow(2,-10*t)*Math.sin((t*r-i)*(2*Math.PI)/o)+a+n},easeInOutElastic:function(e,t,n,a,r){var i=1.70158,o=0,s=a;if(0==t)return n;if(2==(t/=r/2))return n+a;if(o||(o=r*(.3*1.5)),s<Math.abs(a)){s=a;i=o/4}else i=o/(2*Math.PI)*Math.asin(a/s);return t<1?s*Math.pow(2,10*(t-=1))*Math.sin((t*r-i)*(2*Math.PI)/o)*-.5+n:s*Math.pow(2,-10*(t-=1))*Math.sin((t*r-i)*(2*Math.PI)/o)*.5+a+n},easeInBack:function(e,t,n,a,r,i){return void 0==i&&(i=1.70158),a*(t/=r)*t*((i+1)*t-i)+n},easeOutBack:function(e,t,n,a,r,i){return void 0==i&&(i=1.70158),a*((t=t/r-1)*t*((i+1)*t+i)+1)+n},easeInOutBack:function(e,t,n,a,r,i){return void 0==i&&(i=1.70158),(t/=r/2)<1?a/2*(t*t*((1+(i*=1.525))*t-i))+n:a/2*((t-=2)*t*((1+(i*=1.525))*t+i)+2)+n},easeInBounce:function(e,t,n,a,r){return a-jQuery.easing.easeOutBounce(e,r-t,0,a,r)+n},easeOutBounce:function(e,t,n,a,r){return(t/=r)<1/2.75?a*(7.5625*t*t)+n:t<2/2.75?a*(7.5625*(t-=1.5/2.75)*t+.75)+n:t<2.5/2.75?a*(7.5625*(t-=2.25/2.75)*t+.9375)+n:a*(7.5625*(t-=2.625/2.75)*t+.984375)+n},easeInOutBounce:function(e,t,n,a,r){return t<r/2?.5*jQuery.easing.easeInBounce(e,2*t,0,a,r)+n:.5*jQuery.easing.easeOutBounce(e,2*t-r,0,a,r)+.5*a+n}}),Scheduler=function(e,t,n){this.test_mode=!0===n,this.start_date=e;var a=this;t=t.replace(/(UNTIL=)([^\;]{8})(?!T)/,function(e,t,n,r){return y=n.substring(0,4),m=n.substring(4,6),d=n.substring(6,8),until=new Date(y,parseInt(m)-1,d,23,59,59),v=a.timeToUntilString(until),t+v}),this.exception_dates=[],this.repeat_dates=[],this.rule=null,t&&(this.rule=RRule.fromString("DTSTART="+this.timeToUntilString(e)+";"+t),this.rule.dtstart=e)},Scheduler.prototype.timeToUntilString=function(e){for(var t,n=new Date(e),a=[n.getUTCFullYear(),n.getUTCMonth()+1,n.getUTCDate(),"T",n.getUTCHours(),n.getUTCMinutes(),n.getUTCSeconds(),"Z"],r=0;r<a.length;r++)t=a[r],!/[TZ]/.test(t)&&t<10&&(a[r]="0"+String(t));return a.join("")},Scheduler.prototype.all_occurrences=function(e,t){if(null==this.rule)return[this.start_date];var n=[];if(n=this.rule.between(new Date(e),new Date(t)),this.repeat_dates.length>0){for(o=0;o<this.repeat_dates.length;o++){var a=new Date(this.repeat_dates[o]);rhc_in_array(s,n)||n.push(a)}n.sort()}for(var r=n.length,i=[],o=0;o<r;o++){var s=(a=n[o]).getTime();rhc_in_array(s,this.exception_dates)||i.push(this.test_mode?s:a)}return i},Scheduler.prototype.occurrences_between=function(e,t){var n=e.getTime(),a=t.getTime();return this.all_occurrences(n,a)},Scheduler.prototype.limited_occurrences=function(e,t,n){var a=begin_date.getTime(),r=end_date.getTime();return this.all_occurrences(a,r).slice(0,n)},Scheduler.prototype.add_exception_dates=function(e){for(var t=e.length,n=0;n<t;n++)this.exception_dates.push(e[n].getTime());this.exception_dates.sort()},Scheduler.prototype.add_rdates=function(e){for(var t=e.length,n=0;n<t;n++)this.repeat_dates.push(e[n].getTime());this.repeat_dates.sort()},function(e){var t="undefined"!=typeof module&&module.exports,n=function(){if(!n._nlp)if(t)n._nlp=require("./nlp");else if(!(n._nlp=e._RRuleNLP))throw new Error("You need to include rrule/nlp.js for fromText/toText to work.");return n._nlp},a={MONTH_DAYS:[31,28,31,30,31,30,31,31,30,31,30,31],ONE_DAY:864e5,MAXYEAR:9999,ORDINAL_BASE:new Date(1970,0,1),PY_WEEKDAYS:[6,0,1,2,3,4,5],getYearDay:function(e){var t=new Date(e.getFullYear(),e.getMonth(),e.getDate());return Math.ceil((t-new Date(e.getFullYear(),0,1))/a.ONE_DAY)+1},isLeapYear:function(e){return e instanceof Date&&(e=e.getFullYear()),e%4==0&&e%100!=0||e%400==0},tzOffset:function(e){return 60*e.getTimezoneOffset()*1e3},daysBetween:function(e,t){var n=e.getTime()-a.tzOffset(e),r=t.getTime()-a.tzOffset(t),i=Math.abs(n-r);return Math.round(i/a.ONE_DAY)},toOrdinal:function(e){return a.daysBetween(e,a.ORDINAL_BASE)},fromOrdinal:function(e){var t=e*a.ONE_DAY;return new Date(a.ORDINAL_BASE.getTime()-a.tzOffset(a.ORDINAL_BASE)+t+a.tzOffset(new Date(t)))},monthRange:function(e,t){var n=new Date(e,t,1);return[a.getWeekday(n),a.getMonthDays(n)]},getMonthDays:function(e){var t=e.getMonth();return 1==t&&a.isLeapYear(e)?29:a.MONTH_DAYS[t]},getWeekday:function(e){return a.PY_WEEKDAYS[e.getDay()]},combine:function(e,t){return t=t||e,new Date(e.getFullYear(),e.getMonth(),e.getDate(),t.getHours(),t.getMinutes(),t.getSeconds())},clone:function(e){var t=new Date(e.getTime());return t.setMilliseconds(0),t},cloneDates:function(e){for(var t=[],n=0;n<e.length;n++)t.push(a.clone(e[n]));return t},sort:function(e){e.sort(function(e,t){return e.getTime()-t.getTime()})},timeToUntilString:function(e){for(var t,n=new Date(e),a=[n.getUTCFullYear(),n.getUTCMonth()+1,n.getUTCDate(),"T",n.getUTCHours(),n.getUTCMinutes(),n.getUTCSeconds(),"Z"],r=0;r<a.length;r++)t=a[r],!/[TZ]/.test(t)&&t<10&&(a[r]="0"+String(t));return a.join("")},untilStringToDate:function(e){var t=/^(\d{4})(\d{2})(\d{2})(T(\d{2})(\d{2})(\d{2})Z)?$/.exec(e);if(!t)throw new Error("Invalid UNTIL value: "+e);return new Date(Date.UTC(t[1],t[2]-1,t[3],t[5]||0,t[6]||0,t[7]||0))}};a.Time=function(e,t,n){this.hour=e,this.minute=t,this.second=n},a.Time.prototype={getHours:function(){return this.hour},getMinutes:function(){return this.minute},getSeconds:function(){return this.second},getTime:function(){return 1e3*(60*this.hour*60+60*this.minute+this.second)}};var r=function(e,t){1===arguments.length&&(t=e,e=0);for(var n=[],a=e;a<t;a++)n.push(a);return n},i=function(e,t){var n=0,a=[];if(e instanceof Array)for(;n<t;n++)a[n]=[].concat(e);else for(;n<t;n++)a[n]=e;return a},o=function(e,t){var n=e%t;return n*t<0?n+t:n},s=function(e,t){return{div:Math.floor(e/t),mod:o(e,t)}},l=function(e){return!(e instanceof Array&&0==e.length)&&Boolean(e)},d=function(e,t){return-1!=e.indexOf(t)},c=[].concat(i(1,31),i(2,28),i(3,31),i(4,30),i(5,31),i(6,30),i(7,31),i(8,31),i(9,30),i(10,31),i(11,30),i(12,31),i(1,7)),f=[].concat(i(1,31),i(2,29),i(3,31),i(4,30),i(5,31),i(6,30),i(7,31),i(8,31),i(9,30),i(10,31),i(11,30),i(12,31),i(1,7)),u=r(1,29),h=r(1,30),p=r(1,31),m=r(1,32),v=[].concat(m,h,m,p,m,p,m,m,p,m,p,m,m.slice(0,7)),g=[].concat(m,u,m,p,m,p,m,m,p,m,p,m,m.slice(0,7));u=r(-28,0),h=r(-29,0),p=r(-30,0),m=r(-31,0);var y=[].concat(m,h,m,p,m,p,m,m,p,m,p,m,m.slice(0,7)),_=[].concat(m,u,m,p,m,p,m,m,p,m,p,m,m.slice(0,7)),w=[0,31,60,91,121,152,182,213,244,274,305,335,366],b=[0,31,59,90,120,151,181,212,243,273,304,334,365],k=function(){for(var e=[],t=0;t<55;t++)e=e.concat(r(7));return e}(),C=function(e,t){if(0===t)throw new Error("Can't create weekday with n == 0");this.weekday=e,this.n=t};C.prototype={nth:function(e){return this.n==e?this:new C(this.weekday,e)},equals:function(e){return this.weekday==e.weekday&&this.n==e.n},toString:function(){var e=["MO","TU","WE","TH","FR","SA","SU"][this.weekday];return this.n&&(e=(this.n>0?"+":"")+String(this.n)+e),e},getJsWeekday:function(){return 6==this.weekday?0:this.weekday+1}};var x=function(e,t){this._string=null,e=e||{},this._cache=t?null:{all:!1,before:[],after:[],between:[]},this.origOptions={};var n=[],r=Object.keys(e),i=Object.keys(x.DEFAULT_OPTIONS);if(r.forEach(function(t){this.origOptions[t]=e[t],d(i,t)||n.push(t)},this),n.length)throw new Error("Invalid options: "+n.join(", "));if(!x.FREQUENCIES[e.freq]&&null===e.byeaster)throw new Error("Invalid frequency: "+String(e.freq));i.forEach(function(t){d(r,t)||(e[t]=x.DEFAULT_OPTIONS[t])});var o=this.options=e;if(null!==o.byeaster&&(o.freq=x.YEARLY),o.dtstart||(o.dtstart=new Date,o.dtstart.setMilliseconds(0)),null===o.wkst?o.wkst=x.MO.weekday:"number"==typeof o.wkst||(o.wkst=o.wkst.weekday),null!==o.bysetpos){"number"==typeof o.bysetpos&&(o.bysetpos=[o.bysetpos]);for(var s=0;s<o.bysetpos.length;s++)if(0==(u=o.bysetpos[s])||!(-366<=u&&u<=366))throw new Error("bysetpos must be between 1 and 366, or between -366 and -1")}if(!(l(o.byweekno)||l(o.byyearday)||l(o.bymonthday)||null!==o.byweekday||null!==o.byeaster))switch(o.freq){case x.YEARLY:o.bymonth||(o.bymonth=o.dtstart.getMonth()+1),o.bymonthday=o.dtstart.getDate();break;case x.MONTHLY:o.bymonthday=o.dtstart.getDate();break;case x.WEEKLY:o.byweekday=a.getWeekday(o.dtstart)}if(null===o.bymonth||o.bymonth instanceof Array||(o.bymonth=[o.bymonth]),null===o.byyearday||o.byyearday instanceof Array||(o.byyearday=[o.byyearday]),null===o.bymonthday)o.bymonthday=[],o.bynmonthday=[];else if(o.bymonthday instanceof Array){var c=[],f=[];for(s=0;s<o.bymonthday.length;s++){var u=o.bymonthday[s];u>0?c.push(u):u<0&&f.push(u)}o.bymonthday=c,o.bynmonthday=f}else o.bymonthday<0?(o.bynmonthday=[o.bymonthday],o.bymonthday=[]):(o.bynmonthday=[],o.bymonthday=[o.bymonthday]);if(null===o.byweekno||o.byweekno instanceof Array||(o.byweekno=[o.byweekno]),null===o.byweekday)o.bynweekday=null;else if("number"==typeof o.byweekday)o.byweekday=[o.byweekday],o.bynweekday=null;else if(o.byweekday instanceof C)!o.byweekday.n||o.freq>x.MONTHLY?(o.byweekday=[o.byweekday.weekday],o.bynweekday=null):(o.bynweekday=[[o.byweekday.weekday,o.byweekday.n]],o.byweekday=null);else{var h=[],p=[];for(s=0;s<o.byweekday.length;s++){var m=o.byweekday[s];"number"==typeof m?h.push(m):!m.n||o.freq>x.MONTHLY?h.push(m.weekday):p.push([m.weekday,m.n])}o.byweekday=l(h)?h:null,o.bynweekday=l(p)?p:null}if(null===o.byhour?o.byhour=o.freq<x.HOURLY?[o.dtstart.getHours()]:null:"number"==typeof o.byhour&&(o.byhour=[o.byhour]),null===o.byminute?o.byminute=o.freq<x.MINUTELY?[o.dtstart.getMinutes()]:null:"number"==typeof o.byminute&&(o.byminute=[o.byminute]),null===o.bysecond?o.bysecond=o.freq<x.SECONDLY?[o.dtstart.getSeconds()]:null:"number"==typeof o.bysecond&&(o.bysecond=[o.bysecond]),o.freq>=x.HOURLY)this.timeset=null;else{for(this.timeset=[],s=0;s<o.byhour.length;s++)for(var v=o.byhour[s],g=0;g<o.byminute.length;g++)for(var y=o.byminute[g],_=0;_<o.bysecond.length;_++){var w=o.bysecond[_];this.timeset.push(new a.Time(v,y,w))}a.sort(this.timeset)}};x.FREQUENCIES=["YEARLY","MONTHLY","WEEKLY","DAILY","HOURLY","MINUTELY","SECONDLY"],x.YEARLY=0,x.MONTHLY=1,x.WEEKLY=2,x.DAILY=3,x.HOURLY=4,x.MINUTELY=5,x.SECONDLY=6,x.MO=new C(0),x.TU=new C(1),x.WE=new C(2),x.TH=new C(3),x.FR=new C(4),x.SA=new C(5),x.SU=new C(6),x.DEFAULT_OPTIONS={freq:null,dtstart:null,interval:1,wkst:x.MO,count:null,until:null,bysetpos:null,bymonth:null,bymonthday:null,bynmonthday:null,byyearday:null,byweekno:null,byweekday:null,bynweekday:null,byhour:null,byminute:null,bysecond:null,byeaster:null},x.parseText=function(e,t){return n().parseText(e,t)},x.fromText=function(e,t){return n().fromText(e,t)},x.optionsToString=function(e){var t,n,r,i,o,s=[];n=Object.keys(e),r=Object.keys(x.DEFAULT_OPTIONS);for(u=0;u<n.length;u++)if(d(r,n[u])&&(t=n[u].toUpperCase(),i=e[n[u]],o=[],!(null===i||i instanceof Array&&!i.length))){switch(t){case"FREQ":i=x.FREQUENCIES[e.freq];break;case"WKST":i=i.toString();break;case"BYWEEKDAY":t="BYDAY",i instanceof Array||(i=[i]);for(var l,c=0;c<i.length;c++)(l=i[c])instanceof C||(l=l instanceof Array?new C(l[0],l[1]):new C(l)),o[c]=l.toString();i=o;break;case"DTSTART":case"UNTIL":i=a.timeToUntilString(i);break;default:if(i instanceof Array){for(c=0;c<i.length;c++)o[c]=String(i[c]);i=o}else i=String(i)}s.push([t,i])}for(var f=[],u=0;u<s.length;u++){var h=s[u];f.push(h[0]+"="+h[1].toString())}return f.join(";")},x.prototype={all:function(e){if(e)return this._iter(new M("all",{},e));var t=this._cacheGet("all");return!1===t&&(t=this._iter(new T("all",{})),this._cacheAdd("all",t)),t},between:function(e,t,n,a){var r={before:t,after:e,inc:n};if(a)return this._iter(new M("between",r,a));var i=this._cacheGet("between",r);return!1===i&&(i=this._iter(new T("between",r)),this._cacheAdd("between",i,r)),i},before:function(e,t){var n={dt:e,inc:t},a=this._cacheGet("before",n);return!1===a&&(a=this._iter(new T("before",n)),this._cacheAdd("before",a,n)),a},after:function(e,t){var n={dt:e,inc:t},a=this._cacheGet("after",n);return!1===a&&(a=this._iter(new T("after",n)),this._cacheAdd("after",a,n)),a},count:function(){return this.all().length},toString:function(){return x.optionsToString(this.origOptions)},toText:function(e,t){return n().toText(this,e,t)},isFullyConvertibleToText:function(){return n().isFullyConvertible(this)},_cacheAdd:function(e,t,n){this._cache&&(t&&(t=t instanceof Date?a.clone(t):a.cloneDates(t)),"all"==e?this._cache.all=t:(n._value=t,this._cache[e].push(n)))},_cacheGet:function(e,t){if(!this._cache)return!1;var n=!1;if("all"==e)n=this._cache.all;else e:for(var r,i=0;i<this._cache[e].length;i++){r=this._cache[e][i];for(var o in t)if(t.hasOwnProperty(o)&&String(t[o])!=String(r[o]))continue e;n=r._value;break}if(!n&&this._cache.all){for(var s=new T(e,t),i=0;i<this._cache.all.length&&s.accept(this._cache.all[i]);i++);n=s.getValue(),this._cacheAdd(e,n,t)}return n instanceof Array?a.cloneDates(n):n instanceof Date?a.clone(n):n},clone:function(){return new x(this.origOptions)},_iter:function(e){var t=this.options.dtstart,n=t.getFullYear(),r=t.getMonth()+1,i=t.getDate(),c=t.getHours(),f=t.getMinutes(),u=t.getSeconds(),h=a.getWeekday(t),p=(a.getYearDay(t),this.options.freq),m=this.options.interval,v=this.options.wkst,g=this.options.until,y=this.options.bymonth,_=this.options.byweekno,w=this.options.byyearday,b=this.options.byweekday,k=this.options.byeaster,C=this.options.bymonthday,T=this.options.bynmonthday,M=this.options.bysetpos,$=this.options.byhour,E=this.options.byminute,S=this.options.bysecond,O=new D(this);O.rebuild(n,r);var j={};j[x.YEARLY]=O.ydayset,j[x.MONTHLY]=O.mdayset,j[x.WEEKLY]=O.wdayset,j[x.DAILY]=O.ddayset,j[x.HOURLY]=O.ddayset,j[x.MINUTELY]=O.ddayset,j[x.SECONDLY]=O.ddayset,j=j[p];var L;if(p<x.HOURLY)L=this.timeset;else{var R={};R[x.HOURLY]=O.htimeset,R[x.MINUTELY]=O.mtimeset,R[x.SECONDLY]=O.stimeset,R=R[p],L=p>=x.HOURLY&&l($)&&!d($,c)||p>=x.MINUTELY&&l(E)&&!d(E,f)||p>=x.SECONDLY&&l(S)&&!d(S,f)?[]:R.call(O,c,f,u)}for(var I,H,A,z,Y,N,Q,F,W,B,q,U,P,V=0,K=this.options.count;;){for(B=(F=j.call(O,n,r,i))[0],q=F[1],U=F[2],I=!1,A=q;A<U;A++)H=B[A],(l(y)&&!d(y,O.mmask[H])||l(_)&&!O.wnomask[H]||l(b)&&!d(b,O.wdaymask[H])||l(O.nwdaymask)&&!O.nwdaymask[H]||null!==k&&!d(O.eastermask,H)||(l(C)||l(T))&&!d(C,O.mdaymask[H])&&!d(T,O.nmdaymask[H])||l(w)&&(H<O.yearlen&&!d(w,H+1)&&!d(w,-O.yearlen+H)||H>=O.yearlen&&!d(w,H+1-O.yearlen)&&!d(w,-O.nextyearlen+H-O.yearlen)))&&(B[H]=null,I=!0);if(l(M)&&l(L)){var J,G,Z=[];for(A=0;A<M.length;A++){(W=M[A])<0?(J=Math.floor(W/L.length),G=o(W,L.length)):(J=Math.floor((W-1)/L.length),G=o(W-1,L.length));try{for(F=[],z=q;z<U;z++){var X=B[z];null!==X&&F.push(X)}H=J<0?F.slice(J)[0]:F[J];var ee=L[G],te=a.fromOrdinal(O.yearordinal+H),ne=a.combine(te,ee);d(Z,ne)||Z.push(ne)}catch(e){}}for(a.sort(Z),A=0;A<Z.length;A++){ne=Z[A];if(g&&ne>g)return this._len=V,e.getValue();if(ne>=t){if(++V,!e.accept(ne))return e.getValue();if(K&&!--K)return this._len=V,e.getValue()}}}else for(A=q;A<U;A++)if(null!==(H=B[A])){te=a.fromOrdinal(O.yearordinal+H);for(z=0;z<L.length;z++){var ee=L[z],ne=a.combine(te,ee);if(g&&ne>g)return this._len=V,e.getValue();if(ne>=t){if(++V,!e.accept(ne))return e.getValue();if(K&&!--K)return this._len=V,e.getValue()}}}if(P=!1,p==x.YEARLY){if((n+=m)>a.MAXYEAR)return this._len=V,e.getValue();O.rebuild(n,r)}else if(p==x.MONTHLY){if((r+=m)>12&&(N=Math.floor(r/12),Q=o(r,12),r=Q,n+=N,0==r&&(r=12,--n),n>a.MAXYEAR))return this._len=V,e.getValue();O.rebuild(n,r)}else if(p==x.WEEKLY)i+=v>h?7*m-(h+1+(6-v)):7*m-(h-v),h=v,P=!0;else if(p==x.DAILY)i+=m,P=!0;else if(p==x.HOURLY){for(I&&(c+=Math.floor((23-c)/m)*m);;)if(c+=m,Y=s(c,24),N=Y.div,Q=Y.mod,N&&(c=Q,i+=N,P=!0),!l($)||d($,c))break;L=R.call(O,c,f,u)}else if(p==x.MINUTELY){for(I&&(f+=Math.floor((1439-(60*c+f))/m)*m);;)if(f+=m,Y=s(f,60),N=Y.div,Q=Y.mod,N&&(f=Q,N=(Y=s(c+=N,24)).div,Q=Y.mod,N&&(c=Q,i+=N,P=!0,I=!1)),(!l($)||d($,c))&&(!l(E)||d(E,f)))break;L=R.call(O,c,f,u)}else if(p==x.SECONDLY){for(I&&(u+=Math.floor((86399-(3600*c+60*f+u))/m)*m);;)if(u+=m,Y=s(u,60),N=Y.div,Q=Y.mod,N&&(u=Q,N=(Y=s(f+=N,60)).div,Q=Y.mod,N&&(f=Q,N=(Y=s(c+=N,24)).div,Q=Y.mod,N&&(c=Q,i+=N,P=!0))),(!l($)||d($,c))&&(!l(E)||d(E,f))&&(!l(S)||d(S,u)))break;L=R.call(O,c,f,u)}if(P&&i>28){var ae=a.monthRange(n,r-1)[1];if(i>ae){for(;i>ae;){if(i-=ae,13==++r&&(r=1,++n>a.MAXYEAR))return this._len=V,e.getValue();ae=a.monthRange(n,r-1)[1]}O.rebuild(n,r)}}}}},x.parseString=function(e){if(!(e=e.replace(/^\s+|\s+$/,"")).length)return null;var t,n,r,i,o,s=e.split(";"),l={};for(t=0;t<s.length;t++)switch(o=s[t].split("="),r=o[0],i=o[1],r){case"FREQ":l.freq=x[i];break;case"WKST":l.wkst=x[i];break;case"COUNT":case"INTERVAL":case"BYSETPOS":case"BYMONTH":case"BYMONTHDAY":case"BYYEARDAY":case"BYWEEKNO":case"BYHOUR":case"BYMINUTE":case"BYSECOND":if(-1!=i.indexOf(","))for(i=i.split(","),n=0;n<i.length;n++)/^[+-]?\d+$/.test(i[n])&&(i[n]=Number(i[n]));else/^[+-]?\d+$/.test(i)&&(i=Number(i));l[r=r.toLowerCase()]=i;break;case"BYDAY":var d,c,f,u=i.split(",");for(l.byweekday=[],n=0;n<u.length;n++)2==(f=u[n]).length?(c=x[f],l.byweekday.push(c)):(f=f.match(/^([+-]?\d)([A-Z]{2})$/),d=Number(f[1]),c=f[2],c=x[c].weekday,l.byweekday.push(new C(c,d)));break;case"DTSTART":l.dtstart=a.untilStringToDate(i);break;case"UNTIL":l.until=a.untilStringToDate(i);break;case"BYEASTER":l.byeaster=Number(i);break;default:throw new Error("Unknown RRULE property '"+r+"'")}return l},x.fromString=function(e){return new x(x.parseString(e))};var D=function(e){this.rrule=e,this.lastyear=null,this.lastmonth=null,this.yearlen=null,this.nextyearlen=null,this.yearordinal=null,this.yearweekday=null,this.mmask=null,this.mrange=null,this.mdaymask=null,this.nmdaymask=null,this.wdaymask=null,this.wnomask=null,this.nwdaymask=null,this.eastermask=null};D.prototype.easter=function(e,t){t=t||0;var n=e%19,a=Math.floor(e/100),r=e%100,i=Math.floor(a/4),o=a%4,s=Math.floor((a+8)/25),l=Math.floor((a-s+1)/3),d=Math.floor(19*n+a-i-l+15)%30,c=Math.floor(r/4),f=r%4,u=Math.floor(32+2*o+2*c-d-f)%7,h=Math.floor((n+11*d+22*u)/451),p=Math.floor((d+u-7*h+114)/31),m=(d+u-7*h+114)%31+1,v=Date.UTC(e,p-1,m+t),g=Date.UTC(e,0,1);return[Math.ceil((v-g)/864e5)]},D.prototype.rebuild=function(e,t){var n=this.rrule;if(e!=this.lastyear){this.yearlen=a.isLeapYear(e)?366:365,this.nextyearlen=a.isLeapYear(e+1)?366:365;var r=new Date(e,0,1);this.yearordinal=a.toOrdinal(r),this.yearweekday=a.getWeekday(r);A=a.getWeekday(new Date(e,0,1));if(365==this.yearlen?(this.mmask=[].concat(c),this.mdaymask=[].concat(g),this.nmdaymask=[].concat(_),this.wdaymask=k.slice(A),this.mrange=[].concat(b)):(this.mmask=[].concat(f),this.mdaymask=[].concat(v),this.nmdaymask=[].concat(y),this.wdaymask=k.slice(A),this.mrange=[].concat(w)),l(n.options.byweekno)){this.wnomask=i(0,this.yearlen+7);var s,u,h;(s=u=o(7-this.yearweekday+n.options.wkst,7))>=4?(s=0,h=this.yearlen+o(this.yearweekday-n.options.wkst,7)):h=this.yearlen-s;for(var p,m=Math.floor(h/7),C=o(h,7),D=Math.floor(m+C/4),T=0;T<n.options.byweekno.length;T++)if((p=n.options.byweekno[T])<0&&(p+=D+1),0<p&&p<=D){p>1?(O=s+7*(p-1),s!=u&&(O-=7-u)):O=s;for(H=0;H<7&&(this.wnomask[O]=1,O++,this.wdaymask[O]!=n.options.wkst);H++);}if(d(n.options.byweekno,1)){O=s+7*D;if(s!=u&&(O-=7-u),O<this.yearlen)for(T=0;T<7&&(this.wnomask[O]=1,O+=1,this.wdaymask[O]!=n.options.wkst);T++);}if(s){var M;if(d(n.options.byweekno,-1))M=-1;else{var $=a.getWeekday(new Date(e-1,0,1)),E=o(7-$+n.options.wkst,7),S=a.isLeapYear(e-1)?366:365;E>=4?(E=0,M=Math.floor(52+o(S+o($-n.options.wkst,7),7)/4)):M=Math.floor(52+o(this.yearlen-s,7)/4)}if(d(n.options.byweekno,M))for(var O=0;O<s;O++)this.wnomask[O]=1}}else this.wnomask=null}if(l(n.options.bynweekday)&&(t!=this.lastmonth||e!=this.lastyear)){var j=[];if(n.options.freq==x.YEARLY)if(l(n.options.bymonth))for(T=0;T<n.options.bymonth.length;T++)t=n.options.bymonth[T],j.push(this.mrange.slice(t-1,t+1));else j=[[0,this.yearlen]];else n.options.freq==x.MONTHLY&&(j=[this.mrange.slice(t-1,t+1)]);if(l(j)){this.nwdaymask=i(0,this.yearlen);for(T=0;T<j.length;T++){var L=j[T],R=L[0],I=L[1];I-=1;for(var H=0;H<n.options.bynweekday.length;H++){var A=n.options.bynweekday[H][0];(p=n.options.bynweekday[H][1])<0?(O=I+7*(p+1),O-=o(this.wdaymask[O]-A,7)):(O=R+7*(p-1),O+=o(7-this.wdaymask[O]+A,7)),R<=O&&O<=I&&(this.nwdaymask[O]=1)}}}this.lastyear=e,this.lastmonth=t}null!==n.options.byeaster&&(this.eastermask=this.easter(e,n.options.byeaster))},D.prototype.ydayset=function(e,t,n){return[r(this.yearlen),0,this.yearlen]},D.prototype.mdayset=function(e,t,n){for(var a=i(null,this.yearlen),r=this.mrange[t-1],o=this.mrange[t],s=r;s<o;s++)a[s]=s;return[a,r,o]},D.prototype.wdayset=function(e,t,n){for(var r=i(null,this.yearlen+7),o=a.toOrdinal(new Date(e,t-1,n))-this.yearordinal,s=o,l=0;l<7&&(r[o]=o,++o,this.wdaymask[o]!=this.rrule.options.wkst);l++);return[r,s,o]},D.prototype.ddayset=function(e,t,n){var r=i(null,this.yearlen),o=a.toOrdinal(new Date(e,t-1,n))-this.yearordinal;return r[o]=o,[r,o,o+1]},D.prototype.htimeset=function(e,t,n){for(var r=[],i=this.rrule,o=0;o<i.options.byminute.length;o++){t=i.options.byminute[o];for(var s=0;s<i.options.bysecond.length;s++)n=i.options.bysecond[s],r.push(new a.Time(e,t,n))}return a.sort(r),r},D.prototype.mtimeset=function(e,t,n){for(var r=[],i=this.rrule,o=0;o<i.options.bysecond.length;o++)n=i.options.bysecond[o],r.push(new a.Time(e,t,n));return a.sort(r),r},D.prototype.stimeset=function(e,t,n){return[new a.Time(e,t,n)]};var T=function(e,t){this.init(e,t)};T.prototype={init:function(e,t){this.method=e,this.args=t,this._result=[],this.minDate=null,this.maxDate=null,"between"==e?(this.maxDate=t.inc?t.before:new Date(t.before.getTime()-1),this.minDate=t.inc?t.after:new Date(t.after.getTime()+1)):"before"==e?this.maxDate=t.inc?t.dt:new Date(t.dt.getTime()-1):"after"==e&&(this.minDate=t.inc?t.dt:new Date(t.dt.getTime()+1))},accept:function(e){var t=this.minDate&&e<this.minDate,n=this.maxDate&&e>this.maxDate;if("between"==this.method){if(t)return!0;if(n)return!1}else if("before"==this.method){if(n)return!1}else if("after"==this.method)return!!t||(this.add(e),!1);return this.add(e)},add:function(e){return this._result.push(e),!0},getValue:function(){switch(this.method){case"all":case"between":return this._result;case"before":case"after":return this._result.length?this._result[this._result.length-1]:null}}};var M=function(e,t,n){if(!d(["all","between"],e))throw new Error('Invalid method "'+e+'". Only all and between works with iterator.');this.add=function(e){return!!n(e,this._result.length)&&(this._result.push(e),!0)},this.init(e,t)};M.prototype=T.prototype,t&&(module.exports={RRule:x}),"undefined"==typeof ender&&(e.RRule=x),"function"==typeof define&&define.amd&&define("rrule",[],function(){return x})}(this),function(e){var t,n="undefined"!=typeof module&&module.exports;if(n)t=require("./rrule").RRule;else if(e.RRule)t=e.RRule;else{if("undefined"==typeof require)throw new Error("rrule.js is required for rrule/nlp.js to work");t||(t=require("rrule"))}var a=function(e,t){return-1!=e.indexOf(t)},r=function(e,t,n){if(this.gettext=t||function(e){return e},this.language=n||l,this.text="",this.rrule=e,this.freq=e.options.freq,this.options=e.options,this.origOptions=e.origOptions,this.origOptions.bymonthday){var a=[].concat(this.options.bymonthday),r=[].concat(this.options.bynmonthday);a.sort(),r.sort(),r.reverse(),this.bymonthday=a.concat(r),this.bymonthday.length||(this.bymonthday=null)}if(this.origOptions.byweekday){var i=this.origOptions.byweekday instanceof Array?this.origOptions.byweekday:[this.origOptions.byweekday],o=String(i);this.byweekday={allWeeks:i.filter(function(e){return!Boolean(e.n)}),someWeeks:i.filter(function(e){return Boolean(e.n)}),isWeekdays:-1!=o.indexOf("MO")&&-1!=o.indexOf("TU")&&-1!=o.indexOf("WE")&&-1!=o.indexOf("TH")&&-1!=o.indexOf("FR")&&-1==o.indexOf("SA")&&-1==o.indexOf("SU")};var s=function(e,t){return e.weekday-t.weekday};this.byweekday.allWeeks.sort(s),this.byweekday.someWeeks.sort(s),this.byweekday.allWeeks.length||(this.byweekday.allWeeks=null),this.byweekday.someWeeks.length||(this.byweekday.someWeeks=null)}else this.byweekday=null},i=["count","until","interval","byweekday","bymonthday","bymonth"];(r.IMPLEMENTED=[])[t.DAILY]=i,r.IMPLEMENTED[t.WEEKLY]=i,r.IMPLEMENTED[t.MONTHLY]=i,r.IMPLEMENTED[t.YEARLY]=["byweekno","byyearday"].concat(i),r.isFullyConvertible=function(e){var t=!0;if(!(e.options.freq in r.IMPLEMENTED))return!1;if(e.origOptions.until&&e.origOptions.count)return!1;for(var n in e.origOptions){if(a(["dtstart","wkst","freq"],n))return!0;if(!a(r.IMPLEMENTED[e.options.freq],n))return t=!1,!1}return t},r.prototype={isFullyConvertible:function(){return r.isFullyConvertible(this.rrule)},toString:function(){var e=this.gettext;if(!(this.options.freq in r.IMPLEMENTED))return e("RRule error: Unable to fully convert this rrule to text");if(this.text=[e("every")],this[t.FREQUENCIES[this.options.freq]](),this.options.until){this.add(e("until"));var n=this.options.until;this.add(this.language.monthNames[n.getMonth()]).add(n.getDate()+",").add(n.getFullYear())}else this.options.count&&this.add(e("for")).add(this.options.count).add(e(this.plural(this.options.count)?"times":"time"));return this.isFullyConvertible()||this.add(e("(~ approximate)")),this.text.join("")},DAILY:function(){var e=this.gettext;1!=this.options.interval&&this.add(this.options.interval),this.byweekday&&this.byweekday.isWeekdays?this.add(e(this.plural(this.options.interval)?"weekdays":"weekday")):this.add(e(this.plural(this.options.interval)?"days":"day")),this.origOptions.bymonth&&(this.add(e("in")),this._bymonth()),this.bymonthday?this._bymonthday():this.byweekday&&this._byweekday()},WEEKLY:function(){var e=this.gettext;1!=this.options.interval&&this.add(this.options.interval).add(e(this.plural(this.options.interval)?"weeks":"week")),this.byweekday&&this.byweekday.isWeekdays?1==this.options.interval?this.add(e(this.plural(this.options.interval)?"weekdays":"weekday")):this.add(e("on")).add(e("weekdays")):(1==this.options.interval&&this.add(e("week")),this.origOptions.bymonth&&(this.add(e("in")),this._bymonth()),this.bymonthday?this._bymonthday():this.byweekday&&this._byweekday())},MONTHLY:function(){var e=this.gettext;this.origOptions.bymonth?(1!=this.options.interval&&(this.add(this.options.interval).add(e("months")),this.plural(this.options.interval)&&this.add(e("in"))),this._bymonth()):(1!=this.options.interval&&this.add(this.options.interval),this.add(e(this.plural(this.options.interval)?"months":"month"))),this.bymonthday?this._bymonthday():this.byweekday&&this.byweekday.isWeekdays?this.add(e("on")).add(e("weekdays")):this.byweekday&&this._byweekday()},YEARLY:function(){var e=this.gettext;this.origOptions.bymonth?(1!=this.options.interval&&(this.add(this.options.interval),this.add(e("years"))),this._bymonth()):(1!=this.options.interval&&this.add(this.options.interval),this.add(e(this.plural(this.options.interval)?"years":"year"))),this.bymonthday?this._bymonthday():this.byweekday&&this._byweekday(),this.options.byyearday&&this.add(e("on the")).add(this.list(this.options.byyearday,this.nth,e("and"))).add(e("day")),this.options.byweekno&&this.add(e("in")).add(e(this.plural(this.options.byweekno.length)?"weeks":"week")).add(this.list(this.options.byweekno,null,e("and")))},_bymonthday:function(){var e=this.gettext;this.byweekday&&this.byweekday.allWeeks?this.add(e("on")).add(this.list(this.byweekday.allWeeks,this.weekdaytext,e("or"))).add(e("the")).add(this.list(this.bymonthday,this.nth,e("or"))):this.add(e("on the")).add(this.list(this.bymonthday,this.nth,e("and")))},_byweekday:function(){var e=this.gettext;this.byweekday.allWeeks&&!this.byweekday.isWeekdays&&this.add(e("on")).add(this.list(this.byweekday.allWeeks,this.weekdaytext)),this.byweekday.someWeeks&&(this.byweekday.allWeeks&&this.add(e("and")),this.add(e("on the")).add(this.list(this.byweekday.someWeeks,this.weekdaytext,e("and"))))},_bymonth:function(){this.add(this.list(this.options.bymonth,this.monthtext,this.gettext("and")))},nth:function(e){var t,n,a=this.gettext;if(-1==e)return a("last");switch(n=Math.abs(e)){case 1:case 21:case 31:t=n+a("st");break;case 2:case 22:t=n+a("nd");break;case 3:case 23:t=n+a("rd");break;default:t=n+a("th")}return e<0?t+" "+a("last"):t},monthtext:function(e){return this.language.monthNames[e-1]},weekdaytext:function(e){var t="number"==typeof e?e:e.getJsWeekday();return(e.n?this.nth(e.n)+" ":"")+this.language.dayNames[t]},plural:function(e){return e%100!=1},add:function(e){return this.text.push(" "),this.text.push(e),this},list:function(e,t,n,a){a=a||",",t=t||function(e){return e};var r=this,i=function(e){return t.call(r,e)};return n?function(e,t,n){for(var a="",r=0;r<e.length;r++)0!=r&&(r==e.length-1?a+=" "+n+" ":a+=t+" "),a+=e[r];return a}(e.map(i),a,n):e.map(i).join(a+" ")}};var o=function(e,n){function a(){var e=f.accept("on"),n=f.accept("the");if(e||n)do{var a,s,l;if(a=o())(s=i())?(f.nextSymbol(),u.byweekday||(u.byweekday=[]),u.byweekday.push(t[s].nth(a))):(u.bymonthday||(u.bymonthday=[]),u.bymonthday.push(a),f.accept("day(s)"));else if(s=i())f.nextSymbol(),u.byweekday||(u.byweekday=[]),u.byweekday.push(t[s]);else if("weekday(s)"==f.symbol)f.nextSymbol(),u.byweekday||(u.byweekday=[]),u.byweekday.push(t.MO),u.byweekday.push(t.TU),u.byweekday.push(t.WE),u.byweekday.push(t.TH),u.byweekday.push(t.FR);else if("week(s)"==f.symbol){f.nextSymbol();var d;if(!(d=f.accept("number")))throw new Error("Unexpected symbol "+f.symbol+", expected week number");for(u.byweekno=[d[0]];f.accept("comma");){if(!(d=f.accept("number")))throw new Error("Unexpected symbol "+f.symbol+"; expected monthday");u.byweekno.push(d[0])}}else{if(!(l=r()))return;f.nextSymbol(),u.bymonth||(u.bymonth=[]),u.bymonth.push(l)}}while(f.accept("comma")||f.accept("the")||f.accept("on"))}function r(){switch(f.symbol){case"january":return 1;case"february":return 2;case"march":return 3;case"april":return 4;case"may":return 5;case"june":return 6;case"july":return 7;case"august":return 8;case"september":return 9;case"october":return 10;case"november":return 11;case"december":return 12;default:return!1}}function i(){switch(f.symbol){case"monday":case"tuesday":case"wednesday":case"thursday":case"friday":case"saturday":case"sunday":return f.symbol.substr(0,2).toUpperCase();default:return!1}}function o(){switch(f.symbol){case"last":return f.nextSymbol(),-1;case"first":return f.nextSymbol(),1;case"second":return f.nextSymbol(),f.accept("last")?-2:2;case"third":return f.nextSymbol(),f.accept("last")?-3:3;case"nth":var e=parseInt(f.value[1]);if(e<-366||e>366)throw new Error("Nth out of range: "+e);return f.nextSymbol(),f.accept("last")?-e:e;default:return!1}}function d(){f.accept("on"),f.accept("the");var e;if(e=o())for(u.bymonthday=[e],f.nextSymbol();f.accept("comma");){if(!(e=o()))throw new Error("Unexpected symbol "+f.symbol+"; expected monthday");u.bymonthday.push(e),f.nextSymbol()}}function c(){if("until"==f.symbol){var e=Date.parse(f.text);if(!e)throw new Error("Cannot parse until date:"+f.text);u.until=new Date(e)}else f.accept("for")&&(u.count=f.value[0],f.expect("number"))}var f=new s((n||l).tokens);if(!f.start(e))return null;var u={};return function(){f.expect("every");var e;if((e=f.accept("number"))&&(u.interval=parseInt(e[0])),f.isDone())throw new Error("Unexpected end");switch(f.symbol){case"day(s)":u.freq=t.DAILY,f.nextSymbol()&&(a(),c());break;case"weekday(s)":u.freq=t.WEEKLY,u.byweekday=[t.MO,t.TU,t.WE,t.TH,t.FR],f.nextSymbol(),c();break;case"week(s)":u.freq=t.WEEKLY,f.nextSymbol()&&(a(),c());break;case"month(s)":u.freq=t.MONTHLY,f.nextSymbol()&&(a(),c());break;case"year(s)":u.freq=t.YEARLY,f.nextSymbol()&&(a(),c());break;case"monday":case"tuesday":case"wednesday":case"thursday":case"friday":case"saturday":case"sunday":if(u.freq=t.WEEKLY,u.byweekday=[t[f.symbol.substr(0,2).toUpperCase()]],!f.nextSymbol())return;for(;f.accept("comma");){if(f.isDone())throw new Error("Unexpected end");var n;if(!(n=i()))throw new Error("Unexpected symbol "+f.symbol+", expected weekday");u.byweekday.push(t[n]),f.nextSymbol()}d(),c();break;case"january":case"february":case"march":case"april":case"may":case"june":case"july":case"august":case"september":case"october":case"november":case"december":if(u.freq=t.YEARLY,u.bymonth=[r()],!f.nextSymbol())return;for(;f.accept("comma");){if(f.isDone())throw new Error("Unexpected end");var o;if(!(o=r()))throw new Error("Unexpected symbol "+f.symbol+", expected month");u.bymonth.push(o),f.nextSymbol()}a(),c();break;default:throw new Error("Unknown symbol")}}(),u},s=function(e){this.rules=e};s.prototype.start=function(e){return this.text=e,this.done=!1,this.nextSymbol()},s.prototype.isDone=function(){return this.done&&null==this.symbol},s.prototype.nextSymbol=function(){var e,t,n=this;this.symbol=null,this.value=null;do{if(this.done)return!1;e=null;var a;for(var r in this.rules)(a=this.rules[r].exec(n.text))&&(null==e||a[0].length>e[0].length)&&(e=a,t=r);if(null!=e&&(this.text=this.text.substr(e[0].length),""==this.text&&(this.done=!0)),null==e)return this.done=!0,this.symbol=null,void(this.value=null)}while("SKIP"==t);return this.symbol=t,this.value=e,!0},s.prototype.accept=function(e){if(this.symbol==e){if(this.value){var t=this.value;return this.nextSymbol(),t}return this.nextSymbol(),!0}return!1},s.prototype.expect=function(e){if(this.accept(e))return!0;throw new Error("expected "+e+" but found "+this.symbol)};var l={dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],tokens:{SKIP:/^[ \r\n\t]+|^\.$/,number:/^[1-9][0-9]*/,numberAsText:/^(one|two|three)/i,every:/^every/i,"day(s)":/^days?/i,"weekday(s)":/^weekdays?/i,"week(s)":/^weeks?/i,"month(s)":/^months?/i,"year(s)":/^years?/i,on:/^(on|in)/i,the:/^the/i,first:/^first/i,second:/^second/i,third:/^third/i,nth:/^([1-9][0-9]*)(\.|th|nd|rd|st)/i,last:/^last/i,for:/^for/i,"time(s)":/^times?/i,until:/^(un)?til/i,monday:/^mo(n(day)?)?/i,tuesday:/^tu(e(s(day)?)?)?/i,wednesday:/^we(d(n(esday)?)?)?/i,thursday:/^th(u(r(sday)?)?)?/i,friday:/^fr(i(day)?)?/i,saturday:/^sa(t(urday)?)?/i,sunday:/^su(n(day)?)?/i,january:/^jan(uary)?/i,february:/^feb(ruary)?/i,march:/^mar(ch)?/i,april:/^apr(il)?/i,may:/^may/i,june:/^june?/i,july:/^july?/i,august:/^aug(ust)?/i,september:/^sep(t(ember)?)?/i,october:/^oct(ober)?/i,november:/^nov(ember)?/i,december:/^dec(ember)?/i,comma:/^(,\s*|(and|or)\s*)+/i}},d={fromText:function(e,n){return new t(o(e,n))},parseText:o,isFullyConvertible:r.isFullyConvertible,toText:function(e,t,n){return new r(e,t,n).toString()}};n?module.exports=d:e._RRuleNLP=d,"function"==typeof define&&define.amd&&define("rrule",[],function(){return t})}(this),function(e,t){function n(t){e.extend(!0,_e,t)}function r(n,a,r){function c(){W=a.theme?"ui":"fc",n.addClass("fc"),a.isRTL?n.addClass("fc-rtl"):n.addClass("fc-ltr"),a.theme&&n.addClass("ui-widget"),F=e("<div class='fc-content' style='position:relative'/>").prependTo(n),N=new i(Y,a),(Q=N.render())&&n.prepend(Q),m(a.defaultView),a.handleWindowResize&&e(window).resize(D),h()||f()}function f(){setTimeout(function(){!B.start&&h()&&y()},0)}function u(){return n.is(":visible")}function h(){return e("body").is(":visible")}function m(e){B&&e==B.name||v(e)}function v(t){firstTime=0==F.find(".fc-view").length,noTransition=!!(firstTime||Y.options.transition.notransition&&1==parseInt(Y.options.transition.notransition));var n=B;if(jQuery(".fct-tooltip").trigger("close-tooltip"),Z++,B&&(z("viewDestroy",B,B,B.element),R(),B.triggerEventDestroy(),I(),noTransition&&B.element.remove(),N.deactivateButton(B.name)),N.activateButton(t),B=new ke[t](e("<div class='fc-view fc-view-"+t+"' style='position:relative'/>").appendTo(F),Y),n&&n.viewLeave&&n.viewLeave(n,B,Y),B.transitionStarted&&B.transitionStarted(n),!noTransition){F.css("overflow","hidden");var a=F.width(),r=F.height(),i={rtl:{newView:{left:a,top:0},oldView:{left:-1*a,top:0}},ltr:{newView:{left:-1*a,top:0},oldView:{left:a,top:0}},ttb:{newView:{left:0,top:-1*r},oldView:{left:0,top:r}},btt:{newView:{left:0,top:r},oldView:{left:0,top:-1*r}}},o=Y.options.transition.direction?Y.options.transition.direction:"horizontal";if(n){if(0==e(".fc-button-"+t).length)s="horizontal"==o?i.rtl:i.ttb;else if(e(".fc-button-"+n.name).length>0&&e(".fc-button-"+t).length>0&&e(".fc-button-"+n.name).position().left<e(".fc-button-"+t).position().left)s="horizontal"==o?i.rtl:i.ttb;else s="horizontal"==o?i.ltr:i.btt;B.lastView=n.name}else{var s="horizontal"==o?i.rtl:i.ttb;B.lastView=!1}return n&&n.element.css("z-index",0).css("position","absolute"),B.element.appendTo(F).css("left",s.newView.left).css("top",s.newView.top).css("opacity",0).css("z-index",1).show(),n.element.animate({opacity:0,left:s.oldView.left,top:s.oldView.top},Y.options.transition.duration||"slow",Y.options.transition.easing||"linear",function(){n.element.hide().css("position","relative").css("opacity",1).css("left",0)}),y(),I(),void B.element.animate({opacity:1,left:0,top:0},Y.options.transition.duration||"slow",Y.options.transition.easing||"linear",function(){n.element.hide().css("position","relative"),B.transitionEnded&&B.transitionEnded(n),H(),Z--,F.find(".fc-view:hidden").remove()})}B.transitionEnded&&B.transitionEnded(n),y(),H(),Z--}function y(e){(!B.start||e||X<B.start||X>=B.end)&&u()&&_(e)}function _(t){if(Z++,B.start&&(z("viewDestroy",B,B,B.element),R(),$()),I(),B.render(X,t||0),Y.options.skipMonths&&-1!=e.inArray(X.getMonth(),Y.options.skipMonths)){increase=t||1;for(var n=0;n++<366;){if(-1==e.inArray(X.getMonth(),Y.options.skipMonths)){B.render(X,0);break}X.setDate(X.getDate()+increase)}}x(),H(),(B.afterRender||A)(),O(),j(),z("viewRender",B,B,B.element),B.trigger("viewDisplay",J),Z--,E()}function w(){if(u()){if(R(),$(),C(),x(),"rhc_event"==B.name)return;M()}}function C(){U=a.contentHeight?a.contentHeight:a.height?a.height-(Q?Q.height():0)-L(F):Math.round(F.width()/Math.max(a.aspectRatio,.5))}function x(){U===t&&C(),Z++,B.setHeight(U),B.setWidth(F.width()),Z--,q=n.outerWidth()}function D(){if(!Z)if(B.start){var e=++G;setTimeout(function(){e==G&&!Z&&u()&&q!=(q=n.outerWidth())&&(Z++,w(),B.trigger("windowResize",J),Z--)},200)}else f()}function T(e){$(),M(e)}function M(e){u()&&(B.setEventData(ee),B.renderEvents(ee,e),B.trigger("eventAfterAllRender"))}function $(){B.triggerEventDestroy(),B.clearEvents(),B.clearEventData()}function E(){!a.lazyFetching||V(B.visStart,B.visEnd)?S():M()}function S(){K(B.visStart,B.visEnd)}function O(){N.updateTitle(B.title)}function j(){var e=new Date;e>=B.start&&e<B.end?N.disableButton("today"):N.enableButton("today")}function R(){B&&B.unselect()}function I(){F.css({width:"100%",height:F.height(),overflow:"hidden"})}function H(){F.css({width:"",height:"",overflow:""})}function z(e,t){if(a[e])return a[e].apply(t||J,Array.prototype.slice.call(arguments,2))}var Y=this;Y.options=a,Y.render=function(e){F?u()&&(C(),_(e)):c()},Y.destroy=function(){B&&(z("viewDestroy",B,B,B.element),B.triggerEventDestroy()),e(window).unbind("resize",D),N.destroy(),F.remove(),n.removeClass("fc fc-rtl ui-widget")},Y.refetchEvents=function(){$(),S()},Y.reportEvents=function(e){ee=e,M()},Y.reportEventChange=function(e){T(e)},Y.rerenderEvents=T,Y.changeView=m,Y.select=function(e,n,a){B.select(e,n,a===t||a)},Y.unselect=R,Y.prev=function(){y(-1)},Y.next=function(){y(1)},Y.prevYear=function(){s(X,-1),y()},Y.nextYear=function(){s(X,1),y()},Y.today=function(){X=new Date,y()},Y.gotoDate=function(e,t,n){e instanceof Date?X=p(e):g(X,e,t,n),y()},Y.incrementDate=function(e,n,a){e!==t&&s(X,e),n!==t&&l(X,n),a!==t&&d(X,a),y()},Y.formatDate=function(e,t){return b(e,t,a)},Y.formatDates=function(e,t,n){return k(e,t,n,a)},Y.getDate=function(){return p(X)},Y.getView=function(){return B},Y.option=function(e,n){if(n===t)return a[e];"height"!=e&&"contentHeight"!=e&&"aspectRatio"!=e||(a[e]=n,w())},Y.trigger=z,Y.rhc_search=function(t,n,a){e(J).find(".fc-filters-dialog").length>0&&(a||e(J).find(".fc-filters-dialog").is(":visible")?e(J).find(".fc-filters-dialog").stop().find(".fbd-unchecked").css("overflow-y","hidden").end().animate({opacity:0,top:-10},"fast","linear",function(){e(this).hide()}):(jQuery(".fct-tooltip").trigger("close-tooltip"),e(J).find(".fc-filters-dialog").stop().show().find(".fbd-unchecked").css("overflow-y","hidden").end().animate({opacity:1,top:0},"fast","linear",function(){e(this).find(".fbd-unchecked").css("overflow-y","auto")})))},o.call(Y,a,r);var N,Q,F,W,B,q,U,P,V=Y.isFetchNeeded,K=Y.fetchEvents,J=n[0],G=0,Z=0,X=new Date,ee=[];Y.date=X,g(X,a.year,a.month,a.date),a.droppable&&e(document).bind("dragstart",function(t,n){var r=t.target,i=e(r);if(!i.parents(".fc").length){var o=a.dropAccept;(e.isFunction(o)?o.call(r,i):i.is(o))&&(P=r,B.dragStart(P,t,n))}}).bind("dragstop",function(e,t){P&&(B.dragStop(P,e,t),P=null)})}function i(t,n){function a(a){var r=e("<div class='fc-header-cell fc-header-"+a+"'/>"),o=n.header[a];return o&&e.each(o.split(" "),function(a){a>0&&r.append("<span class='fc-header-space'/>");var o;e.each(this.split(","),function(a,s){if("title"==s)r.append("<span class='fc-header-title'><h2>&nbsp;</h2></span>"),o&&o.addClass(i+"-corner-right"),o=null;else{var l;if(t[s]?l=t[s]:ke[s]?l=function(){f.removeClass(i+"-state-hover"),t.changeView(s)}:n[s]&&(l=function(){l=n[s]}),l){var d=n.theme?Q(n.buttonIcons,s):null,c=Q(n.buttonText,s),f=e("<span class='fc-button fc-button-"+s+" "+i+"-state-default'>"+(d?"<span class='fc-icon-wrap'><span class='ui-icon ui-icon-"+d+"'/></span>":c)+"</span>").click(function(){f.hasClass(i+"-state-disabled")||l(t,r)}).mousedown(function(){f.not("."+i+"-state-active").not("."+i+"-state-disabled").addClass(i+"-state-down")}).mouseup(function(){f.removeClass(i+"-state-down")}).hover(function(){f.not("."+i+"-state-active").not("."+i+"-state-disabled").addClass(i+"-state-hover")},function(){f.removeClass(i+"-state-hover").removeClass(i+"-state-down")}).appendTo(r);W(f),o||f.addClass(i+"-corner-left"),o=f}}}),o&&o.addClass(i+"-corner-right")}),r}var r=this;r.render=function(){if(i=n.theme?"ui":"fc",n.header)return o=e("<div class='fc-header'/>").append(e("<div class='fc-header-row' />").append(a("center")).append(a("left")).append(a("right")))},r.destroy=function(){o.remove()},r.updateTitle=function(e){o.find("h2").html(e)},r.activateButton=function(e){o.find("span.fc-button-"+e).addClass(i+"-state-active")},r.deactivateButton=function(e){o.find("span.fc-button-"+e).removeClass(i+"-state-active")},r.disableButton=function(e){o.find("span.fc-button-"+e).addClass(i+"-state-disabled")},r.enableButton=function(e){o.find("span.fc-button-"+e).removeClass(i+"-state-disabled")};var i,o=e([])}function o(n,a){function r(t,a){i(t,function(r){if(a==C){if(r){n.eventDataTransform&&(r=e.map(r,n.eventDataTransform)),t.eventDataTransform&&(r=e.map(r,t.eventDataTransform));for(var i=0;i<r.length;i++)r[i].source=t,d(r[i]);T=T.concat(r)}--x||w(T)}})}function i(t,a){var r,o,d=be.sourceFetchers;for(r=0;r<d.length;r++){if(!0===(o=d[r](t,m,v,a)))return;if("object"==typeof o)return void i(o,a)}var c=t.events;if(c)e.isFunction(c)?(s(),c(p(m),p(v),function(e){a(e),l()})):e.isArray(c)?a(c):a();else if(t.url){var f,u=t.success,h=t.error,g=t.complete;f=e.isFunction(t.data)?t.data():t.data;var y=e.extend({},f||{}),_=P(t.startParam,n.startParam),w=P(t.endParam,n.endParam);_&&(y[_]=Math.round(+m/1e3)),w&&(y[w]=Math.round(+v/1e3)),s(),e.ajax(e.extend({},Ce,t,{data:y,success:function(t){t=t||[];var n=U(u,this,arguments);e.isArray(n)&&(t=n),a(t)},error:function(){U(h,this,arguments),a()},complete:function(){U(g,this,arguments),l()}}))}else a()}function o(t){if(e.isFunction(t)||e.isArray(t)?t={events:t}:"string"==typeof t&&(t={url:t}),"object"==typeof t)return c(t),k.push(t),t}function s(){D++||g("loading",null,!0,_())}function l(){--D||g("loading",null,!1,_())}function d(e){var a=e.source||{},r=P(a.ignoreTimezone,n.ignoreTimezone);e._id=e._id||(e.id===t?"_fc"+xe++:e.id+""),e.date&&(e.start||(e.start=e.date),delete e.date),e._start=p(e.start=y(e.start,r)),e.end=y(e.end,r),e.end&&e.end<=e.start&&(e.end=null),e._end=e.end?p(e.end):null,e.allDay===t&&(e.allDay=P(a.allDayDefault,n.allDayDefault)),e.className?"string"==typeof e.className&&(e.className=e.className.split(/\s+/)):e.className=[]}function c(e){e.className?"string"==typeof e.className&&(e.className=e.className.split(/\s+/)):e.className=[];for(var t=be.sourceNormalizers,n=0;n<t.length;n++)t[n](e)}function f(e,t){return e&&t&&u(e)==u(t)}function u(e){return("object"==typeof e?e.events||e.url:"")||e}var h=this;h.isFetchNeeded=function(e,t){return!m||e<m||t>v},h.fetchEvents=function(e,t){m=e,v=t,T=[];var n=++C,a=k.length;x=a;for(var i=0;i<a;i++)r(k[i],n)},h.addEventSource=function(e){(e=o(e))&&(x++,r(e,C))},h.removeEventSource=function(t){k=e.grep(k,function(e){return!f(e,t)}),T=e.grep(T,function(e){return!f(e.source,t)}),w(T)},h.updateEvent=function(e){var t,n,a=T.length,r=_().defaultEventEnd,i=e.start-e._start,o=e.end?e.end-(e._end||r(e)):0;for(t=0;t<a;t++)(n=T[t])._id==e._id&&n!=e&&(n.start=new Date(+n.start+i),e.end?n.end?n.end=new Date(+n.end+o):n.end=new Date(+r(n)+o):n.end=null,n.title=e.title,n.url=e.url,n.allDay=e.allDay,n.className=e.className,n.editable=e.editable,n.color=e.color,n.backgroundColor=e.backgroundColor,n.borderColor=e.borderColor,n.textColor=e.textColor,d(n));d(e),w(T)},h.renderEvent=function(e,t){d(e),e.source||(t&&(b.events.push(e),e.source=b),T.push(e)),w(T)},h.removeEvents=function(t){if(t){if(!e.isFunction(t)){var n=t+"";t=function(e){return e._id==n}}for(T=e.grep(T,t,!0),a=0;a<k.length;a++)e.isArray(k[a].events)&&(k[a].events=e.grep(k[a].events,t,!0))}else{T=[];for(var a=0;a<k.length;a++)e.isArray(k[a].events)&&(k[a].events=[])}w(T)},h.clientEvents=function(t){return e.isFunction(t)?e.grep(T,t):t?(t+="",e.grep(T,function(e){return e._id==t})):T},h.normalizeEvent=d,h.removeEventSources=function(){k=[],w(T=[])};for(var m,v,g=h.trigger,_=h.getView,w=h.reportEvents,b={events:[]},k=[b],C=0,x=0,D=0,T=[],M=0;M<a.length;M++)o(a[M])}function s(e,t,n){return e.setFullYear(e.getFullYear()+t),n||u(e),e}function l(e,t,n){if(+e){var a=e.getMonth()+t,r=p(e);for(r.setDate(1),r.setMonth(a),e.setMonth(a),n||u(e);e.getMonth()!=r.getMonth();)e.setDate(e.getDate()+(e<r?1:-1))}return e}function d(e,t,n){if(+e){var a=e.getDate()+t,r=p(e);r.setHours(9),r.setDate(a),e.setDate(a),n||u(e),c(e,r)}return e}function c(e,t){if(+e)for(;e.getDate()!=t.getDate();)e.setTime(+e+(e<t?1:-1)*Me)}function f(e,t){return e.setMinutes(e.getMinutes()+t),e}function u(e){return e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0),e}function p(e,t){return t?u(new Date(+e)):new Date(+e)}function m(){var e,t=0;do{e=new Date(1970,t++,1)}while(e.getHours());return e}function v(e,t){return Math.round((p(e,!0)-p(t,!0))/Te)}function g(e,n,a,r){n!==t&&n!=e.getFullYear()&&(e.setDate(1),e.setMonth(0),e.setFullYear(n)),a!==t&&a!=e.getMonth()&&(e.setDate(1),e.setMonth(a)),r!==t&&e.setDate(r)}function y(e,n){return"object"==typeof e?e:"number"==typeof e?new Date(1e3*e):"string"==typeof e?e.match(/^\d+(\.\d+)?$/)?new Date(1e3*parseFloat(e)):(n===t&&(n=!0),_(e,n)||(e?new Date(e):null)):null}function _(e,t){var n=e.match(/^([0-9]{4})(-([0-9]{2})(-([0-9]{2})([T ]([0-9]{2}):([0-9]{2})(:([0-9]{2})(\.([0-9]+))?)?(Z|(([-+])([0-9]{2})(:?([0-9]{2}))?))?)?)?)?$/);if(!n)return null;var a=new Date(n[1],0,1);if(t||!n[13]){var r=new Date(n[1],0,1,9,0);n[3]&&(a.setMonth(n[3]-1),r.setMonth(n[3]-1)),n[5]&&(a.setDate(n[5]),r.setDate(n[5])),c(a,r),n[7]&&a.setHours(n[7]),n[8]&&a.setMinutes(n[8]),n[10]&&a.setSeconds(n[10]),n[12]&&a.setMilliseconds(1e3*Number("0."+n[12])),c(a,r)}else if(a.setUTCFullYear(n[1],n[3]?n[3]-1:0,n[5]||1),a.setUTCHours(n[7]||0,n[8]||0,n[10]||0,n[12]?1e3*Number("0."+n[12]):0),n[14]){var i=60*Number(n[16])+(n[18]?Number(n[18]):0);i*="-"==n[15]?1:-1,a=new Date(+a+60*i*1e3)}return a}function w(e){if("number"==typeof e)return 60*e;if("object"==typeof e)return 60*e.getHours()+e.getMinutes();var t=e.match(/(\d+)(?::(\d+))?\s*(\w+)?/);if(t){var n=parseInt(t[1],10);return t[3]&&(n%=12,"p"==t[3].toLowerCase().charAt(0)&&(n+=12)),60*n+(t[2]?parseInt(t[2],10):0)}}function b(e,t,n){return k(e,null,t,n)}function k(e,t,n,a){a=a||_e;var r,i,o,s,l=e,d=t,c=n.length,f="";for(r=0;r<c;r++)if("'"==(i=n.charAt(r))){for(o=r+1;o<c;o++)if("'"==n.charAt(o)){l&&(f+=o==r+1?"'":n.substring(r+1,o),r=o);break}}else if("("==i){for(o=r+1;o<c;o++)if(")"==n.charAt(o)){var u=b(l,n.substring(r+1,o),a);parseInt(u.replace(/\D/,""),10)&&(f+=u),r=o;break}}else if("["==i){for(o=r+1;o<c;o++)if("]"==n.charAt(o)){var h=n.substring(r+1,o);(u=b(l,h,a))!=b(d,h,a)&&(f+=u),r=o;break}}else if("{"==i)l=t,d=e;else if("}"==i)l=e,d=t;else{for(o=c;o>r;o--)if(s=Ee[n.substring(r,o)]){l&&(f+=s(l,a)),r=o-1;break}o==r&&l&&(f+=i)}return f}function C(e){var t,n=new Date(e.getTime());return n.setDate(n.getDate()+4-(n.getDay()||7)),t=n.getTime(),n.setMonth(0),n.setDate(1),Math.floor(Math.round((t-n)/864e5)/7)+1}function x(e){return e.end?D(e.end,e.allDay):d(p(e.start),1)}function D(e,t){return e=p(e),t||e.getHours()||e.getMinutes()?d(e,1):u(e)}function T(n,a,r){n.unbind("mouseover").mouseover(function(n){for(var i,o,s,l=n.target;l!=this;)i=l,l=l.parentNode;(o=i._fci)!==t&&(i._fci=t,s=a[o],r(s.event,s.element,s),e(n.target).trigger(n)),n.stopPropagation()})}function M(t,n,a){for(var r,i=0;i<t.length;i++)(r=e(t[i])).width(Math.max(0,n-E(r,a)))}function $(t,n,a){for(var r,i=0;i<t.length;i++)(r=e(t[i])).height(Math.max(0,n-L(r,a)))}function E(e,t){return S(e)+j(e)+(t?O(e):0)}function S(t){return(parseFloat(e.css(t[0],"paddingLeft",!0))||0)+(parseFloat(e.css(t[0],"paddingRight",!0))||0)}function O(t){return(parseFloat(e.css(t[0],"marginLeft",!0))||0)+(parseFloat(e.css(t[0],"marginRight",!0))||0)}function j(t){return(parseFloat(e.css(t[0],"borderLeftWidth",!0))||0)+(parseFloat(e.css(t[0],"borderRightWidth",!0))||0)}function L(e,t){return R(e)+H(e)+(t?I(e):0)}function R(t){return(parseFloat(e.css(t[0],"paddingTop",!0))||0)+(parseFloat(e.css(t[0],"paddingBottom",!0))||0)}function I(t){return(parseFloat(e.css(t[0],"marginTop",!0))||0)+(parseFloat(e.css(t[0],"marginBottom",!0))||0)}function H(t){return(parseFloat(e.css(t[0],"borderTopWidth",!0))||0)+(parseFloat(e.css(t[0],"borderBottomWidth",!0))||0)}function A(){}function z(e,t){return e-t}function Y(e){return Math.max.apply(Math,e)}function N(e){return(e<10?"0":"")+e}function Q(e,n){if(e[n]!==t)return e[n];for(var a,r=n.split(/(?=[A-Z])/),i=r.length-1;i>=0;i--)if((a=e[r[i].toLowerCase()])!==t)return a;return e[""]}function F(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#039;").replace(/"/g,"&quot;").replace(/\n/g,"<br />")}function W(e){e.attr("unselectable","on").css("MozUserSelect","none").bind("selectstart.ui",function(){return!1})}function B(e){e.children().removeClass("fc-first fc-last").filter(":first-child").addClass("fc-first").end().filter(":last-child").addClass("fc-last")}function q(e,t){var n=e.source||{},a=e.color,r=n.color,i=t("eventColor"),o=e.backgroundColor||a||n.backgroundColor||r||t("eventBackgroundColor")||i,s=e.borderColor||a||n.borderColor||r||t("eventBorderColor")||i,l=e.textColor||n.textColor||t("eventTextColor"),d=[];return o&&d.push("background-color:"+o),s&&d.push("border-color:"+s),l&&d.push("color:"+l),d.join(";")}function U(t,n,a){if(e.isFunction(t)&&(t=[t]),t){var r,i;for(r=0;r<t.length;r++)i=t[r].apply(n,a)||i;return i}}function P(){for(var e=0;e<arguments.length;e++)if(arguments[e]!==t)return arguments[e]}function V(t,n,a){function r(){U=Z("theme")?"ui":"fc",P=Z("columnFormat"),V=Z("weekNumbers"),J=Z("weekNumberTitle"),G="iso"!=Z("weekNumberCalculation")?"w":"W"}function i(){S=e("<div class='fc-event-container' style='position:absolute;z-index:8;top:0;left:0'/>").appendTo(t)}function o(){var n=s();w&&w.remove(),w=e(n).appendTo(t),b=w.find("thead"),k=b.find(".fc-day-header"),C=w.find("tbody"),x=C.find("tr"),D=C.find(".fc-day"),T=x.find("td:first-child"),$=x.eq(0).find(".fc-day > div"),E=x.eq(0).find(".fc-day-content > div"),B(b.add(b.find("tr"))),B(x),x.eq(0).addClass("fc-first"),x.filter(":last").addClass("fc-last"),D.each(function(t,n){var a=ae(Math.floor(t/A),t%A);X("dayRender",y,a,e(n))}),h(D)}function s(){return"<table class='fc-border-separate' style='width:100%' cellspacing='0'>"+l()+c()+"</table>"}function l(){var e,t,n=U+"-widget-header",a="";for(a+="<thead><tr>",V&&(a+="<th class='fc-week-number "+n+"'>"+F(J)+"</th>"),e=0;e<A;e++)t=ae(0,e),a+="<th class='fc-day-header fc-"+De[t.getDay()]+" "+n+"'>"+F(oe(t,P))+"</th>";return a+="</tr></thead>"}function c(){var e,t,n,a=U+"-widget-content",r="";for(r+="<tbody>",e=0;e<H;e++){for(r+="<tr class='fc-week'>",V&&(n=ae(e,0),r+="<td class='fc-week-number "+a+"'><div>"+F(oe(n,G))+"</div></td>"),t=0;t<A;t++)r+=f(n=ae(e,t));r+="</tr>"}return r+="</tbody>"}function f(e){var t=U+"-widget-content",n=y.start.getMonth(),r=u(new Date),i="",o=["fc-day","fc-"+De[e.getDay()],t];if(e.getMonth()!=n&&o.push("fc-other-month"),+e==+r?o.push("fc-today",U+"-state-highlight"):e<r?o.push("fc-past"):o.push("fc-future"),i+="<td class='"+o.join(" ")+"' data-date='"+oe(e,"yyyy-MM-dd")+"'><div>",z){switch(a){case"basicWeek":value=F(oe(e,P));break;case"month":value=e.getDate(),mobile_month_cell_num_format=Z("mobile_month_cell_num_format"),mobile_month_cell_num_format&&1==parseInt(value)&&(value=F(oe(e,mobile_month_cell_num_format)));break;default:value=e.getDate()}i+="<div class='fc-day-number'>"+value+"</div>"}return i+="<div class='fc-day-content'><div style='position:relative'>&nbsp;</div></div></div></td>"}function h(e){e.click(m).mousedown(ne)}function m(t){if(!Z("selectable")){var n=_(e(this).data("date"));X("dayClick",this,n,!0,t)}}function v(e,t,n){n&&Y.build();for(var a=ie(e,t,null),r=0;r<a.length;r++){var i=a[r];h(g(i.row,i.leftCol,i.row,i.rightCol))}}function g(e,n,a,r){var i=Y.rect(e,n,a,r,t);return ee(i,t)}var y=this;y.renderBasic=function(e,t,n){H=e,A=t,z=n,r(),C||i(),o()},y.setHeight=function(t){if(!e(y.element).closest(".rhc_holder").is(".fc-small")){var n,a,r,i=(j=t)-b.height();"variable"==Z("weekMode")?n=a=Math.floor(i/(1==H?2:6)):(n=Math.floor(i/H),a=i-n*(H-1)),T.each(function(t,i){t<H&&(r=e(i)).find("> div").css("min-height",(t==H-1?a:n)-L(r))})}},y.setWidth=function(e){O=e,Q.clear(),q.clear(),I=0,V&&(I=b.find("th.fc-week-number").outerWidth()),R=Math.floor((O-I)/A),M(k.slice(0,-1),R)},y.renderDayOverlay=v,y.defaultSelectionEnd=function(e,t){return p(e)},y.renderSelection=function(e,t,n){v(e,d(p(t),1),!0)},y.clearSelection=function(){te()},y.reportDayClick=function(e,t,n){var a=re(e),r=D[a.row*A+a.col];X("dayClick",r,e,t,n)},y.dragStart=function(e,t,n){N.start(function(e){te(),e&&g(e.row,e.col,e.row,e.col)},t)},y.dragStop=function(e,t,n){var a=N.stop();if(te(),a){var r=ae(a);X("drop",e,r,!0,t,n)}},y.defaultEventEnd=function(e){return p(e.start)},y.getHoverListener=function(){return N},y.colLeft=function(e){return Q.left(e)},y.colRight=function(e){return Q.right(e)},y.colContentLeft=function(e){return q.left(e)},y.colContentRight=function(e){return q.right(e)},y.getIsCellAllDay=function(){return!0},y.allDayRow=function(e){return x.eq(e)},y.getRowCnt=function(){return H},y.getColCnt=function(){return A},y.getColWidth=function(){return R},y.getDaySegmentContainer=function(){return S},le.call(y,t,n,a),pe.call(y),he.call(y),K.call(y);var w,b,k,C,x,D,T,$,E,S,O,j,R,I,H,A,z,Y,N,Q,q,U,P,V,J,G,Z=y.opt,X=y.trigger,ee=y.renderOverlay,te=y.clearOverlays,ne=y.daySelectionMousedown,ae=y.cellToDate,re=y.dateToCell,ie=y.rangeToSegments,oe=n.formatDate;W(t.addClass("fc-grid")),Y=new me(function(t,n){var a,r,i;k.each(function(t,o){a=e(o),r=a.offset().left,t&&(i[1]=r),i=[r],n[t]=i}),i[1]=r+a.outerWidth(),x.each(function(n,o){n<H&&(a=e(o),r=a.offset().top,n&&(i[1]=r),i=[r],t[n]=i)}),i[1]=r+a.outerHeight()}),N=new ve(Y),Q=new ye(function(e){return $.eq(e)}),q=new ye(function(e){return E.eq(e)})}function K(){var e=this;e.renderEvents=function(t,n){e.renderDayEvents(t,n)},e.clearEvents=function(){e.getDaySegmentContainer().empty()},de.call(e)}function J(n,a,r){function i(){Te=Re("theme")?"ui":"fc",Me=Re("isRTL"),$e=w(Re("minTime")),Ee=w(Re("maxTime")),Se=Re("columnFormat"),Oe=Re("weekNumbers"),je=Re("weekNumberTitle"),Le="iso"!=Re("weekNumberCalculation")?"w":"W",fe=Re("snapMinutes")||Re("slotMinutes")}function o(){var t,a,r,i,o,l=Te+"-widget-header",d=Te+"-widget-content",c=Re("slotMinutes")%15==0;for(s(),V=e("<div style='position:absolute;z-index:2;left:0;width:100%'/>").appendTo(n),Re("allDaySlot")?(K=e("<div class='fc-event-container' style='position:absolute;z-index:8;top:0;left:0'/>").appendTo(V),t="<table style='width:100%' class='fc-agenda-allday' cellspacing='0'><tr><th class='"+l+" fc-agenda-axis'>"+Re("allDayText")+"</th><td><div class='fc-day-content'><div style='position:relative'/></div></td><th class='"+l+" fc-agenda-gutter'>&nbsp;</th></tr></table>",J=e(t).appendTo(V),g((Z=J.find("tr")).find("td")),V.append("<div class='fc-agenda-divider "+l+"'><div class='fc-agenda-divider-inner'/></div>")):K=e([]),X=e("<div style='position:absolute;width:100%;overflow-x:hidden;overflow-y:auto'/>").appendTo(V),ee=e("<div style='position:relative;width:100%;overflow:hidden'/>").appendTo(X),te=e("<div class='fc-event-container' style='position:absolute;z-index:8;top:0;left:0'/>").appendTo(ee),t="<table class='fc-agenda-slots' style='width:100%' cellspacing='0'><tbody>",i=f(p(a=m()),Ee),f(a,$e),we=0,r=0;a<i;r++)t+="<tr class='fc-slot"+r+" "+((o=a.getMinutes())?"fc-minor":"")+"'><th class='fc-agenda-axis "+l+"'>"+(c&&o?"&nbsp;":qe(a,Re("axisFormat")))+"</th><td class='"+d+"'><div style='position:relative'>&nbsp;</div></td></tr>",f(a,Re("slotMinutes")),we++;y((ne=e(t+="</tbody></table>").appendTo(ee)).find("td"))}function s(){var t=l();I&&I.remove(),I=e(t).appendTo(n),H=I.find("thead"),A=H.find("th").slice(1,-1),Y=I.find("tbody"),N=Y.find("td").slice(0,-1),Q=N.find("> div"),q=N.find(".fc-day-content > div"),U=N.eq(0),P=Q.eq(0),B(H.add(H.find("tr"))),B(Y.add(Y.find("tr")))}function l(){return"<table style='width:100%' class='fc-agenda-days fc-border-separate' cellspacing='0'>"+c()+h()+"</table>"}function c(){var e,t,n,a=Te+"-widget-header",r="";for(r+="<thead><tr>",Oe?(e=Fe(0,0),t=qe(e,Le),Me?t+=je:t=je+t,r+="<th class='fc-agenda-axis fc-week-number "+a+"'>"+F(t)+"</th>"):r+="<th class='fc-agenda-axis "+a+"'>&nbsp;</th>",n=0;n<_e;n++)e=Fe(0,n),r+="<th class='fc-"+De[e.getDay()]+" fc-col"+n+" "+a+"'>"+F(qe(e,Se))+"</th>";return r+="<th class='fc-agenda-gutter "+a+"'>&nbsp;</th></tr></thead>"}function h(){var e,t,n,a,r=Te+"-widget-header",i=Te+"-widget-content",o=u(new Date),s="";for(s+="<tbody><tr><th class='fc-agenda-axis "+r+"'>&nbsp;</th>",n="",t=0;t<_e;t++)e=Fe(0,t),a=["fc-col"+t,"fc-"+De[e.getDay()],i],+e==+o?a.push(Te+"-state-highlight","fc-today"):e<o?a.push("fc-past"):a.push("fc-future"),n+="<td class='"+a.join(" ")+"'><div><div class='fc-day-content'><div style='position:relative'>&nbsp;</div></div></div></td>";return s+=n,s+="<td class='fc-agenda-gutter "+i+"'>&nbsp;</td></tr></tbody>"}function v(){function e(){X.scrollTop(a)}var t=m(),n=p(t);n.setHours(Re("firstHour"));var a=T(t,n)+1;e(),setTimeout(e,0)}function g(e){e.click(_).mousedown(Ne)}function y(e){e.click(_).mousedown(O)}function _(e){if(!Re("selectable")){var t=Math.min(_e-1,Math.floor((e.pageX-I.offset().left-oe)/se)),n=Fe(0,t),a=this.parentNode.className.match(/fc-slot(\d+)/);if(a){var r=parseInt(a[1])*Re("slotMinutes"),i=Math.floor(r/60);n.setHours(i),n.setMinutes(r%60+$e),Ie("dayClick",N[t],n,!1,e)}else Ie("dayClick",N[t],n,!0,e)}}function b(e,t,n){n&&be.build();for(var a=Be(e,t,null),r=0;r<a.length;r++){var i=a[r];g(k(i.row,i.leftCol,i.row,i.rightCol))}}function k(e,t,n,a){var r=be.rect(e,t,n,a,V);return He(r,V)}function C(e,t){for(var n=0;n<_e;n++){var a=Fe(0,n),r=d(p(a),1),i=new Date(Math.max(a,e)),o=new Date(Math.min(r,t));if(i<o){var s=be.rect(0,n,0,n,ee),l=T(a,i),c=T(a,o);s.top=l,s.height=c-l,y(He(s,ee))}}}function x(e){return Re("allDaySlot")&&!e.row}function D(e){var t=Fe(0,e.col),n=e.row;return Re("allDaySlot")&&n--,n>=0&&f(t,$e+n*fe),t}function T(e,n){if(e=p(e,!0),n<f(p(e),$e))return 0;if(n>=f(p(e),Ee))return ne.height();var a=Re("slotMinutes"),r=60*n.getHours()+n.getMinutes()-$e,i=Math.floor(r/a),o=Ue[i];return o===t&&(o=Ue[i]=ne.find("tr").eq(i).find("td div")[0].offsetTop),Math.max(0,Math.round(o-1+ce*(r%a/a)))}function E(t,n){var a=Re("selectHelper");if(be.build(),a){var r=We(t).col;if(r>=0&&r<_e){var i=be.rect(0,r,0,r,ee),o=T(t,t),s=T(t,n);if(s>o){if(i.top=o,i.height=s-o,i.left+=2,i.width-=5,e.isFunction(a)){var l=a(t,n);l&&(i.position="absolute",ae=e(l).css(i).appendTo(ee))}else i.isStart=!0,i.isEnd=!0,(ae=e(Qe({title:"",start:t,end:n,className:["fc-select-helper"],editable:!1},i))).css("opacity",Re("dragOpacity"));ae&&(y(ae),ee.append(ae),M(ae,i.width,!0),$(ae,i.height,!0))}}}else C(t,n)}function S(){Ae(),ae&&(ae.remove(),ae=null)}function O(t){if(1==t.which&&Re("selectable")){Ye(t);var n;ke.start(function(e,t){if(S(),e&&e.col==t.col&&!x(e)){var a=D(t),r=D(e);E((n=[a,f(p(a),fe),r,f(p(r),fe)].sort(z))[0],n[3])}else n=null},t),e(document).one("mouseup",function(e){ke.stop(),n&&(+n[0]==+n[1]&&j(n[0],!1,e),ze(n[0],n[3],!1,e))})}}function j(e,t,n){Ie("dayClick",N[We(e).col],e,t,n)}var R=this;R.renderAgenda=function(e){_e=e,i(),I?s():o()},R.setWidth=function(t){re=t,Ce.clear(),xe.clear();var n=H.find("th:first");J&&(n=n.add(J.find("th:first"))),n=n.add(ne.find("th:first")),oe=0,M(n.width("").each(function(t,n){oe=Math.max(oe,e(n).outerWidth())}),oe);var a=I.find(".fc-agenda-gutter");J&&(a=a.add(J.find("th.fc-agenda-gutter")));var r=X[0].clientWidth;(de=X.width()-r)?(M(a,de),a.show().prev().removeClass("fc-last")):a.hide().prev().addClass("fc-last"),se=Math.floor((r-oe)/_e),M(A.slice(0,-1),se)},R.setHeight=function(e){e===t&&(e=ie),ie=e,Ue={};var n=Y.position().top,a=X.position().top,r=Math.min(e-n,ne.height()+a+1);P.height(r-L(U)),V.css("top",n),X.height(r-a-1),ce=ne.find("tr:first").height()+1,ue=Re("slotMinutes")/fe,ge=ce/ue},R.afterRender=function(){v()},R.defaultEventEnd=function(e){var t=p(e.start);return e.allDay?t:f(t,Re("defaultEventMinutes"))},R.timePosition=T,R.getIsCellAllDay=x,R.allDayRow=function(e){return Z},R.getCoordinateGrid=function(){return be},R.getHoverListener=function(){return ke},R.colLeft=function(e){return Ce.left(e)},R.colRight=function(e){return Ce.right(e)},R.colContentLeft=function(e){return xe.left(e)},R.colContentRight=function(e){return xe.right(e)},R.getDaySegmentContainer=function(){return K},R.getSlotSegmentContainer=function(){return te},R.getMinMinute=function(){return $e},R.getMaxMinute=function(){return Ee},R.getSlotContainer=function(){return ee},R.getRowCnt=function(){return 1},R.getColCnt=function(){return _e},R.getColWidth=function(){return se},R.getSnapHeight=function(){return ge},R.getSnapMinutes=function(){return fe},R.defaultSelectionEnd=function(e,t){return t?p(e):f(p(e),Re("slotMinutes"))},R.renderDayOverlay=b,R.renderSelection=function(e,t,n){n?Re("allDaySlot")&&b(e,d(p(t),1),!0):E(e,t)},R.clearSelection=S,R.reportDayClick=j,R.dragStart=function(e,t,n){ke.start(function(e){if(Ae(),e)if(x(e))k(e.row,e.col,e.row,e.col);else{var t=D(e);C(t,f(p(t),Re("defaultEventMinutes")))}},t)},R.dragStop=function(e,t,n){var a=ke.stop();Ae(),a&&Ie("drop",e,D(a),x(a),t,n)},le.call(R,n,a,r),pe.call(R),he.call(R),G.call(R);var I,H,A,Y,N,Q,q,U,P,V,K,J,Z,X,ee,te,ne,ae,re,ie,oe,se,de,ce,fe,ue,ge,_e,we,be,ke,Ce,xe,Te,Me,$e,Ee,Se,Oe,je,Le,Re=R.opt,Ie=R.trigger,He=R.renderOverlay,Ae=R.clearOverlays,ze=R.reportSelection,Ye=R.unselect,Ne=R.daySelectionMousedown,Qe=R.slotSegHtml,Fe=R.cellToDate,We=R.dateToCell,Be=R.rangeToSegments,qe=a.formatDate,Ue={};W(n.addClass("fc-agenda")),be=new me(function(t,n){function a(e){return Math.max(l,Math.min(d,e))}var r,i,o;A.each(function(t,a){r=e(a),i=r.offset().left,t&&(o[1]=i),o=[i],n[t]=o}),o[1]=i+r.outerWidth(),Re("allDaySlot")&&(i=(r=Z).offset().top,t[0]=[i,i+r.outerHeight()]);for(var s=ee.offset().top,l=X.offset().top,d=l+X.outerHeight(),c=0;c<we*ue;c++)t.push([a(s+ge*c),a(s+ge*(c+1))])}),ke=new ve(be),Ce=new ye(function(e){return Q.eq(e)}),xe=new ye(function(e){return q.eq(e)})}function G(){function n(t){var n,i,o,s,l,d=A(),c=S(),u=M(),h=e.map(t,r),m=[];for(i=0;i<d;i++)for(f(n=H(0,i),c),l=Z(l=a(t,h,n,f(p(n),u-c))),o=0;o<l.length;o++)(s=l[o]).col=i,m.push(s);return m}function a(e,t,n,a){var r,i,o,s,l,d,c,f,u=[],h=e.length;for(r=0;r<h;r++)o=(i=e[r]).start,(s=t[r])>n&&o<a&&(o<n?(l=p(n),c=!1):(l=o,c=!0),s>a?(d=p(a),f=!1):(d=s,f=!0),u.push({event:i,start:l,end:d,isStart:c,isEnd:f}));return u.sort(se)}function r(e){return e.end?p(e.end):f(p(e.start),h("defaultEventMinutes"))}function i(n,a){var r,i,l,d,c,f,u,p,v,g,y,_,w,b,k,x,D=n.length,M="",$=C(),S=h("isRTL");for(r=0;r<D;r++)l=(i=n[r]).event,d=O(i.start,i.start),c=O(i.start,i.end),f=R(i.col),u=I(i.col),v=(p=(u-=.025*(p=u-f))-f)*(i.forwardCoord-i.backwardCoord),h("slotEventOverlap")&&(v=Math.max(2*(v-10),v)),S?g=(y=u-i.backwardCoord*p)-v:y=(g=f+i.backwardCoord*p)+v,g=Math.max(g,f),v=(y=Math.min(y,u))-g,e($[0]).closest(".rhcalendar").length>0&&e($[0]).closest(".rhcalendar").is(".rhc-timetable")&&(v+=5),i.top=d,i.left=g,i.outerWidth=v,i.outerHeight=c-d,M+=o(l,i);for($[0].innerHTML=M,_=$.children(),r=0;r<D;r++)l=(i=n[r]).event,w=e(_[r]),!1===(b=m("eventRender",l,l,w))?w.remove():(b&&!0!==b&&(w.remove(),w=e(b).css({position:"absolute",top:i.top,left:i.left}).appendTo($)),i.element=w,l._id===a?s(l,w,i):w[0]._fci=r,W(l,w));for(T($,n,s),r=0;r<D;r++)(w=(i=n[r]).element)&&(i.vsides=L(w,!0),i.hsides=E(w,!0),(k=w.find(".fc-event-title")).length&&(i.contentTop=k[0].offsetTop));for(r=0;r<D;r++)(w=(i=n[r]).element)&&(w[0].style.width=Math.max(0,i.outerWidth-i.hsides)+"px",x=Math.max(0,i.outerHeight-i.vsides),w[0].style.height=x+"px",l=i.event,i.contentTop!==t&&x-i.contentTop<10&&(w.find("div.fc-event-time").text(ee(l.start,h("timeFormat"))+" - "+l.title),w.find("div.fc-event-title").remove()),m("eventAfterRender",l,l,w))}function o(e,t){var n="<",a=e.url,r=q(e,h),i=["fc-event","fc-event-vert"];return g(e)&&i.push("fc-event-draggable"),t.isStart&&i.push("fc-event-start"),t.isEnd&&i.push("fc-event-end"),i=i.concat(e.className),e.source&&(i=i.concat(e.source.className||[])),n+=a?"a href='"+F(e.url)+"'":"div",n+=" class='"+i.join(" ")+"' style='position:absolute;top:"+t.top+"px;left:"+t.left+"px;"+r+"'><div class='fc-event-inner'><div class='fc-event-time'>"+F(te(e.start,e.end,h("timeFormat")))+"</div><div class='fc-event-title'>"+F(e.title||"")+"</div></div><div class='fc-event-bg'></div>",t.isEnd&&y(e)&&(n+="<div class='ui-resizable-handle ui-resizable-s'>=</div>"),n+="</"+(a?"a":"div")+">"}function s(e,t,n){var a=t.find("div.fc-event-time");g(e)&&l(e,t,a),n.isEnd&&y(e)&&c(e,t,a),w(e,t)}function l(e,t,n){function a(){J(),s&&(c?(n.hide(),t.draggable("option","grid",null),K(d(p(e.start),w),d(x(e),w))):(r(b),n.css("display",""),t.draggable("option","grid",[T,M])))}function r(t){var a,r=f(p(e.start),t);e.end&&(a=f(p(e.end),t)),n.text(te(r,a,h("timeFormat")))}var i,o,s,l,c,g,y,_,w,b,k,C=u.getCoordinateGrid(),D=A(),T=z(),M=Y(),$=N();t.draggable({scroll:!1,grid:[T,M],axis:1==D&&"y",opacity:h("dragOpacity"),revertDuration:h("dragRevertDuration"),start:function(n,a){m("eventDragStart",t,e,n,a),U(e,t),C.build(),i=t.position(),o=C.cell(n.pageX,n.pageY),s=l=!0,c=g=j(o),y=_=0,w=0,b=k=0},drag:function(e,n){var r=C.cell(e.pageX,e.pageY);if(s=!!r){if(c=j(r),(y=Math.round((n.position.left-i.left)/T))!=_){var d=H(0,o.col),f=o.col+y;f=Math.max(0,f),f=Math.min(D-1,f);var u=H(0,f);w=v(u,d)}c||(b=Math.round((n.position.top-i.top)/M)*$)}s==l&&c==g&&y==_&&b==k||(a(),l=s,g=c,_=y,k=b),t.draggable("option","revert",!s)},stop:function(n,r){J(),m("eventDragStop",t,e,n,r),s&&(c||w||b)?P(this,e,w,c?0:b,c,n,r):(s=!0,c=!1,y=0,w=0,b=0,a(),t.css("filter",""),t.css(i),B(e,t))}})}function c(e,t,n){var a,r,i=Y(),o=N();t.resizable({handles:{s:".ui-resizable-handle"},grid:i,start:function(n,i){a=r=0,U(e,t),m("eventResizeStart",this,e,n,i)},resize:function(s,l){(a=Math.round((Math.max(i,t.height())-l.originalSize.height)/i))!=r&&(n.text(te(e.start,a||e.end?f(_(e),o*a):null,h("timeFormat"))),r=a)},stop:function(n,r){m("eventResizeStop",this,e,n,r),a?V(this,e,0,o*a,n,r):B(e,t)}})}var u=this;u.renderEvents=function(e,t){var a,r=e.length,o=[],s=[];for(a=0;a<r;a++)e[a].allDay?o.push(e[a]):s.push(e[a]);h("allDaySlot")&&(G(o,t),b()),i(n(s),t)},u.clearEvents=function(){k().empty(),C().empty()},u.slotSegHtml=o,de.call(u);var h=u.opt,m=u.trigger,g=u.isEventDraggable,y=u.isEventResizable,_=u.eventEnd,w=u.eventElementHandlers,b=u.setHeight,k=u.getDaySegmentContainer,C=u.getSlotSegmentContainer,D=u.getHoverListener,M=u.getMaxMinute,S=u.getMinMinute,O=u.timePosition,j=u.getIsCellAllDay,R=u.colContentLeft,I=u.colContentRight,H=u.cellToDate,A=u.getColCnt,z=u.getColWidth,Y=u.getSnapHeight,N=u.getSnapMinutes,Q=u.getSlotContainer,W=u.reportEventElement,B=u.showEvents,U=u.hideEvents,P=u.eventDrop,V=u.eventResize,K=u.renderDayOverlay,J=u.clearOverlays,G=u.renderDayEvents,X=u.calendar,ee=X.formatDate,te=X.formatDates;u.draggableDayEvent=function(e,t,n){function a(){l||(t.width(r).height("").draggable("option","grid",null),l=!0)}var r,i,o,s=n.isStart,l=!0,c=D(),f=z(),u=Y(),g=N(),y=S();t.draggable({opacity:h("dragOpacity","month"),revertDuration:h("dragRevertDuration"),start:function(n,y){m("eventDragStart",t,e,n,y),U(e,t),r=t.width(),c.start(function(n,r){if(J(),n){i=!1;var c=H(0,r.col),m=H(0,n.col);o=v(m,c),n.row?s?l&&(t.width(f-10),$(t,u*Math.round((e.end?(e.end-e.start)/$e:h("defaultEventMinutes"))/g)),t.draggable("option","grid",[f,1]),l=!1):i=!0:(K(d(p(e.start),o),d(x(e),o)),a()),i=i||l&&!o}else a(),i=!0;t.draggable("option","revert",i)},n,"drag")},stop:function(n,r){if(c.stop(),J(),m("eventDragStop",t,e,n,r),i)a(),t.css("filter",""),B(e,t);else{var s=0;l||(s=Math.round((t.offset().top-Q().offset().top)/u)*g+y-(60*e.start.getHours()+e.start.getMinutes())),P(this,e,o,s,l,n,r)}}})}}function Z(e){var t,n=X(e),a=n[0];if(ee(n),a){for(t=0;t<a.length;t++)te(a[t]);for(t=0;t<a.length;t++)ne(a[t],0,0)}return ae(n)}function X(e){var t,n,a,r=[];for(t=0;t<e.length;t++){for(n=e[t],a=0;a<r.length&&re(n,r[a]).length;a++);(r[a]||(r[a]=[])).push(n)}return r}function ee(e){var t,n,a,r,i;for(t=0;t<e.length;t++)for(n=e[t],a=0;a<n.length;a++)for((r=n[a]).forwardSegs=[],i=t+1;i<e.length;i++)re(r,e[i],r.forwardSegs)}function te(e){var n,a,r=e.forwardSegs,i=0;if(e.forwardPressure===t){for(n=0;n<r.length;n++)te(a=r[n]),i=Math.max(i,1+a.forwardPressure);e.forwardPressure=i}}function ne(e,n,a){var r,i=e.forwardSegs;if(e.forwardCoord===t)for(i.length?(i.sort(oe),ne(i[0],n+1,a),e.forwardCoord=i[0].backwardCoord):e.forwardCoord=1,e.backwardCoord=e.forwardCoord-(e.forwardCoord-a)/(n+1),r=0;r<i.length;r++)ne(i[r],0,e.forwardCoord)}function ae(e){var t,n,a,r=[];for(t=0;t<e.length;t++)for(n=e[t],a=0;a<n.length;a++)r.push(n[a]);return r}function re(e,t,n){n=n||[];for(var a=0;a<t.length;a++)ie(e,t[a])&&n.push(t[a]);return n}function ie(e,t){return e.end>t.start&&e.start<t.end}function oe(e,t){return t.forwardPressure-e.forwardPressure||(e.backwardCoord||0)-(t.backwardCoord||0)||se(e,t)}function se(e,t){return e.start-t.start||t.end-t.start-(e.end-e.start)||(e.event.title||"").localeCompare(t.event.title)}function le(n,r,i){function o(t,n){var a=E[t];return e.isPlainObject(a)?Q(a,n||i):a}function s(e,t){return r.trigger.apply(r,[e,t||k].concat(Array.prototype.slice.call(arguments,2),[k]))}function l(e){return e.end?p(e.end):C(e)}function c(e,t,n){var a,r=M[e._id],i=r.length;for(a=0;a<i;a++)t&&r[a][0]==t[0]||r[a][n]()}function u(e,n,a,r){a=a||0;for(var i,o=e.length,s=0;s<o;s++)i=e[s],r!==t&&(i.allDay=r),f(d(i.start,n,!0),a),i.end&&(i.end=f(d(i.end,n,!0),a)),x(i,E)}function h(e,t,n){n=n||0;for(var a,r=e.length,i=0;i<r;i++)(a=e[i]).end=f(d(l(a),t,!0),n),x(a,E)}function m(e,t){var n=k.getColCnt(),a=I?-1:1,r=I?n-1:0;return"object"==typeof e&&(t=e.col,e=e.row),e*n+(t*a+r)}function g(e){var t=k.visStart.getDay();return e+=L[t],7*Math.floor(e/S)+R[(e%S+S)%S]-t}function y(e){var t=p(k.visStart);return d(t,e),t}function _(e){return v(e,k.visStart)}function w(e){var t=k.visStart.getDay();return e+=t,Math.floor(e/7)*S+L[(e%7+7)%7]-L[t]}function b(e){var t=k.getColCnt(),n=I?-1:1,a=I?t-1:0;return{row:Math.floor(e/t),col:(e%t+t)%t*n+a}}var k=this;k.element=n,k.calendar=r,k.name=i,k.opt=o,k.trigger=s,k.isEventDraggable=function(e){var t=e.source||{};return P(e.startEditable,t.startEditable,o("eventStartEditable"),e.editable,t.editable,o("editable"))&&!o("disableDragging")},k.isEventResizable=function(e){var t=e.source||{};return P(e.durationEditable,t.durationEditable,o("eventDurationEditable"),e.editable,t.editable,o("editable"))&&!o("disableResizing")},k.setEventData=function(e){T={};var t,n,a=e.length;for(t=0;t<a;t++)n=e[t],T[n._id]?T[n._id].push(n):T[n._id]=[n]},k.clearEventData=function(){T={},M={},$=[]},k.eventEnd=l,k.reportEventElement=function(e,t){$.push({event:e,element:t}),M[e._id]?M[e._id].push(t):M[e._id]=[t]},k.triggerEventDestroy=function(){e.each($,function(e,t){k.trigger("eventDestroy",t.event,t.event,t.element)})},k.eventElementHandlers=function(e,t){t.click(function(n){if(!t.hasClass("ui-draggable-dragging")&&!t.hasClass("ui-resizable-resizing"))return s("eventClick",this,e,n)}).hover(function(t){s("eventMouseover",this,e,t)},function(t){s("eventMouseout",this,e,t)})},k.showEvents=function(e,t){c(e,t,"show")},k.hideEvents=function(e,t){c(e,t,"hide")},k.eventDrop=function(e,t,n,a,r,i,o){var l=t.allDay,d=t._id;u(T[d],n,a,r),s("eventDrop",e,t,n,a,r,function(){u(T[d],-n,-a,l),D(d)},i,o),D(d)},k.eventResize=function(e,t,n,a,r,i){var o=t._id;h(T[o],n,a),s("eventResize",e,t,n,a,function(){h(T[o],-n,-a),D(o)},r,i),D(o)};var C=k.defaultEventEnd,x=r.normalizeEvent,D=r.reportEventChange,T={},M={},$=[],E=r.options;k.isHiddenDay=function(e){return"object"==typeof e&&(e=e.getDay()),j[e]},k.skipHiddenDays=function(e,t,n){for(t=t||1;j[(e.getDay()+(n?t:0)+7)%7];)d(e,t)},k.getCellsPerWeek=function(){return S},k.dateToCell=function(e){return b(w(_(e)))},k.dateToDayOffset=_,k.dayOffsetToCellOffset=w,k.cellOffsetToCell=b,k.cellToDate=function(){return y(g(m.apply(null,arguments)))},k.cellToCellOffset=m,k.cellOffsetToDayOffset=g,k.dayOffsetToDate=y,k.rangeToSegments=function(t,n,r){var i=k.getRowCnt(),o=k.getColCnt(),s=[],l=_(t),d=_(n);nextDayThreshold=!(!E.nextDayThreshold||""==E.nextDayThreshold)&&parseInt(E.nextDayThreshold),r&&r.end&&r.end.getHours&&!1!==nextDayThreshold&&d-l>1&&r.end.getHours()<=nextDayThreshold&&(d-=1);for(var c=w(l),f=w(d)-1,u=0;u<i;u++){var h=u*o,p=h+o-1,m=Math.max(c,h),v=Math.min(f,p);if(m<=v){var y=b(m),C=b(v),x=[y.col,C.col].sort(),D=g(m)==l,T=g(v)+1==d;s.push({row:u,leftCol:x[0],rightCol:x[1],isStart:D,isEnd:T})}}return e(k.element).parents(".rhcalendar.not-widget").hasClass("fc-small")?(new_segments=[],e.each(s,function(e,t){if(leftCol=t.leftCol,rightCol=t.rightCol,leftCol<rightCol)for(a=leftCol;a<=rightCol;a++){var n=jQuery.extend({},t);n.leftCol=a,n.rightCol=a,new_segments.push(n)}else new_segments.push(t)}),new_segments):s};var S,O=o("hiddenDays")||[],j=[],L=[],R=[],I=o("isRTL");!function(){!1===o("weekends")&&O.push(0,6);for(var t=0,n=0;t<7;t++)L[t]=n,j[t]=-1!=e.inArray(t,O),j[t]||(R[n]=t,n++);if(!(S=n))throw"invalid hiddenDays"}()}function de(){function t(e,t,a){var r=[];return fe(n([e],!0,!1),function(e,n){e.row===t&&n.css("top",a),r.push(n[0])}),r}function n(t,n,r){var s,d,f=V(),u=n?e("<div/>"):f,h=a(t);i(h),s=o(h),u[0].innerHTML=s,d=u.children(),n&&f.append(d),l(h,d);var p=e(f).closest(".rhc_holder");return p.find(".fc-day").removeClass("has-event"),fe(h,function(e,t){_date=b(e.event.start,"yyyy-MM-dd"),p.find('[data-date="'+_date+'"]').addClass("has-event")}),fe(h,function(e,t){e.hsides=E(t,!0)}),fe(h,function(e,t){t.width(Math.max(0,e.outerWidth-e.hsides))}),fe(h,function(e,t){e.outerHeight=t.outerHeight(!0)}),c(h,r),h}function a(e){for(var t=[],n=0;n<e.length;n++){var a=r(e[n]);t.push.apply(t,a)}return t}function r(e){for(var t=e.start,n=x(e),a=ee(t,n,e),r=0;r<a.length;r++)a[r].event=e;return a}function i(e){for(var t=C("isRTL"),n=0;n<e.length;n++){var a=e[n],r=(t?a.isEnd:a.isStart)?U:Q,i=(t?a.isStart:a.isEnd)?P:B,o=r(a.leftCol),s=i(a.rightCol);a.left=o,a.outerWidth=s-o}}function o(e){for(var t="",n=0;n<e.length;n++)t+=s(e[n]);return t}function s(e){var t="",n=C("isRTL"),a=e.event,r=a.url,i=["fc-event","fc-event-hori"];M(a)&&i.push("fc-event-draggable"),e.isStart&&i.push("fc-event-start"),e.isEnd&&i.push("fc-event-end"),i=i.concat(a.className),a.source&&(i=i.concat(a.source.className||[]));var o=q(a,C);return t+=r?"<a href='"+F(r)+"'":"<div",t+=" class='"+i.join(" ")+"' style='position:absolute;left:"+e.left+"px;"+o+"'><div class='fc-event-inner'>",!a.allDay&&e.isStart&&(t+="<span class='fc-event-time'>"+F(K(a.start,a.end,C("timeFormat")))+"</span>"),t+="<span class='fc-event-title'>"+F(a.title||"")+"</span></div>",e.isEnd&&$(a)&&(t+="<div class='ui-resizable-handle ui-resizable-"+(n?"w":"e")+"'>&nbsp;&nbsp;&nbsp;</div>"),t+="</"+(r?"a":"div")+">"}function l(t,n){for(var a=0;a<t.length;a++){var r=t[a],i=r.event,o=n.eq(a),s=D("eventRender",i,i,o);!1===s?o.remove():(s&&!0!==s&&(s=e(s).css({position:"absolute",left:r.left}),o.replaceWith(s),o=s),r.element=o)}}function c(t,n){f(t);var a=y(),r=[],i=A(),o=(z(),[]);for(row=0;row<i;row++)o[row]=[],fe(t,function(e,t){if(e.row==row&&!(e.leftCol>e.rightcol))for(col=e.leftCol;col<=e.rightCol;col++)o[row][col]=o[row][col]||0,o[row][col]+=e.outerHeight});if(n)for(s=0;s<a.length;s++)if(a[s].length>=o[s].length)for(l=0;l<a[s].length;l++)h=!(!o[s]||!o[s][l])&&o[s][l],!1===h?a[s].eq(l).addClass("fc-day-no-events"):a[s].eq(l).height(h);else new_h=0,e.each(o[s],function(e,t){new_h=t>new_h?t:new_h}),a[s].height(new_h);for(var s=0;s<a.length;s++)for(var l=0;l<a[s].length;l++)r[s]=r[s]||[],r[s][l]=a[s].eq(l).position().top;fe(t,function(e,t){contentTop=r[e.row][e.leftCol]||r[e.row][0],t.css("top",contentTop+e.top)})}function f(e){for(var t=A(),n=z(),a=[],r=u(e),i=0;i<t;i++){for(var o=r[i],s=[],l=0;l<n;l++)s.push(0);for(var d=0;d<o.length;d++){var c=o[d];c.top=Y(s.slice(c.leftCol,c.rightCol+1));for(l=c.leftCol;l<=c.rightCol;l++)s[l]=c.top+c.outerHeight}a.push(Y(s))}return a}function u(e){var t,n,a,r=A(),i=[];for(t=0;t<e.length;t++)a=(n=e[t]).row,n.element&&(i[a]?i[a].push(n):i[a]=[n]);for(a=0;a<r;a++)i[a]=m(i[a]||[]);return i}function m(e){for(var t=[],n=g(e),a=0;a<n.length;a++)t.push.apply(t,n[a]);return t}function g(e){e.sort(ue);for(var t=[],n=0;n<e.length;n++){for(var a=e[n],r=0;r<t.length&&ce(a,t[r]);r++);t[r]?t[r].push(a):t[r]=[a]}return t}function y(){var e,t=A(),n=[];for(e=0;e<t;e++)n[e]=N(e).find("div.fc-day-content > div");return n}function _(e,t){var n=V();fe(e,function(e,n,a){var r=e.event;r._id===t?w(r,n,e):n[0]._fci=a}),T(n,e,w)}function w(e,t,n){M(e)&&k.draggableDayEvent(e,t,n),n.isEnd&&$(e)&&k.resizableDayEvent(e,t,n),j(e,t)}var k=this;k.renderDayEvents=function(e,t){var a=n(e,!1,!0);fe(a,function(e,t){O(e.event,t)}),_(a,t),fe(a,function(e,t){D("eventAfterRender",e.event,e.event,t)})},k.draggableDayEvent=function(e,t){var n,a=X();t.draggable({delay:50,opacity:C("dragOpacity"),revertDuration:C("dragRevertDuration"),start:function(r,i){D("eventDragStart",t,e,r,i),R(e,t),a.start(function(a,r,i,o){if(t.draggable("option","revert",!a||!i&&!o),G(),a){var s=te(r),l=te(a);n=v(l,s),J(d(p(e.start),n),d(x(e),n))}else n=0},r,"drag")},stop:function(r,i){a.stop(),G(),D("eventDragStop",t,e,r,i),n?I(this,e,n,0,e.allDay,r,i):(t.css("filter",""),L(e,t))}})},k.resizableDayEvent=function(n,a,r){var i=C("isRTL")?"w":"e",o=a.find(".ui-resizable-"+i),s=!1;W(a),a.mousedown(function(e){e.preventDefault()}).click(function(e){s&&(e.preventDefault(),e.stopImmediatePropagation())}),o.mousedown(function(o){if(1==o.which){s=!0;var l,c,f=X(),u=(A(),z(),a.css("top")),h=e.extend({},n),p=ie(re(n.start));Z(),e("body").css("cursor",i+"-resize").one("mouseup",function(t){D("eventResizeStop",this,n,t),e("body").css("cursor",""),f.stop(),G(),l&&H(this,n,l,0,t),setTimeout(function(){s=!1},0)}),D("eventResizeStart",this,n,o),f.start(function(a,o){if(a){var s=ne(o),f=ne(a);if(f=Math.max(f,p),l=ae(f)-ae(s)){h.end=d(S(n),l,!0);var m=c;c=t(h,r.row,u),(c=e(c)).find("*").css("cursor",i+"-resize"),m&&m.remove(),R(n)}else c&&(L(n),c.remove(),c=null);G(),J(n.start,d(x(n),l))}},o)}})};var C=k.opt,D=k.trigger,M=k.isEventDraggable,$=k.isEventResizable,S=k.eventEnd,O=k.reportEventElement,j=k.eventElementHandlers,L=k.showEvents,R=k.hideEvents,I=k.eventDrop,H=k.eventResize,A=k.getRowCnt,z=k.getColCnt,N=(k.getColWidth,k.allDayRow),Q=k.colLeft,B=k.colRight,U=k.colContentLeft,P=k.colContentRight,V=(k.dateToCell,k.getDaySegmentContainer),K=k.calendar.formatDates,J=k.renderDayOverlay,G=k.clearOverlays,Z=k.clearSelection,X=k.getHoverListener,ee=k.rangeToSegments,te=k.cellToDate,ne=k.cellToCellOffset,ae=k.cellOffsetToDayOffset,re=k.dateToDayOffset,ie=k.dayOffsetToCellOffset}function ce(e,t){for(var n=0;n<t.length;n++){var a=t[n];if(a.leftCol<=e.rightCol&&a.rightCol>=e.leftCol)return!0}return!1}function fe(e,t){for(var n=0;n<e.length;n++){var a=e[n],r=a.element;r&&t(a,r,n)}}function ue(e,t){return t.rightCol-t.leftCol-(e.rightCol-e.leftCol)||t.event.allDay-e.event.allDay||e.event.start-t.event.start||(e.event.title||"").localeCompare(t.event.title)}function he(){function t(e){d&&(d=!1,l(),i("unselect",null,e))}function n(e,t,n,a){d=!0,i("select",null,e,t,n,a)}var a=this;a.select=function(e,a,r){t(),a||(a=o(e,r)),s(e,a,r),n(e,a,r)},a.unselect=t,a.reportSelection=n,a.daySelectionMousedown=function(i){var o=a.cellToDate,d=a.getIsCellAllDay,c=a.getHoverListener(),f=a.reportDayClick;if(1==i.which&&r("selectable")){t(i);var u;c.start(function(e,t){l(),e&&d(e)?(u=[o(t),o(e)].sort(z),s(u[0],u[1],!0)):u=null},i),e(document).one("mouseup",function(e){c.stop(),u&&(+u[0]==+u[1]&&f(u[0],!0,e),n(u[0],u[1],!0,e))})}};var r=a.opt,i=a.trigger,o=a.defaultSelectionEnd,s=a.renderSelection,l=a.clearSelection,d=!1;r("selectable")&&r("unselectAuto")&&e(document).mousedown(function(n){var a=r("unselectCancel");a&&e(n.target).parents(a).length||t(n)})}function pe(){var t=this;t.renderOverlay=function(t,r){var i=a.shift();return i||(i=e("<div class='fc-cell-overlay' style='position:absolute;z-index:3'/>")),i[0].parentNode!=r[0]&&i.appendTo(r),n.push(i.css(t).show()),i},t.clearOverlays=function(){for(var e;e=n.shift();)a.push(e.hide().unbind())};var n=[],a=[]}function me(e){var t,n,a=this;a.build=function(){e(t=[],n=[])},a.cell=function(e,a){var r,i=t.length,o=n.length,s=-1,l=-1;for(r=0;r<i;r++)if(a>=t[r][0]&&a<t[r][1]){s=r;break}for(r=0;r<o;r++)if(e>=n[r][0]&&e<n[r][1]){l=r;break}return s>=0&&l>=0?{row:s,col:l}:null},a.rect=function(e,a,r,i,o){var s=o.offset();return{top:t[e][0]-s.top,left:n[a][0]-s.left,width:n[i][1]-n[a][0],height:t[r][1]-t[e][0]}}}function ve(t){function n(e){ge(e);var n=t.cell(e.pageX,e.pageY);(!n!=!o||n&&(n.row!=o.row||n.col!=o.col))&&(n?(i||(i=n),r(n,i,n.row-i.row,n.col-i.col)):r(n,i),o=n)}var a,r,i,o,s=this;s.start=function(s,l,d){r=s,i=o=null,t.build(),n(l),a=d||"mousemove",e(document).bind(a,n)},s.stop=function(){return e(document).unbind(a,n),o}}function ge(e){e.pageX===t&&(e.pageX=e.originalEvent.pageX,e.pageY=e.originalEvent.pageY)}function ye(e){function n(t){return r[t]=r[t]||e(t)}var a=this,r={},i={},o={};a.left=function(e){return i[e]=i[e]===t?n(e).position().left:i[e]},a.right=function(e){return o[e]=o[e]===t?a.left(e)+n(e).width():o[e]},a.clear=function(){r={},i={},o={}}}var _e={defaultView:"month",aspectRatio:1.35,header:{left:"title",center:"",right:"today prev,next"},weekends:!0,weekNumbers:!1,weekNumberCalculation:"iso",weekNumberTitle:"W",allDayDefault:!0,ignoreTimezone:!0,lazyFetching:!0,startParam:"start",endParam:"end",titleFormat:{month:"MMMM yyyy",week:"MMM d[ yyyy]{ '&#8212;'[ MMM] d yyyy}",day:"dddd, MMM d, yyyy"},columnFormat:{month:"ddd",week:"ddd M/d",day:"dddd M/d"},timeFormat:{"":"h(:mm)t"},isRTL:!1,firstDay:0,monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],buttonText:{prev:"<span class='fc-text-arrow'>&lsaquo;</span>",next:"<span class='fc-text-arrow'>&rsaquo;</span>",prevYear:"<span class='fc-text-arrow'>&laquo;</span>",nextYear:"<span class='fc-text-arrow'>&raquo;</span>",today:"today",month:"month",week:"week",day:"day"},theme:!1,buttonIcons:{prev:"circle-triangle-w",next:"circle-triangle-e"},unselectAuto:!0,dropAccept:"*",handleWindowResize:!0},we={header:{left:"next,prev today",center:"",right:"title"},buttonText:{prev:"<span class='fc-text-arrow'>&rsaquo;</span>",next:"<span class='fc-text-arrow'>&lsaquo;</span>",prevYear:"<span class='fc-text-arrow'>&raquo;</span>",nextYear:"<span class='fc-text-arrow'>&laquo;</span>"},buttonIcons:{prev:"circle-triangle-e",next:"circle-triangle-w"}},be=e.fullCalendar={version:"1.6.4"},ke=be.views={};e.fn.fullCalendar=function(n){if("string"==typeof n){var a,i=Array.prototype.slice.call(arguments,1);return this.each(function(){var r=e.data(this,"fullCalendar");if(r&&e.isFunction(r[n])){var o=r[n].apply(r,i);a===t&&(a=o),"destroy"==n&&e.removeData(this,"fullCalendar")}}),a!==t?a:this}var o=(n=n||{}).eventSources||[];return delete n.eventSources,n.events&&(o.push(n.events),delete n.events),n=e.extend(!0,{},_e,n.isRTL||n.isRTL===t&&_e.isRTL?we:{},n),this.each(function(t,a){var i=e(a),s=new r(i,n,o);i.data("fullCalendar",s),s.render()}),this},be.sourceNormalizers=[],be.sourceFetchers=[];var Ce={dataType:"json",cache:!1},xe=1;be.addDays=d,be.cloneDate=p,be.parseDate=y,be.parseISO8601=_,be.parseTime=w,be.formatDate=b,be.formatDates=k,be.addMonths=l;var De=["sun","mon","tue","wed","thu","fri","sat"],Te=864e5,Me=36e5,$e=6e4,Ee={s:function(e){return e.getSeconds()},ss:function(e){return N(e.getSeconds())},m:function(e){return e.getMinutes()},mm:function(e){return N(e.getMinutes())},h:function(e){return e.getHours()%12||12},hh:function(e){return N(e.getHours()%12||12)},H:function(e){return e.getHours()},HH:function(e){return N(e.getHours())},d:function(e){return e.getDate()},dd:function(e){return N(e.getDate())},ddd:function(e,t){return t.dayNamesShort[e.getDay()]},dddd:function(e,t){return t.dayNames[e.getDay()]},M:function(e){return e.getMonth()+1},MM:function(e){return N(e.getMonth()+1)},MMM:function(e,t){return t.monthNamesShort[e.getMonth()]},MMMM:function(e,t){return t.monthNames[e.getMonth()]},yy:function(e){return(e.getFullYear()+"").substring(2)},yyyy:function(e){return e.getFullYear()},t:function(e){return e.getHours()<12?"a":"p"},tt:function(e){return e.getHours()<12?"am":"pm"},T:function(e){return e.getHours()<12?"A":"P"},TT:function(e){return e.getHours()<12?"AM":"PM"},u:function(e){return b(e,"yyyy-MM-dd'T'HH:mm:ss'Z'")},S:function(e){var t=e.getDate();return t>10&&t<20?"th":["st","nd","rd"][t%10-1]||"th"},w:function(e,t){return t.weekNumberCalculation(e)},W:function(e){return C(e)}};be.dateFormatters=Ee,be.applyAll=U,ke.month=function(e,t){var n=this;n.render=function(e,c){var f=a("left_trim_date")?Math.abs(parseInt(a("left_trim_date"))):0,u=a("right_trim_date")?Math.abs(parseInt(a("right_trim_date"))):0;f=f>28?28:f,u=u>28?28:u,f&&u&&f>u&&(_tmp=f,f=u,u=_tmp);var h=!1;a("upcoming")&&a("upcoming_trim_past")&&(h=0!=(h=parseInt(a("upcoming_trim_past"))));var m=new Date;c&&(l(e,c),e.setDate(1));var g=a("firstDay"),y=p(e,!0);if(y.setDate(1),end=l(p(y),1),h&&end.getTime()<m.getTime())t.next();else{(h=h&&y.getTime()<m.getTime())&&(e=p(y=new Date,!0),end=l(p(y),1),end.setDate(0),end.setHours(23,59,59)),f&&y.setDate(f),u&&(end=p(y),end.setDate(u),end.setHours(23,59,59));var _=p(y);d(_,-(_.getDay()-g+7)%7),i(_);var w=p(end);d(w,(7-w.getDay()+g)%7),i(w,-1,!0);var b=o(),k=Math.ceil(v(w,_)/7);"fixed"==a("weekMode")&&(_weeks_to_add=6-k,_weeks_to_add>0&&d(w,7*_weeks_to_add),k=6,h)&&(k=Math.ceil(v(w,_)/7)),n.title=s(y,a("titleFormat")),n.start=y,n.end=end,n.visStart=_,n.visEnd=w,r(k,b,!0)}},V.call(n,e,t,"month");var a=n.opt,r=n.renderBasic,i=n.skipHiddenDays,o=n.getCellsPerWeek,s=t.formatDate},ke.basicWeek=function(e,t){var n=this;n.render=function(e,t){t&&d(e,7*t);var l=d(p(e),-(e.getDay()-a("firstDay")+7)%7),c=d(p(l),7),f=p(l);i(f);var u=p(c);i(u,-1,!0);var h=o();n.start=l,n.end=c,n.visStart=f,n.visEnd=u,n.title=s(f,d(p(u),-1),a("titleFormat")),r(1,h,!0)},V.call(n,e,t,"basicWeek");var a=n.opt,r=n.renderBasic,i=n.skipHiddenDays,o=n.getCellsPerWeek,s=t.formatDates},ke.basicDay=function(e,t){var n=this;n.render=function(e,t){t&&d(e,t),i(e,t<0?-1:1);var s=p(e,!0),l=d(p(s),1);n.title=o(e,a("titleFormat")),n.start=n.visStart=s,n.end=n.visEnd=l,r(1,1,!1)},V.call(n,e,t,"basicDay");var a=n.opt,r=n.renderBasic,i=n.skipHiddenDays,o=t.formatDate},n({weekMode:"fixed"}),ke.agendaWeek=function(e,t){var n=this;n.render=function(e,t){t&&d(e,7*t);var l=d(p(e),-(e.getDay()-a("firstDay")+7)%7),c=d(p(l),7),f=p(l);i(f);var u=p(c);i(u,-1,!0);var h=o();n.title=s(f,d(p(u),-1),a("titleFormat")),n.start=l,n.end=c,n.visStart=f,n.visEnd=u,r(h)},J.call(n,e,t,"agendaWeek");var a=n.opt,r=n.renderAgenda,i=n.skipHiddenDays,o=n.getCellsPerWeek,s=t.formatDates},ke.agendaDay=function(e,t){var n=this;n.render=function(e,t){t&&d(e,t),i(e,t<0?-1:1);var s=p(e,!0),l=d(p(s),1);n.title=o(e,a("titleFormat")),n.start=n.visStart=s,n.end=n.visEnd=l,r(1)},J.call(n,e,t,"agendaDay");var a=n.opt,r=n.renderAgenda,i=n.skipHiddenDays,o=t.formatDate},n({allDaySlot:!0,allDayText:"all-day",firstHour:6,slotMinutes:30,defaultEventMinutes:120,axisFormat:"h(:mm)tt",timeFormat:{agenda:"h:mm{ - h:mm}"},dragOpacity:{agenda:.5},minTime:0,maxTime:24,slotEventOverlap:!0})}(jQuery),function(e){function t(t,n,s){var l=t.success,d=e.extend({},t.data||{},{"start-min":a(n,"u"),"start-max":a(s,"u"),singleevents:!0,"max-results":9999}),c=t.currentTimezone;return c&&(d.ctz=c=c.replace(" ","_")),e.extend({},t,{url:t.url.replace(/\/basic$/,"/full")+"?alt=json-in-script&callback=?",dataType:"jsonp",data:d,startParam:!1,endParam:!1,success:function(t){var n=[];t.feed.entry&&e.each(t.feed.entry,function(t,a){var o,s=a.gd$when[0].startTime,l=r(s,!0),d=r(a.gd$when[0].endTime,!0),f=-1==s.indexOf("T");e.each(a.link,function(e,t){"text/html"==t.type&&(o=t.href,c&&(o+=(-1==o.indexOf("?")?"?":"&")+"ctz="+c))}),f&&i(d,-1),n.push({id:a.gCal$uid.value,title:a.title.$t,url:o,start:l,end:d,allDay:f,location:a.gd$where[0].valueString,description:a.content.$t})});var a=[n].concat(Array.prototype.slice.call(arguments,1)),s=o(l,this,a);return e.isArray(s)?s:n}})}var n=e.fullCalendar,a=n.formatDate,r=n.parseISO8601,i=n.addDays,o=n.applyAll;n.sourceNormalizers.push(function(e){("gcal"==e.dataType||void 0===e.dataType&&(e.url||"").match(/^(http|https):\/\/www.google.com\/calendar\/feeds\//))&&(e.dataType="gcal",void 0===e.editable&&(e.editable=!1))}),n.sourceFetchers.push(function(e,n,a){if("gcal"==e.dataType)return t(e,n,a)}),n.gcalFeed=function(t,n){return e.extend({},n,{url:t,dataType:"gcal"})}}(jQuery),function(e){function t(t,n){function a(t){if(!1!==d.have_events){var a=e("#"+t+" .fc-view-rhc_event");if(a.is(":visible")&&!d.scroll_lockdown){var r=e(a).parents(".rhc_holder"),i=r.offset();if(window.mobile?paddingForMobile=1e3:paddingForMobile=0,e(window).scrollTop()+e(window).height()==e(document).height())d.scroll_lockdown=!0,e(a).parents(".rhc_holder").find(".fullCalendar").fullCalendar("next");else{var o=(o=n.options.eventList.scrolloffset&&""!=n.options.eventList.scrolloffset?n.options.eventList.scrolloffset:e(window).height()/2)-paddingForMobile;document_bottom=e(document).scrollTop()+e(window).height(),bottom_position=i.top+r.outerHeight(),document_bottom>bottom_position+o&&(d.scroll_lockdown=!0,e(a).parents(".rhc_holder").find(".fullCalendar").fullCalendar("next"))}}}}function r(e,t,n,a){e.each(t,function(t,r){void 0!==a.extended_detail_cache[r]&&n.find(".ext_det_"+r).each(function(t,n){var i=a.extended_detail_cache[r].clone(),o=e(n).data("ev");if(i.find(".postmeta-fc_start .fe-extrainfo-value").html(e.fullCalendar.formatDate(o.start,a.options.eventList.extDateFormat||"MMMM d, yyyy",a.options)),i.find(".postmeta-fc_start_time .fe-extrainfo-value").html(e.fullCalendar.formatDate(o.start,a.options.eventList.extTimeFormat||"h:mm tt",a.options)),i.find(".postmeta-fc_start_datetime .fe-extrainfo-value").html(e.fullCalendar.formatDate(o.start,a.options.eventList.extDateTimeFormat||"MMMM d, yyyy. h:mm tt",a.options)),i.find(".postmeta-fc_end .fe-extrainfo-value").html(e.fullCalendar.formatDate(o.end,a.options.eventList.extDateFormat||"MMMM d, yyyy",a.options)),i.find(".postmeta-fc_end_time .fe-extrainfo-value").html(e.fullCalendar.formatDate(o.end,a.options.eventList.extTimeFormat||"h:mm tt",a.options)),i.find(".postmeta-fc_end_datetime .fe-extrainfo-value").html(e.fullCalendar.formatDate(o.end,a.options.eventList.extDateTimeFormat||"MMMM d, yyyy. h:mm tt",a.options)),i.find(".fc-button-social-panels").length>0){var s=i.find(".fc-button-social-panels");new_rhp_vars=s.data("rhp_vars"),new_rhp_vars.shareLink=o.url,new_rhp_vars.shareRedirectURI=o.url,s.data("rhp_vars",new_rhp_vars)}i.find(".fe-image-holder").RHCLink(o,e(n).closest(".fullCalendar").fullCalendar("getView")),original=e(n).replaceWith(i),i.parent().find(".ext-list-loading").fadeOut("fast")})}),e("BODY").trigger("dbox.loaded")}function i(e,t){return n.trigger.apply(n,[e,t||d].concat(Array.prototype.slice.call(arguments,2),[d]))}function o(e,t){return e.start>t.start?1:e.start<t.start?-1:0}function s(e,t){return e.start<t.start?1:e.start>t.start?-1:0}var l,d=this;d.name="rhc_event",d.render=function(r,i){var o=n.options.eventList.stack&&1==parseInt(n.options.eventList.stack)||!1;if(d.direction=i,custom_delta=parseInt(n.options.eventList.delta),custom_delta=isNaN(custom_delta)?0:custom_delta,date_changed=!1,o&&custom_delta>0&&d.first_date&&d.direction<0&&r>d.first_date&&(r=fc.cloneDate(d.first_date),date_changed=!0),0==d.direction?d.first_date=fc.cloneDate(r):d.direction<0&&d.first_date<r&&(d.first_date=fc.cloneDate(r)),i&&custom_delta>0&&(fc.addDays(r,custom_delta*i),i=0),date_changed&&n.gotoDate(r),custom_delta>0?(start=fc.cloneDate(r,!0),end=fc.addDays(fc.cloneDate(start),custom_delta),_end=fc.cloneDate(end)):_end=!1,d.start=fc.cloneDate(r,!0),!l&&(e('<div class="fc-events-holder"></div>').appendTo(t),l=!0),d.oldView||(d.oldView=new e.fullCalendar.views.month(e("<div>"),n)),d.oldView&&(custom_delta?d.oldView.render(fc.cloneDate(r),i):d.oldView.render(r,i),_end=!1===_end?fc.cloneDate(d.oldView.visEnd):_end,d.oldView.visStart&&d.oldView.visEnd&&(d.title=d.oldView.title,custom_delta?(d.start=fc.cloneDate(start),d.end=fc.cloneDate(end),d.visStart=fc.cloneDate(start),d.visEnd=fc.cloneDate(end)):(d.start=fc.cloneDate(d.oldView.start),d.end=fc.cloneDate(d.oldView.end),d.visStart=fc.cloneDate(d.oldView.start),d.visEnd=fc.cloneDate(d.oldView.visEnd)),n.options.eventList.TitleFormat&&(n.options.eventList.TitleFormat=n.options.eventList.TitleFormat.replace(/&#91;/g,"["),n.options.eventList.TitleFormat=n.options.eventList.TitleFormat.replace(/&#93;/g,"]"),d.title=fc.formatDates(fc.cloneDate(d.visStart),fc.addDays(fc.cloneDate(_end),-1),n.options.eventList.TitleFormat,n.options)))),n.options.eventList.upcoming&&"1"==n.options.eventList.upcoming){var s=new Date;s.setHours(0,0,0),dayspast=n.options.widgetlist.dayspast||0,s.setDate(s.getDate()-parseInt(dayspast)),d.visStart=d.visStart.getTime()>s.getTime()?d.visStart:s}var c=n.options.eventList.monthsahead?n.options.eventList.monthsahead:"";(c=""==c.replace(" ","")?custom_delta>0?0:1:parseInt(c))>0&&((u=new Date(d.visStart)).setMonth(u.getMonth()+c),d.visEnd=u);var f=n.options.eventList.daysahead?n.options.eventList.daysahead:"";if((f=""==f.replace(" ","")?0:parseInt(f))>0){var u=new Date(d.visStart);u.setDate(u.getDate()+f-1),u.setHours(23,59,59),d.visEnd=u}if(parseInt(n.options.eventList.auto)&&parseInt(n.options.eventList.stack)){var h=e(t).parents(".rhc_holder").attr("id");void 0===e(document).data("rhc_event_scroll")&&(e(document).data("rhc_event_scroll",h),jQuery(document).scroll(function(){a(h)}))}},d.unselect=function(){},d.setHeight=function(e){t.css("min-height","200px"),t.css("height","auto")},d.setWidth=function(){},d.clearEvents=function(){},d.renderEvents=function(a,l){var c=e(rhc_event_tpl),f=c.find(".fc-event-list-item").clone().removeClass("fc-remove"),h=c.find(".fc-event-list-date").clone().removeClass("fc-remove"),p=c.find(".fc-event-list-no-events").clone().removeClass("fc-remove");n.options.eventList&&n.options.eventList.eventListNoEventsText&&p.find(".fc-no-list-events-message").html(n.options.eventList.eventListNoEventsText),widget_templates=!1,n.options.eventList&&n.options.eventList.eventlist_template&&""!=n.options.eventList.eventlist_template&&e(n.options.eventList.eventlist_template).length>0&&(widget_templates=!0,f=e(n.options.eventList.eventlist_template).find(".rhc-widget-upcoming-item"));var m=!(!n.options.eventList.stack||"1"!=n.options.eventList.stack);if(m&&d.direction>0)v=t.find(".fc-events-holder");else{var v=t.find(".fc-events-holder").empty();d.rendered_events=[]}if(c.appendTo(v).find(".fc-remove").remove(),m&&e(v).find(".fc-event-list-no-events").parents(".fc-event-list-container").remove(),a.length>0)if(d.have_events=!0,widget_templates){var g=n.options,y=n.options.widgetlist,_=a,w="#"+y.sel;y.dayspast=y.dayspast?y.dayspast:0;var b=e.fullCalendar.parseDate(y.end);if(!y.horizon||"hour"!=y.horizon&&"end"!=y.horizon){var k=[],C=new Date;for(C.setDate(C.getDate()-y.dayspast),y.historic&&""!=y.specific_date&&(C=e.fullCalendar.parseDate(y.specific_date)),D=0;D<_.length;D++){var x=new Date(_[D].start);C.setHours(0,0,0,0),x.setHours(0,0,0,0),x.getTime()<C.getTime()||x.getTime()>b.getTime()||(k[k.length]=_[D])}_=k}else{for(k=[],(C=new Date).setDate(C.getDate()-y.dayspast),y.historic&&"1"==y.historic&&(C=e.fullCalendar.parseDate(y.specific_date)),D=0;D<_.length;D++){if(_[D].end&&"end"==y.horizon){if(_[D].end.getTime()<C.getTime())continue}else if(_[D].start.getTime()<C.getTime())continue;_[D].start.getTime()>b.getTime()||(k[k.length]=_[D])}_=k}if(_.sort(_rhc_sort_events),y.premiere&&"1"==y.premiere){for(var k=[],D=0;D<_.length;D++)_[D].premiere&&(k[k.length]=_[D]);_=k}else if(y.premiere&&"2"==y.premiere){for(var T=[],k=[],D=0;D<_.length;D++)e.inArray(_[D]._id,T)>-1||(T.push(_[D]._id),k.push(_[D]));_=k}_=_.slice(0,y.number),O=[],e.each(_,function(t,n){var a=f.clone(),r=n,o=r.description.split(" ");o=o.slice(0,y.words),r.description=o.join(" "),y.using_calendar_url&&""!=y.using_calendar_url&&(r.url=y.using_calendar_url);var s=r.url,l=f.clone();l.find(".rhc-title-link").html(r.title).data("rhc_event",r).attr("href",s).end().find(".rhc-event-link").data("rhc_event",r).attr("href",s).end().find(".rhc-title-in-link").html(r.title).end().find(".rhc-description").html(r.description).end().find(".rhc-widget-date").html("").end().find(".rhc-widget-time").html("").end().find(".rhc-widget-end-date").html("").end().find(".rhc-widget-end-time").html("").end(),""!=y.fcdate_format&&(l.find(".rhc-widget-date").html(e.fullCalendar.formatDate(r.start,y.fcdate_format,g)),l.find(".rhc-widget-end-date").html(e.fullCalendar.formatDate(r.end,y.fcdate_format,g)),dstart=e.fullCalendar.formatDate(r.start,"yyyy-MM-dd",g),dend=e.fullCalendar.formatDate(r.end,"yyyy-MM-dd",g),Math.floor((Date.parse(dend)-Date.parse(dstart))/864e5)>0?(k=e.fullCalendar.formatDate(r.start,y.fcdate_format,g)+" &#8211; "+e.fullCalendar.formatDate(r.end,y.fcdate_format,g),l.find(".rhc-widget-date-range").html(k),l.find(".rhc-day_diff0").hide()):(l.find(".rhc-widget-date-range").html(e.fullCalendar.formatDate(r.start,y.fcdate_format,g)),l.find(".rhc-day_diff1").hide())),""==y.fctime_format||r.allDay||(l.find(".rhc-widget-time").html(e.fullCalendar.formatDate(r.start,y.fctime_format,g)),l.find(".rhc-widget-end-time").html(e.fullCalendar.formatDate(r.end,y.fctime_format,g))),r.allDay&&(l.addClass("fc-is-allday"),l.find(".rhc-widget-time").hide()),l.find(".rhc-date-start").each(function(t,n){e(n).html(e.fullCalendar.formatDate(r.start,e(n).html(),g))});var d=e.fullCalendar.formatDate(r.start,"yyyyMMdd",g);-1==e.inArray(d,O)?O.push(d):l.find(".hide-repeat-date").addClass("repeated-date"),1==y.showimage?(l.addClass("featured-1"),r.image&&r.image[0]&&""!=r.image[0]&&e("<a></a>").addClass("rhc-image-link").data("rhc_event",r).attr("href",s).append(e("<img></img>").attr("src",r.image[0])).appendTo(l.find(".rhc-widget-upcoming-featured-image"))):(l.addClass("featured-0"),l.find(".rhc-widget-upcoming-featured-image").remove()),e(l).find(".rhc-title-link,.rhc-event-link,.rhc-image-link").click(function(e){var t={url:r.url};return r.gotodate&&(t.gotodate=r.gotodate),r.event_rdate&&(t.event_rdate=r.event_rdate),_rhc_widget_link_click(t,this)}),(a=l).find(".fc-event-term").empty().hide().parent().addClass("rhc_event-empty-taxonomy"),n.terms&&n.terms.length>0&&e.each(n.terms,function(t,n){if(a.find(".taxonomy-"+n.taxonomy).parent().find("a").length>0&&a.find(".taxonomy-"+n.taxonomy).parent().append('<span class="rhc-event-list tax-term-divider"></span>'),n.name&&""!=n.name&&a.find(".taxonomy-"+n.taxonomy).length>0&&(""==n.url?e("<span>"+n.name+"</span>").appendTo(a.find(".taxonomy-"+n.taxonomy).show().parent().removeClass("rhc_event-empty-taxonomy")):e("<a>"+n.name+"</a>").attr("href",n.url).appendTo(a.find(".taxonomy-"+n.taxonomy).show().parent().removeClass("rhc_event-empty-taxonomy"))),a.find(".taxonomy-"+n.taxonomy+"-gaddress").length>0&&n.gaddress&&""!=n.gaddress){a.find(".taxonomy-"+n.taxonomy+"-gaddress").parent().find("a").length>0&&a.find(".taxonomy-"+n.taxonomy+"-gaddress").parent().append('<span class="rhc-event-list tax-term-divider"></span>');var r="http://www.google.com/maps?f=q&hl=en&source=embed&q="+escape(n.gaddress);e("<a>"+n.gaddress+"</a>").attr("href",r).attr("target","_blank").appendTo(a.find(".taxonomy-"+n.taxonomy+"-gaddress").show().parent().removeClass("rhc_event-empty-taxonomy").end())}for(var i in n)"taxonomy"!=i&&(term_property_value=n[i],a.find(".taxonomy-"+n.taxonomy+"-"+i).length>0&&""!=term_property_value&&e("<span>"+term_property_value+"</span>").appendTo(a.find(".taxonomy-"+n.taxonomy+"-"+i)))}),l.find(".move-out").length>0&&l.find(".move-out").appendTo(w),triggerRes=i("eventRender",n,n,l),!1===triggerRes||c.find(".fc-event-list-holder").append(l),i("loading",null,!1)})}else{n.options.widgetlist.dayspast=n.options.widgetlist.dayspast?n.options.widgetlist.dayspast:0,events=[];var M=new Date;if(M.setDate(M.getDate()-n.options.widgetlist.dayspast),e.each(a,function(e,t){if(m&&d.rendered_events.length>0)for(var a=0;a<d.rendered_events.length;a++)if(test_event=d.rendered_events[a],"function"==typeof test_event.start.getTime&&"function"==typeof t.start.getTime&&test_event.id==t.id&&test_event.start.getTime()==t.start.getTime())return;if(d.rendered_events.push(t),!(n.options.eventList&&1==parseInt(n.options.eventList.removeended)&&null!=t.end&&t.end<M)){if(n.options.eventList&&"1"==n.options.eventList.outofrange){if(null!=t.end&&t.end<d.visStart)return}else{if(t.start<d.visStart)return;if(t.start>d.visEnd)return}events[events.length]=t}}),0==events.length)return;"1"==n.options.eventList.reverse?events.sort(s):events.sort(o);var $=[],E=!(!n.options.eventList.extendedDetails||"1"!=n.options.eventList.extendedDetails),S="",O=[];if(e.each(events,function(t,a){if(!(void 0!==n.options.eventList.display&&n.options.eventList.display>0&&t>=n.options.eventList.display)){var r=f.clone();a.gcal||""==a.url?r.find(".fc-event-list-title").parent().empty().append(e("<span></span>").addClass("fc-event-list-title").html(a.title)):a.direct_link?r.find(".fc-event-list-title").html(a.title).end().find("a.fc-event-link").attr("href",a.url).end():r.find(".fc-event-list-title").html(a.title).end().find("a.fc-event-link").attr("target","").attr("href","javascript:void(0);").bind("click",function(e){(n.options.eventClick?n.options.eventClick:fc_click)(a,e,d)}).end();var o=!!a.local_feed;if(E&&o&&(r.find(".fe-extrainfo-container").addClass("skip-render").addClass("ext_det_"+a.id).hide().data("ev",a).before('<div class="ext-list-loading loading-events"><div class="ext-list-loading-1 ajax-loader loading-events"><div class="ext-list-loading-2x xspinner icon-xspinner-3"></div></div></div>'),-1==e.inArray(a.id,$)&&$.push(a.id)),r.find(".fc-event-list-description").html(a.description).end(),a.description&&""==a.description.replace(" ","")&&r.find(".fc-event-list-description").addClass("rhc-empty-description"),"none"==a.fc_click_link&&r.find("a.fc-event-link").addClass("fc-no-link"),a.image&&a.image[0]?r.find("img.fc-event-list-image").attr("src",a.image[0]):r.find(".fc-event-list-featured-image").empty(),a.allDay)r.find(".fc-time").remove(),r.find(".fc-end-time").remove(),s=n.options.eventList.extDateFormat||"dddd MMMM d, yyyy.";else{r.find(".fc-time").html(e.fullCalendar.formatDate(a.start,n.options.eventList.extTimeFormat||"h:mmtt")),r.find(".fc-end-time").html(e.fullCalendar.formatDate(a.end,n.options.eventList.extTimeFormat||"h:mmtt"));var s=n.options.eventList.extDateFormat||"dddd MMMM d, yyyy."}if(a.start?r.find(".fc-start").html(e.fullCalendar.formatDate(a.start,s,n.options)):r.find(".fc-start").remove(),a.end?r.find(".fc-end").html(e.fullCalendar.formatDate(a.end,s,n.options)):r.find(".fc-end").parent().addClass("rhc_event-empty-taxonomy").end().remove(),r.find(".fc-event-link.fc-event-list-title").each(function(t,n){parseInt(RHC.disable_event_link)&&"javascript:void(0);"==e(n).attr("href")&&e(n).replaceWith(e(n).text())}),r.find(".fc-event-term").empty().hide().parent().addClass("rhc_event-empty-taxonomy"),a.terms&&a.terms.length>0&&e.each(a.terms,function(t,n){if(r.find(".taxonomy-"+n.taxonomy).parent().find("a").length>0&&r.find(".taxonomy-"+n.taxonomy).parent().append('<span class="rhc-event-list tax-term-divider"></span>'),n.name&&""!=n.name&&r.find(".taxonomy-"+n.taxonomy).length>0&&(""==n.url?e("<span>"+n.name+"</span>").appendTo(r.find(".taxonomy-"+n.taxonomy).show().parent().removeClass("rhc_event-empty-taxonomy").end()):e("<a>"+n.name+"</a>").attr("href",n.url).appendTo(r.find(".taxonomy-"+n.taxonomy).show().parent().removeClass("rhc_event-empty-taxonomy").end())),r.find(".taxonomy-"+n.taxonomy+"-gaddress").length>0&&n.gaddress&&""!=n.gaddress){r.find(".taxonomy-"+n.taxonomy+"-gaddress").parent().find("a").length>0&&r.find(".taxonomy-"+n.taxonomy+"-gaddress").parent().append('<span class="rhc-event-list tax-term-divider"></span>');var a="http://www.google.com/maps?f=q&hl=en&source=embed&q="+escape(n.gaddress);e("<a>"+n.gaddress+"</a>").attr("href",a).attr("target","_blank").appendTo(r.find(".taxonomy-"+n.taxonomy+"-gaddress").show().parent().removeClass("rhc_event-empty-taxonomy").end())}}),a.meta&&a.meta.length>0&&e.each(a.meta,function(e,t){w=".fc-event-meta-"+t[0],val=t[1],r.find(w).html(val).end()}),triggerRes=i("eventRender",a,a,r),!1===triggerRes);else{if(n.options.eventList.ShowHeader&&1==parseInt(n.options.eventList.ShowHeader)){var l=a.start;if(e.fullCalendar.formatDate(l,"yyyyMMdd")!=e.fullCalendar.formatDate(S,"yyyyMMdd")){S=l;var u=h.clone();u.find(".fc-event-list-date-header").html(e.fullCalendar.formatDate(a.start,n.options.eventList.DateFormat||"dddd MMMM d, yyyy",n.options)),c.find(".fc-event-list-holder").append(u)}}c.find(".fc-event-list-holder").append(r)}}}),$.length>0){void 0===n.extended_detail_cache&&(n.extended_detail_cache={});var j=[];if(e.each($,function(e,t){void 0===n.extended_detail_cache[t]&&j.push(t)}),0==j.length)r(e,$,c,n);else{url=RHC.ajaxurl,url+="?rhc_action=extended_details",$.length>0&&e.each($,function(e,t){url=url+"&ids[]="+t}),ver=RHC.last_modified&&""!=RHC.last_modified?RHC.last_modified:M.getTime(),url=url+"&ver="+ver,queryString=url.substring(url.indexOf("?")+1),hash=CryptoJS.MD5(queryString),u=hash.toString(CryptoJS.enc.Hex),url=url+"&_="+u;var L={url:url,type:"GET",dataType:"html",not_used_data:{rhc_action:"extended_details",ids:$},success:function(a){e.each($,function(r,i){e(a).find("."+i).length>0?n.extended_detail_cache[i]=e(a).find("."+i).clone():e(t).find(".skip-render.ext_det_"+i).removeClass("skip-render").removeClass("ext_det_"+i).fadeIn("fast").parent().find(".ext-list-loading").fadeOut("fast")}),r(e,$,c,n)},error:function(){e(t).find(".skip-render").show(),e(t).parent().find(".ext-list-loading").fadeOut("fast"),r(e,$,c,n)}};e.ajax(L)}}}else d.have_events=!1,c.find(".fc-event-list-holder").append(p),c.find(".fc-no-list-events-message").show();i("loading",null,!1)},d.trigger=i,d.viewChanged=function(e){if(e&&e.visStart&&e.visEnd){if(d.title=e.title,d.visStart=e.start,d.visEnd=e.visEnd,d.oldView=e,n.options.eventList.upcoming&&"1"==n.options.eventList.upcoming){var t=new Date;d.visStart=d.visStart.getTime()>t.getTime()?d.visStart:t}var a=n.options.eventList.monthsahead?n.options.eventList.monthsahead:"";(a=""==a.replace(" ","")?1:parseInt(a))>0&&((i=new Date(d.visStart)).setMonth(i.getMonth()+a),d.visEnd=i);var r=n.options.eventList.daysahead?n.options.eventList.daysahead:"";if((r=""==r.replace(" ","")?0:parseInt(r))>0){var i=new Date(d.visStart);i.setDate(i.getDate()+r-1),i.setHours(23,59,59),d.visEnd=i}}},d.beforeAnimation=function(e){},d.setEventData=function(e){},d.clearEventData=function(){},d.triggerEventDestroy=function(){},d.element=t,d.oldView=null,d.calendar=n,fc=e.fullCalendar,d.direction=0,d.first_date=null,d.scroll_lockdown=!1,d.loading=function(t,n,a){t?(d.scroll_lockdown=!0,e(n.element).parents(".rhc_holder").addClass("stacking-loading")):(d.scroll_lockdown=!1,e(n.element).parents(".rhc_holder").removeClass("stacking-loading"))},d.have_events=!1,d.rendered_events=[],n.options.eventList.daysahead&&parseInt(n.options.eventList.delta)>parseInt(n.options.eventList.daysahead)&&(n.options.eventList.delta=n.options.eventList.daysahead)}e.fullCalendar.views.WeekEventList=function(n,a){function r(e,t){return options[e]}var i,o=this,s=e.fullCalendar.addDays,l=e.fullCalendar.cloneDate,d=e.fullCalendar.formatDates;options=a.options,t.call(o,n,a),o.render=function(t,c){c&&s(t,7*c);var f=s(l(t),-(t.getDay()-r("firstDay")+7)%7),u=s(l(f),7),h=l(f),p=l(u);a.options.titleFormat.week&&(a.options.titleFormat.week=a.options.titleFormat.week.replace(/&#91;/g,"["),a.options.titleFormat.week=a.options.titleFormat.week.replace(/&#93;/g,"]"),o.title=d(h,s(l(p),-1),a.options.titleFormat.week,a.options)),o.start=f,o.end=u,o.visStart=h,o.visEnd=p,!i&&(e('<div class="fc-events-holder"></div>').appendTo(n),i=!0)},o.viewChanged=function(){}},e.fullCalendar.views.rhc_event=t,e.fullCalendar.views.rhc_detail=function(t,n){var a,r=this;r.name="rhc_detail",r.render=function(n,i){r.start=n,!a&&(e('<div class="fc-detail-view-holder"><div class="fc-detail-view-content">TODO: a single event details. The button will be removed on the top right controls, and this view will be triggered when selecting an event.</div><div class="fc-detail-view-wp_footer" style="display:none;"></div></div>').appendTo(t),a=!0)},r.unselect=function(){},r.setHeight=function(e){t.css("min-height","200px"),t.css("height","auto")},r.setWidth=function(){},r.clearEvents=function(){e(".fc-detail-view-content").html("")},r.renderEvents=function(){var t={id:n.last_clicked_event.id};e.post(n.options.singleSource,t,function(t){"OK"==t.R&&(0==e("body .fc-single-item-holder").length&&e("body").append('<div class="fc-single-item-holder"></div>'),e("body .fc-single-item-holder").empty(),e(t.DATA.footer).each(function(t,n){if(n.nodeName&&"SCRIPT"==n.nodeName){var a=document.createElement("script");e(n).attr("type")&&(a.type=e(n).attr("type")||""),e(n).attr("src")?a.src=e(n).attr("src")||"":a.text=e(n).html()||"",document.body.appendChild(a)}else e("body .fc-single-item-holder").append(n)}),e(".fc-detail-view-content").html(t.DATA.body))},"json")},r.trigger=function(){},r.viewChanged=function(){},r.beforeAnimation=function(e){},r.element=t}}(jQuery);var CryptoJS=CryptoJS||function(e,t){var n={},a=n.lib={},r=function(){},i=a.Base={extend:function(e){r.prototype=this;var t=new r;return e&&t.mixIn(e),t.hasOwnProperty("init")||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},o=a.WordArray=i.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=void 0!=t?t:4*e.length},toString:function(e){return(e||l).stringify(this)},concat:function(e){var t=this.words,n=e.words,a=this.sigBytes;if(e=e.sigBytes,this.clamp(),a%4)for(var r=0;r<e;r++)t[a+r>>>2]|=(n[r>>>2]>>>24-r%4*8&255)<<24-(a+r)%4*8;else if(65535<n.length)for(r=0;r<e;r+=4)t[a+r>>>2]=n[r>>>2];else t.push.apply(t,n);return this.sigBytes+=e,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=i.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n=[],a=0;a<t;a+=4)n.push(4294967296*e.random()|0);return new o.init(n,t)}}),s=n.enc={},l=s.Hex={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],a=0;a<e;a++){var r=t[a>>>2]>>>24-a%4*8&255;n.push((r>>>4).toString(16)),n.push((15&r).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,n=[],a=0;a<t;a+=2)n[a>>>3]|=parseInt(e.substr(a,2),16)<<24-a%8*4;return new o.init(n,t/2)}},d=s.Latin1={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],a=0;a<e;a++)n.push(String.fromCharCode(t[a>>>2]>>>24-a%4*8&255));return n.join("")},parse:function(e){for(var t=e.length,n=[],a=0;a<t;a++)n[a>>>2]|=(255&e.charCodeAt(a))<<24-a%4*8;return new o.init(n,t)}},c=s.Utf8={stringify:function(e){try{return decodeURIComponent(escape(d.stringify(e)))}catch(e){throw Error("Malformed UTF-8 data")}},parse:function(e){return d.parse(unescape(encodeURIComponent(e)))}},f=a.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new o.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=c.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,a=n.words,r=n.sigBytes,i=this.blockSize,s=r/(4*i);if(t=(s=t?e.ceil(s):e.max((0|s)-this._minBufferSize,0))*i,r=e.min(4*t,r),t){for(var l=0;l<t;l+=i)this._doProcessBlock(a,l);l=a.splice(0,t),n.sigBytes-=r}return new o.init(l,r)},clone:function(){var e=i.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});a.Hasher=f.extend({cfg:i.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){f.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new u.HMAC.init(e,n).finalize(t)}}});var u=n.algo={};return n}(Math);!function(e){function t(e,t,n,a,r,i,o){return((e=e+(t&n|~t&a)+r+o)<<i|e>>>32-i)+t}function n(e,t,n,a,r,i,o){return((e=e+(t&a|n&~a)+r+o)<<i|e>>>32-i)+t}function a(e,t,n,a,r,i,o){return((e=e+(t^n^a)+r+o)<<i|e>>>32-i)+t}function r(e,t,n,a,r,i,o){return((e=e+(n^(t|~a))+r+o)<<i|e>>>32-i)+t}for(var i=CryptoJS,o=(l=i.lib).WordArray,s=l.Hasher,l=i.algo,d=[],c=0;64>c;c++)d[c]=4294967296*e.abs(e.sin(c+1))|0;l=l.MD5=s.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,i){for(o=0;16>o;o++){l=e[s=i+o];e[s]=16711935&(l<<8|l>>>24)|4278255360&(l<<24|l>>>8)}var o=this._hash.words,s=e[i+0],l=e[i+1],c=e[i+2],f=e[i+3],u=e[i+4],h=e[i+5],p=e[i+6],m=e[i+7],v=e[i+8],g=e[i+9],y=e[i+10],_=e[i+11],w=e[i+12],b=e[i+13],k=e[i+14],C=e[i+15],x=o[0],D=o[1],T=o[2],M=o[3],D=r(D=r(D=r(D=r(D=a(D=a(D=a(D=a(D=n(D=n(D=n(D=n(D=t(D=t(D=t(D=t(D,T=t(T,M=t(M,x=t(x,D,T,M,s,7,d[0]),D,T,l,12,d[1]),x,D,c,17,d[2]),M,x,f,22,d[3]),T=t(T,M=t(M,x=t(x,D,T,M,u,7,d[4]),D,T,h,12,d[5]),x,D,p,17,d[6]),M,x,m,22,d[7]),T=t(T,M=t(M,x=t(x,D,T,M,v,7,d[8]),D,T,g,12,d[9]),x,D,y,17,d[10]),M,x,_,22,d[11]),T=t(T,M=t(M,x=t(x,D,T,M,w,7,d[12]),D,T,b,12,d[13]),x,D,k,17,d[14]),M,x,C,22,d[15]),T=n(T,M=n(M,x=n(x,D,T,M,l,5,d[16]),D,T,p,9,d[17]),x,D,_,14,d[18]),M,x,s,20,d[19]),T=n(T,M=n(M,x=n(x,D,T,M,h,5,d[20]),D,T,y,9,d[21]),x,D,C,14,d[22]),M,x,u,20,d[23]),T=n(T,M=n(M,x=n(x,D,T,M,g,5,d[24]),D,T,k,9,d[25]),x,D,f,14,d[26]),M,x,v,20,d[27]),T=n(T,M=n(M,x=n(x,D,T,M,b,5,d[28]),D,T,c,9,d[29]),x,D,m,14,d[30]),M,x,w,20,d[31]),T=a(T,M=a(M,x=a(x,D,T,M,h,4,d[32]),D,T,v,11,d[33]),x,D,_,16,d[34]),M,x,k,23,d[35]),T=a(T,M=a(M,x=a(x,D,T,M,l,4,d[36]),D,T,u,11,d[37]),x,D,m,16,d[38]),M,x,y,23,d[39]),T=a(T,M=a(M,x=a(x,D,T,M,b,4,d[40]),D,T,s,11,d[41]),x,D,f,16,d[42]),M,x,p,23,d[43]),T=a(T,M=a(M,x=a(x,D,T,M,g,4,d[44]),D,T,w,11,d[45]),x,D,C,16,d[46]),M,x,c,23,d[47]),T=r(T,M=r(M,x=r(x,D,T,M,s,6,d[48]),D,T,m,10,d[49]),x,D,k,15,d[50]),M,x,h,21,d[51]),T=r(T,M=r(M,x=r(x,D,T,M,w,6,d[52]),D,T,f,10,d[53]),x,D,y,15,d[54]),M,x,l,21,d[55]),T=r(T,M=r(M,x=r(x,D,T,M,v,6,d[56]),D,T,C,10,d[57]),x,D,p,15,d[58]),M,x,b,21,d[59]),T=r(T,M=r(M,x=r(x,D,T,M,u,6,d[60]),D,T,_,10,d[61]),x,D,c,15,d[62]),M,x,g,21,d[63]);o[0]=o[0]+x|0,o[1]=o[1]+D|0,o[2]=o[2]+T|0,o[3]=o[3]+M|0},_doFinalize:function(){var t=this._data,n=t.words,a=8*this._nDataBytes,r=8*t.sigBytes;n[r>>>5]|=128<<24-r%32;var i=e.floor(a/4294967296);for(n[15+(r+64>>>9<<4)]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),n[14+(r+64>>>9<<4)]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),t.sigBytes=4*(n.length+1),this._process(),n=(t=this._hash).words,a=0;4>a;a++)r=n[a],n[a]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8);return t},clone:function(){var e=s.clone.call(this);return e._hash=this._hash.clone(),e}}),i.MD5=s._createHelper(l),i.HmacMD5=s._createHmacHelper(l)}(Math),function($){function allday_group(e,t){return _allday_group=void 0!==t.allday_group&&0<parseInt(t.allday_group)?parseInt(t.allday_group):0,0<_allday_group&&$.each(e,function(e,t){void 0!==t.color&&""!=t.color&&(1==_allday_group?t.title='<span style="display:none;">'+t.color+"</span>"+t.title:2==_allday_group&&void 0!==t.menu_order&&(t.title='<span style="display:none;">'+parseInt(t.menu_order)+"</span>"+t.title))}),e}function preload_events(o,fc_options){fc_options.preload&&$(o).find(".rhc-preload").length&&$(o).find(".rhc-preload").each(function(i,el){if(!$(el).data("preloaded")){$(el).data("preloaded",!0);try{if(cache=$(el).data("request"),cache=eval(cache),cache)if($(el).data("events")?(tmp_events=$(el).data("events"),data=eval(tmp_events)):data=$.parseJSON($(el).html()),external_source=$(el).data("external_source")||!1,"OK"==data.R){if(cache.url=$(el).data("url"),!in_rhc_events_cache(cache.start,cache.end,cache.url)){cache.events=data.EVENTS;var events=[];start=new Date(1e3*cache.start),end=new Date(1e3*cache.end),events=rhc_events_to_fc_events(start,end,data,!0),events=handle_local_tz(events,fc_options,data),cache.events=events,rhc_events_cache[rhc_events_cache.length]=cache}}else if(external_source&&"object"==typeof data&&(cache.url=$(el).data("url"),!in_rhc_events_cache(cache.start,cache.end,cache.url))){cache.events=data.EVENTS;var events=data;start=new Date(1e3*cache.start),end=new Date(1e3*cache.end),events=handle_local_tz(events,fc_options,data),cache.events=events,rhc_events_cache[rhc_events_cache.length]=cache}}catch(e){}}})}function in_rhc_events_cache(e,t,n){for(var a=0;a<rhc_events_cache.length;a++)if(rhc_events_cache[a].start<=e&&rhc_events_cache[a].end>=t&&rhc_events_cache[a].url==n)return!0;return!1}function handle_local_tz(e,t,n){if(local_tz="local_tz"in t?parseInt(t.local_tz):0,0==local_tz)return e;if("GMT_OFFSET"in n){var a=-1*n.GMT_OFFSET*60;if(a==(new Date).getTimezoneOffset())return e;for(var r=0;r<e.length;r++)if(!e[r].allDay){"object"==typeof e[r].start&&(e[r].start=date_change_offset(e[r].start,a)),"object"==typeof e[r]._start&&(e[r]._start=date_change_offset(e[r]._start,a)),"object"==typeof e[r].end&&(e[r].end=date_change_offset(e[r].end,a)),"object"==typeof e[r]._end&&(e[r]._end=date_change_offset(e[r]._end,a));var i=jQuery.fullCalendar.formatDate(e[r].start,"yyyyMMddHHmmss"),o=jQuery.fullCalendar.formatDate(e[r].end,"yyyyMMddHHmmss");i&&""!=i&&(o&&""!=o&&(i=i+","+o),e[r].event_rdate=i,e[r].url=""==e[r].url?"":_add_param_to_url(e[r].url,"event_rdate",e[r].event_rdate))}}return e}function date_change_offset(e,t){return new Date(e.getTime()-6e4*(e.getTimezoneOffset()-t))}function handle_field_map(e){return e.MAP&&e.MAP.length>0&&e.EVENTS&&e.EVENTS.length>0&&(new_events=[],jQuery.each(e.EVENTS,function(t,n){new_ev={},jQuery.each(e.MAP,function(e,t){n[t[0]]&&(new_ev[t[1]]=n[t[0]])}),void 0===new_ev.allDay&&(new_ev.allDay=!1),new_ev.terms&&new_ev.terms.length>0&&(new_terms=[],jQuery.each(new_ev.terms,function(t,n){new_terms[t]="object"==typeof n?n:e.TERMS[n]}),new_ev.terms=new_terms,new_terms=[],jQuery.each(new_ev.terms,function(t,n){new_term={},jQuery.each(e.MAP,function(e,t){n[t[0]]&&(new_term[t[1]]=n[t[0]])}),new_terms[new_terms.length]=new_term}),new_ev.terms=new_terms),new_events[new_events.length]=new_ev}),e.EVENTS=new_events),e}function rhc_events_to_fc_events(e,t,n,a){var r=[];if((n=handle_field_map(n)).EVENTS.length>0&&$(n.EVENTS).each(function(n,i){if(i.premiere=!0,i.description=void 0===i.description?"":i.description,i.local_feed=void 0===i.local_feed?a:i.local_feed,(!i.color||""==i.color||"#"==i.color)&&i.terms&&i.terms.length>0)for(var o=0;o<i.terms.length;o++){var s=!!(i.terms[o].background_color&&i.terms[o].background_color.length>1)&&i.terms[o].background_color,l=!!(i.terms[o].color&&i.terms[o].color.length>1)&&i.terms[o].color;if(l=s&&!1===l?"#fff":l,(s=l&&!1===s?"#fff":s)&&l){i.color=s,i.textColor=l;break}}if(void 0!==i.start&&null!=i.start)if(i.src_start=i.start,i.fc_rrule=i.fc_rrule?i.fc_rrule:"",""==i.fc_rrule&&""==i.fc_rdate)r[r.length]=i;else{var d=!1,c=new Date($.fullCalendar.parseDate(i.start));if(i.end){var f=new Date($.fullCalendar.parseDate(i.end));d=f.getTime()-c.getTime()}var u=$.fullCalendar.parseDate(i.start);i.fc_rrule=""==i.fc_rrule?"FREQ=DAILY;INTERVAL=1;COUNT=1":i.fc_rrule;try{if(scheduler=new Scheduler(u,i.fc_rrule,!0),""!=i.fc_interval&&i.fc_exdate){var h=exdate_to_array_of_dates(i.fc_exdate);h.length>0&&scheduler.add_exception_dates(h)}if(i.fc_rdate&&""!=i.fc_rdate){var p=exdate_to_array_of_dates(i.fc_rdate);p.length>0&&scheduler.add_rdates(p)}occurrences=scheduler.occurrences_between(e,t),occurrences.length>0&&$(occurrences).each(function(e,t){var n=new Date(t),a=$.extend(!0,{},i);if(a.premiere=n.getTime()==c.getTime(),a._start=n,a.start=n,a.fc_start=$.fullCalendar.formatDate(n,"yyyy-MM-dd"),a.fc_start_time=$.fullCalendar.formatDate(n,"HH:mm:ss"),a.fc_date_time=$.fullCalendar.formatDate(n,"yyyy-MM-dd HH:mm:ss"),d){var o=n.getTime()+d,s=new Date;s.setTime(o),a._end=s,a.end=s,a.fc_end=$.fullCalendar.formatDate(s,"yyyy-MM-dd"),a.fc_end_time=$.fullCalendar.formatDate(s,"HH:mm:ss")}else a.end=a.start,a._end=a._start;a.repeat_instance=!0,a=_add_repeat_instance_data_to_event(a),r[r.length]=a}),c<=e&&f>e&&(i.start=c,i.end=f,r[r.length]=i)}catch(e){console.log(e.message,i)}}}),r.length>0&&!r[0].local_feed){r.sort(_rhc_sort_events);var i=[];$(r).each(function(e,t){if(!t.local_feed){if(i.length>0)for(var n=0;n<i.length;n++)if(cev=i[n],t.id==cev.id&&t.start.getTime()==cev.start.getTime()&&t.network==cev.network)return!0;i.push(t)}}),r=i}return r}function cb_event_render(e,t,n,a,r,i){if(e||(e=$(r.element).parents(".fullCalendar")),$("body").trigger("cb_event_render_begin",[e,t,n,a,r,i]),showothermonth=i&&i.showothermonth?parseInt(i.showothermonth):1,showothermonth=r&&r.name&&"month"==r.name?showothermonth:1,"month"==r.name&&$(a).parents(".rhcalendar.not-widget").hasClass("fc-small")&&(showothermonth=0),0==showothermonth&&n.start&&n.end&&r.start&&r.end){if(n.end.getTime()<r.start.getTime())return!1;if(n.start.getTime()>=r.end.getTime())return!1}if(0==showothermonth&&n.start&&null==n.end&&r.start&&r.end){if(n.start.getTime()<r.start.getTime())return!1;if(n.start.getTime()>=r.end.getTime())return!1}if(event_skip=i&&i.event_skip?parseInt(i.event_skip):0,event_skip&&(void 0===r.event_skip&&(r.event_skip=event_skip),r.event_skip>0))return r.event_skip--,!1;if(1==parseInt(i.upcoming)){var o=new Date;if(n.allDay&&o.setHours(0,0,0,0),n.start.getTime()<o.getTime())return!1}if(norepeat=r.get_norepeat?r.get_norepeat(i.norepeat||!1):i.norepeat||!1,norepeat=parseInt(norepeat),norepeat&&r&&n&&n.id){if(r.rendered=r.rendered?r.rendered:[],-1!=$.inArray(n.id,r.rendered))return!1;r.rendered.push(n.id)}if(i.taxonomycolor&&"1"==i.taxonomycolor&&n.terms){var s=[];$.each(n.terms,function(e,t){str="tax_"+t.taxonomy+"_"+t.slug,str=str.replace(/ /g,"_"),s.push(str)}),s.length>0&&$(a).addClass(s.join(" "))}if(n.venue_directory&&"rhc_gmap"!=r.name)return!1;if("rhc_gmap"==r.name&&n.start)if(1==parseInt(i.gmap_view.upcoming)){if(n.start.getTime()<r.visStart.getTime())return!1}else if(n.end&&2==parseInt(i.gmap_view.upcoming)&&n.end.getTime()<r.visStart.getTime())return!1;var l=$(e).data("rhc_tax_filters");if(l&&l.length>0){var d=!0,c=[],f=[];if($.each(n.terms,function(e,t){$.each(l,function(e,n){-1==$.inArray(n.taxonomy,f)&&f.push(n.taxonomy),n.taxonomy==t.taxonomy&&(t.gaddress&&t.gaddress==n.term?(d=!1,c.push(t.taxonomy)):t.description&&t.description==n.term?(d=!1,c.push(t.taxonomy)):t.name&&t.name==n.term&&(d=!1,c.push(t.taxonomy)))})}),!d&&f.length>0&&$.each(f,function(e,t){-1==$.inArray(t,c)&&(d=!0)}),d)return!1}if(max_events=i&&i.max_events?parseInt(i.max_events):0,max_events){if(void 0===r.max_events&&(r.max_events=max_events,r.rendered_events_count=0),r.rendered_events_count>=r.max_events)return!1;r.rendered_events_count++}if(t){var u=0;if(n.start&&n.end){var h=new Date(n.start),p=new Date(n.end);h.setHours(0,0,0,0),p.setHours(0,0,0,0),u=Math.floor((p.getTime()-h.getTime())/864e5)}var m=n._start.getDate();if(0==u)$(r.element).find(".fc-day-number").each(function(e,t){m==$(t).html()&&(n.start.getMonth()==r.start.getMonth()?$(t).parent().parent().hasClass("fc-other-month")||$(t).parent().parent().addClass("fc-state-highlight").addClass("fc-have-event").css("background-image","none"):$(t).parent().parent().hasClass("fc-other-month")&&$(t).parent().parent().addClass("fc-state-highlight").addClass("fc-have-event").css("background-image","none"))});else{var h=new Date(n.start),p=new Date(n.start);h.setHours(0,0,0),p.setHours(23,59,59),$(r.element).find(".fc-day-number").each(function(e,t){current_date_str=$(t).closest(".fc-day").data("date"),current_date=new Date(current_date_str+"T00:00:00Z"),current_date.setTime(current_date.getTime()+60*h.getTimezoneOffset()*1e3),current_date.getTime()<=p.getTime()&&current_date.getTime()>=h.getTime()&&$(t).parent().parent().addClass("fc-state-highlight").addClass("fc-have-event").css("background-image","none")})}return!1}if(sidelist_events.push(n),i.matchBackground&&"1"==i.matchBackground){loop_date=new Date(n._start),compare_date=n._end||n._start;for(var v=0;loop_date<=compare_date&&(sel=".fc-day[data-date='"+$.fullCalendar.formatDate(loop_date,"yyyy-MM-dd")+"']",original_bg=$(r.element).find(sel).css("background-color"),$(r.element).find(sel).data("original_bg",original_bg).addClass("bg_matched").css("background-color",$(a).length&&$(a).get(0).tagName?$(a).css("background-color")||"":""),loop_date.setDate(loop_date.getDate()+1),!(v++>5e3)););}if(render_something=!1,i.month_event_image&&"1"==i.month_event_image&&"month"==r.name&&n.month_image&&n.month_image[0]&&(loop_date=new Date(n._start),sel=".fc-day[data-date='"+$.fullCalendar.formatDate(loop_date,"yyyy-MM-dd")+"']",ratio=n.month_image[2]/n.month_image[1],container_w=r.element.find(sel).outerWidth(),_w=container_w,_h=_w*ratio,$(a).addClass("has-fc-image").find(".fc-event-inner").prepend($("<div></div>").addClass("fc-image-cont").append($("<img />").attr("src",n.month_image[0]).attr("height",parseInt(_h)).css("height",parseInt(_h)).addClass("fc-image"))),render_something=!0),"month"==r.name){if(i.render_events=void 0===i.render_events?1:i.render_events,0==parseInt(i.render_events)){if(!render_something)return!1;$(a).find(".fc-event-title").hide(),$(a).find(".fc-event-time").hide(),$(a).css("background-color","transparent")}void 0===i.fixed_title||0==i.fixed_title.length||($(a).find(".fc-event-time").html("&nbsp;"),$(a).find(".fc-event-title").html(i.fixed_title))}i.early_dynamic_tooltip&&"1"==i.early_dynamic_tooltip&&cb_event_mouseover(n,null,r),i.tooltip_close_on_title_leave&&parseInt(i.tooltip_close_on_title_leave)&&$(a).mouseleave(function(e){handle=setTimeout(function(){0==$(".fc-event.event-hovered").length&&$(".fct-tooltip").is(":visible")&&($(".fct-tooltip:visible").first().is(":hover")||$(".fct-tooltip:visible").trigger("close-tooltip"))},200)})}function hide_widget_event_list(e,t,n,a,r,i){var o=jQuery(e).parents(".rhc_holder").find(".rhc_calendar_widget_day_click_holder");o.children().length>0&&o.children().fadeOut("fast",function(){})}function cb_event_render_all(e,t,n,a,r,i){if(void 0===e&&(e=$(r.element).parents(".rhcalendar.rhc_holder")),norepeat=r.get_norepeat?r.get_norepeat(i.norepeat||!1):i.norepeat||!1,norepeat=parseInt(norepeat),norepeat&&r&&(r.rendered=r.handle_rendered?r.handle_rendered():[]),has_sidelist_holder=$(e).parent().find(".rhc-sidelist").length>0,events=sidelist_events||[],events.length>0){var o=$(e).parent().find(".rhc-sidelist-holder .rhc-sidelist-tab-label");o.length>0&&i.sidelist&&i.sidelist.labels&&i.sidelist.labels.tab&&o.html(i.sidelist.labels.tab),render_sidelist(e,events,r.name,i)}sidelist_events=[],$.inArray(r.name,["rhc_event","rhc_gmap"]),$("body").trigger("cb_view_display",[t,e,r,a])}function render_tax_filters(e){var t=e&&e.taxfilter?e.taxfilter:{holder_class:"rh-flat-ui fc-head-control",selectpicker:!0,size:10,menu_class:"tax_filter_menu_medium",multiple:!(!e.tax_filter_multiple||!parseInt(e.tax_filter_multiple))},n=$(this);e.btn_tax_parent_only?arr_btn_tax_parent_only=e.btn_tax_parent_only.split(","):arr_btn_tax_parent_only=[],$(this).find("[class*='fc-button-btn_tax_']").length>0&&n.addClass("rhc-has-tax-filter"),$(this).find("[class*='fc-button-btn_tax_']").each(function(e,a){var r=(a.className.match(/(^|\s)(fc\-button\-btn_tax_([^\s]*))/)||[,,""])[3],i=$('<select class="selectpicker"></select>');if(t.multiple&&i.attr("multiple",!0),i.attr("data-taxonomy",r).append($('<option value="">'+$(this).html()+"</option>")),n.find(".fbd-filter[data-taxonomy='"+r+"']").each(function(e,t){var n=$(t).data("bgcolor")||"transparent";if(arr_btn_tax_parent_only.length>0&&parseInt($(t).data("parent")))for(var a=0;a<arr_btn_tax_parent_only.length;a++)if(r==arr_btn_tax_parent_only[a])return;i.append($('<option data-bgcolor="'+n+'" value="'+$(t).val()+'">'+$(t).closest("label").find(".fbd-term-label").html()+"</option>"))}),i.find("option").length>1?($(a).replaceWith(i),i.wrap($('<div class="tax_filter_holder fc-button fc-state-default"></div>').addClass(t.holder_class).addClass(t.menu_class))):($(a).remove(),console.log("Taxonomy filter added to calendar, but disabled in options.  Also turning off the hierarchical filter can help.")),t.selectpicker){i.selectpicker({style:"btn-small btn-taxfilter btn_tax",size:t.size});var o=!1,s=i.parent().find(".dropdown-menu");i.find("option").each(function(e,t){bgcolor=$(t).attr("data-bgcolor")||"transparent","transparent"!=bgcolor&&(o=!0),s.find('li[rel="'+e+'"] a').prepend($('<span class="rhc-term-color"></span>').css("background-color",bgcolor).addClass("transparent"==bgcolor?"rhc-no-color":""))}),o&&s.addClass("rhc-with-tax-color")}i.unbind("change",tax_filter_change).bind("change",{taxonomy:r,holder:n,dropdown:i},tax_filter_change)})}function tax_filter_change(e){$(this).attr("rel",$(e.data.holder).attr("id"));var t=$(this).val(),n=[];"string"==typeof(t=null==t?"":t)?""==t||n.push(t):$.each(t,function(e,t){if(""==t)return!0;n.push(t)});var a=e.data.dropdown;return $(n).toArray().length>0?(a.find("option").first().prop("selected",!1),a.find("option").first().removeAttr("selected")):(a.find("option").first().prop("selected",!0),a.find("option").first().attr("selected","selected")),a.selectpicker("render"),e.data.holder.find(".fbd-filter[data-taxonomy='"+e.data.taxonomy+"']").each(function(e,t){-1==$.inArray($(t).val(),n)?$(t).attr("checked",!1):$(t).attr("checked",!0)}),methods.apply_filter.apply($(this),[!1]),!0}function render_sidelist(e,t,n,a){$.each(t,function(t,r){!(r.skip_sidelist||!1)&&"rhc_gmap"==n&&has_sidelist_holder&&a.sidelist&&a.sidelist.template&&$(a.sidelist.template).length>0&&($(e).parent().find(".rhc-sidelist-holder").addClass("has-events"),sidelist=$(e).parent().find(".rhc-sidelist"),render_sidelist_event(sidelist,r,a))}),$(".rhc-sidelist-event-item").show()}function render_sidelist_event(e,t,n){jQuery(document).ready(function(a){var r=new Date(t.start),i=new Date;if(i.setHours(0,0,0,0),r.getTime()<i.getTime())return!1;var o=a(n.sidelist.template).clone();if(o.attr("id","").addClass("rhc-sidelist-event-item"),t.url&&""!=t.url&&"javascript:void(0);"!=t.url){var s=n.sidelist.link_target||"_BLANK";s=""==s?"_BLANK":s;l=a('<a href="'+t.url+'">'+t.title+"</a>").attr("target",s).attr("href","javascript:void(0);").bind("click",function(e){var a=n.eventClick?n.eventClick:fc_click;t.fc_click_link="page",t.fc_click_target=s,a(t,e,null)})}else var l=a("<span></span").html(t.title);o.find(".rhc-sidelist-title").empty().append(l);var d=o.find(".rhc-sidelist-date").html();if(o.find(".rhc-sidelist-date").html(a.fullCalendar.formatDate(t.start,d,n)),t.image&&t.image[0]&&""!=t.image[0])var c=a("<img></img>").attr("src",t.image[0]);t.venue_directory&&o.addClass("venue-directory-item").find(".rhc-sidelist-date").hide(),o.find(".rhc-sidelist-image").append(c),e.append(o.show())})}function cb_events_loading(e,t,n,a,r,i){i.for_widget?(a.loading&&a.loading(n,a,i),handle_loading_overlay(e,t,n,a,r,i),n?$(e).find(".fc-have-event").each(function(e,t){$(this).removeClass("fc-state-highlight").removeClass("fc-have-event").css("background-image","")}):cb_events_loaded(t,r,a,i)):(a.loading&&a.loading(n,a,i),n||cb_events_loaded(t,r,a,i),handle_loading_overlay(e,t,n,a,r,i))}function handle_loading_overlay(e,t,n,a,r,i){void 0!==i.loadingOverlay&&"1"==i.loadingOverlay&&(n?(0==$(e).find(".fc-content .fc-view-loading").length&&$(e).find(".fullCalendar .fc-content").prepend($('<div class="fc-view-loading"></div>').hide().append('<div class="fc-view-loading-1 ajax-loader"><div class="fc-view-loading-2x xspinner icon-xspinner-3"></div></div>')),$(e).addClass("is-loading").find(".fc-view-loading").addClass("loading-events").find(".ajax-loader").addClass("loading-events").end().stop().fadeIn()):$(e).removeClass("is-loading").find(".fc-view-loading").stop().fadeOut("fast",function(){$(e).find().remove(".fc-view-loading"),"rhc_event"==a.name&&$(e).find(".fc-view-rhc_event").css("min-height","")}))}function cb_events_loaded(e,t,n,a){if(calendar=e,(!a.tax_filter||"1"==a.tax_filter)&&0!=$(calendar).find(".fc-head-control").length){var r=$(calendar).fullCalendar("clientEvents"),i=[];if($.each(r,function(e,t){t.terms&&t.terms.length>0&&$.each(t.terms,function(e,n){if(a.tax_filter_include&&a.tax_filter_include.length>0){if(-1==$.inArray(n.taxonomy,a.tax_filter_include))return}else if(a.tax_filter_skip&&-1!=$.inArray(n.taxonomy,a.tax_filter_skip))return;for(var r=-1,o=0;o<i.length;o++)if(i[o].taxonomy==n.taxonomy){r=o;break}var s="",l={value:s=n.gaddress?n.gaddress:n.description?n.description:n.name?n.name:"unknown",order:n.term_priority?parseInt(n.term_priority):0,local_feed:t.local_feed,term:n};-1==r?i[i.length]={taxonomy:n.taxonomy,label:n.taxonomy_label,terms:[s],uterms:[l],print_priority:n.print_priority?parseInt(n.print_priority):0,filter_type:n.filter_type?n.filter_type:"",color:n.color||"",background_color:n.background_color||""}:-1==$.inArray(s,i[r].terms)&&(i[r].terms.push(s),i[r].uterms.push(l))})}),a.tax_filter_include&&a.tax_filter_include.length>0&&i.length>0&&(new_taxonomies=[],$.each(a.tax_filter_include,function(e,t){$.each(i,function(e,n){t==n.taxonomy&&(new_taxonomies[new_taxonomies.length]=n)})}),i=new_taxonomies),i.length>0){var o=$(calendar).find(".fc-head-control .tax_filter_holder");o.empty(),o.parents(".fc-head-control").removeClass("has-filters"),a.btn_tax_parent_only?arr_btn_tax_parent_only=a.btn_tax_parent_only.split(","):arr_btn_tax_parent_only=[],$.each(i,function(e,t){if(0!=t.terms.length){t.uterms.sort(cb_sort_tax_filter),t.terms=[];var n=!1,a=!1;$.each(t.uterms,function(e,r){n&&n!=r.order&&(a=!0),n=r.order,t.terms.push(r.value)}),a||(t.terms.sort(),t.uterms.sort(cb_sort_alphanum));var r=$("<select></select>").attr("title",t.label).attr("multiple","multiple").addClass("tax_filter_field").addClass("selectpicker").data("taxonomy",t.taxonomy).data("taxonomy_filter_type",t.filter_type).append('<option value="">'+t.label+"</option>");$.each(t.uterms,function(e,n){if(arr_btn_tax_parent_only.length>0&&parseInt(n.term.parent))for(var a=0;a<arr_btn_tax_parent_only.length;a++)if(t.taxonomy==arr_btn_tax_parent_only[a])return;bgcolor=n.term.background_color||"transparent",option_label=n.term&&n.term.name?n.term.name:n.value,_option=$('<option value="'+n.value+'">'+option_label+"</option>").data("term",n),_option.attr("data-bgcolor",bgcolor),r.append(_option)}),r.appendTo(o).wrap('<div class="tax_filter_item_holder"></div>').selectpicker({style:"btn-small btn-taxfilter"});var i=!1,s=r.parent().find(".dropdown-menu");r.find("option").each(function(e,t){bgcolor=$(t).attr("data-bgcolor")||"transparent","transparent"!=bgcolor&&(i=!0),s.find('li[rel="'+e+'"] a').prepend($('<span class="rhc-term-color"></span>').css("background-color",bgcolor).addClass("transparent"==bgcolor?"rhc-no-color":""))}),i&&s.addClass("rhc-with-tax-color"),o.parents(".fc-head-control").addClass("has-filters")}}),o.find(".tax_filter_field").change(function(e){var t=$(this).parents(".fullCalendar"),n=[];$(t).find(".tax_filter_field").each(function(e,t){$(t).find("option:selected").each(function(e,a){var r=$(a).attr("value");if(""!=r){var i=$(t).data("taxonomy_filter_type"),o=$(a).data("term");n.push({taxonomy:$(t).data("taxonomy"),term:r,filter_type:i,slug:o.term&&o.term.slug?o.term.slug:null,term_id:o.term&&o.term.term_id?o.term.term_id:null,local_feed:o.local_feed})}})}),$(t).parent().find(".rhc-sidelist").length>0&&($(t).parent().find(".rhc-sidelist-holder").removeClass("has-events"),$(t).parent().find(".rhc-sidelist").empty()),args={tax_filters:n},a.show_ad&&(args.show_ad=a.show_ad),$(t).data("rhc_tax_filters",n).fullCalendar("rerenderEvents"),$("BODY").trigger("rhc_filter",args)})}}}function cb_view_display(e,t,n,a){t||(t=$(n.element).parents(".fullCalendar")),set_fc_small(t);var r=$(t).fullCalendar("getView");"rhc_gmap"==r.name?$(t).find(".fc-head-control").addClass("show-control"):$(t).find(".fc-head-control").removeClass("show-control"),"rhc_event"==r.name?$(a).parents(".rhc_holder").addClass("view-rhc_event"):$(a).parents(".rhc_holder").removeClass("view-rhc_event"),$(t).data("rhc_tax_filters",[]),$(t).find(".tax_filter_field").each(function(e,t){$(t).val("")});var i=new Date;if(n.visStart<=i&&n.visEnd>=i?$(a).parents(".rhc_holder").addClass("has-current-date").removeClass("not-current-date"):$(a).parents(".rhc_holder").removeClass("has-current-date").addClass("not-current-date"),"month"==n.name&&$(a).parents(".rhc_holder").find(".fc-today").length>0&&$(a).parents(".rhc_holder").find(".fc-today").is(".fc-other-month")&&$(a).parents(".rhc_holder").removeClass("has-current-date").addClass("not-current-date"),$(a).parents(".rhc_holder").is(".flat-ui-cal")){var o=$(t).parents(".rhc_holder").data("Calendarize"),s=o.modes[o.mode].options;if($(a).parents(".rhc_holder").is(".has-current-date")){try{l=$("<div/>").html(s.widget_hformat).text()}catch(e){var l=null}var d=l||"'<span class=''fuiw-dayname''>'dddd'</span><span class=''fuiw-month''>'MMMM'</span><span class=''fuiw-year''>'yyyy'</span><span class=''fuiw-day''>'d'</span>'";$(t).find(".fc-header-title h2").html($.fullCalendar.formatDate(i,d,s))}else{str=$(t).find(".fc-header-title h2").html(),str=str.trim();var c=str.split(" ");2==c.length&&(d=isNaN(c[1])?"<span class='fuiw-month'>"+c[1]+"</span><span class='fuiw-year'>"+c[0]+"</span>":"<span class='fuiw-month'>"+c[0]+"</span><span class='fuiw-year'>"+c[1]+"</span>",$(t).find(".fc-header-title h2").html(d))}_skip=!(!s.widget_onechardaylabel||1!=parseInt(s.widget_onechardaylabel)),_skip||$(t).find(".fc-day-header").each(function(e,t){$(t).html($(t).html().substring(0,1))})}}function cb_sort_tax_filter(e,t){return e.order>t.order?1:e.order<t.order?-1:0}function cb_sort_alphanum(e,t){a=e.value.toString(),b=t.value.toString();var n=/[^a-zA-Z]/g,r=/[^0-9]/g,i=a.replace(n,""),o=b.replace(n,"");if(i===o){var s=parseInt(a.replace(r,""),10),l=parseInt(b.replace(r,""),10);return s===l?0:s>l?1:-1}return i>o?1:-1}function add_footer_button(e){var t=$.extend({calendarize:null,calendar:null,e:null,tm:"fc",buttonName:"undefined",label:"",buttonClick:function(e,t,n){}},e);tm=t.tm;var n=$("<span class='fc-button fc-button-"+t.buttonName+" "+tm+"-state-default '><span class='fc-button-inner'><span class='fc-button-content'>"+t.label+"</span><span class='fc-button-effect'><span></span></span></span></span>");n&&(n.click(function(e){n.hasClass(tm+"-state-disabled")||t.buttonClick(this,e,t)}).mousedown(function(){n.not("."+tm+"-state-active").not("."+tm+"-state-disabled").addClass(tm+"-state-down")}).mouseup(function(){n.removeClass(tm+"-state-down")}).hover(function(){n.not("."+tm+"-state-active").not("."+tm+"-state-disabled").addClass(tm+"-state-hover")},function(){n.removeClass(tm+"-state-hover").removeClass(tm+"-state-down")}).appendTo(t.e),n.addClass(tm+"-corner-left"),n.addClass(tm+"-corner-right"))}function ical_footer_button_click(e,t,n){var a=n.calendarize;if(f,$(e).parent().find(".ical-tooltip").length>0)$(e).parent().find(".ical-tooltip").remove();else{var r=$(a).data("Calendarize"),i=r.modes[r.mode].options,o=i.events_source+i.events_source_query,s=(o=o.replace("get_calendar_events","get_icalendar_events"))+"&ics=1",l=i.feed&&""!=i.feed?"&feed="+i.feed:"";o+=l,s+=l;var d=$(".ical-tooltip-template").first().clone();d.removeClass("ical-tooltip-template").addClass("ical-tooltip").addClass("rhc-ical-dialog").find(".ical-url").html(o).end().find(".ical-clip").attr("href",o).on("click",function(e){return $(this).focus(),$(this).select(),!1}).end().find(".ical-close").on("click",function(e){$(this).parents(".fc-footer").find(".fc-button-icalendar").trigger("click")}).end().find(".ical-ics").attr("href",s).end().show(),$(e).after(d),setTimeout(function(){d.addClass("rhc-ical-dialog-open")},50)}}function cb_dayclick(e,t,n,a,r,i){if(r.dayclick){if(o=!(!r.dayclick||""==r.dayclick||!window[r.dayclick])&&window[r.dayclick])return o(e,t,n,a,r,i)}else{var o=!(!r.widget_dayclick||""==r.widget_dayclick||!window[r.widget_dayclick])&&window[r.widget_dayclick];if(o)calendar_widget_day_click(e,t,n,a,rhc_events_cache,r,i);else if(r.widget_link){if(r.widget_link_view)s=r.widget_link_view;else var s="agendaDay";$('<form method="post" />').attr("action",r.widget_link).append('<input type="hidden" name="gotodate" value="'+$.fullCalendar.formatDate(e,"yyyy-MM-dd")+'" />').append('<input type="hidden" name="defaultview" value="'+s+'" />').append('<input type="hidden" name="fcalendar" value="'+(r.ev_calendar?r.ev_calendar:"")+'" />').append('<input type="hidden" name="fvenue" value="'+(r.ev_venue?r.ev_venue:"")+'" />').append('<input type="hidden" name="forganizer" value="'+(r.ev_organizer?r.ev_organizer:"")+'" />').appendTo(i).submit()}}}var methods={init:function(e){function t(e,t){if(e.hasClass("fbd-cell")||(e=e.parents(".fbd-cell")),t.hasClass("fbd-checked"))n={opacity:0,left:-30};else var n={opacity:0,left:30};if(0==t.find(".fbd-cell").length)$(e).animate(n,"fast","linear",function(){$(this).appendTo(t).css("left",-1*n.left).animate({opacity:1,left:0})});else{var r=t.find(".fbd-cell");if(parseInt($(e).data("tab-index"))>parseInt($(r[r.length-1]).data("tab-index")))$(e).animate(n,"fast","linear",function(){$(this).appendTo(t).css("left",-1*n.left).animate({opacity:1,left:0})});else if(parseInt($(e).data("tab-index"))<parseInt($(r[0]).data("tab-index")))$(e).animate(n,"fast","linear",function(){$(r[0]).before(e).prev().css("left",-1*n.left).animate({opacity:1,left:0})});else for(a=0;a<r.length;a++){var i=r[a];if(parseInt($(e).data("tab-index"))>parseInt($(r[a]).data("tab-index"))&&parseInt($(e).data("tab-index"))<parseInt($(r[a+1]).data("tab-index"))){$(e).animate(n,"fast","linear",function(){$(i).after($(this).css("left",-1*n.left).animate({opacity:1,left:0}))});break}}}}if(void 0!==e){var n=$.extend({editable:!1,mode:"view"},e);return $(".fc-dialog").CalendarizeDialog(),this.each(function(){if(!$(this).data("Calendarize")){if($(this).data("Calendarize",n).Calendarize("mode",n.mode),0==$(this).find(".rhc-sidelist").length&&($('<div class="rhc-sidelist-holder"><div class="rhc-sidelist-tab"><div class="rhc-sidelist-tab-label"></div></div><div class="rhc-sidelist-head"></div><div class="rhc-sidelist"></div></div>').appendTo(this),$(this).find(".rhc-sidelist-tab").click(function(e){$(this).parents(".rhc-sidelist-holder").toggleClass("sidelist-open")}),parseInt(n.modes[n.mode].options.sidelist.open)&&$(this).find(".rhc-sidelist-tab").trigger("click")),0==$(this).find("fullCalendar > .fc-head-control").length){$(this).find(".fc-header").length>0&&($(this).find(".fc-header").after('<div class="fc-head-control rh-flat-ui"><div class="tax_filter_nav"><a href="#" class="tax_filter_previous btn btn-small btn-taxfilter fui-arrow-left"></a></div><div class="tax_filter_holder_viewport"><div class="tax_filter_holder"></div></div></div>'),$(this).find(".tax_filter_previous").click(function(e){var t=$(this).parents(".fc-head-control").find(".tax_filter_holder");if(t.stop(!1,!0),t.find(".tax_filter_item_holder").length>0){var n=t.find(".tax_filter_item_holder").first();n.stop(!1,!0);var a=-1*n.outerWidth(!0),r=n.css("opacity");n.animate({opacity:0},400,"swing"),t.animate({"margin-left":a},500,"swing",function(){n.stop(!1,!0).appendTo(t).css("opacity",r),$(this).css("margin-left",0)})}}))}0==$(this).find(".fc-lower-head-tools").length&&($(this).find(".fc-header").after('<div class="fc-lower-head-tools"></div>'),0==$(this).find(".fc-lower-head-tools .fc-filters-dialog").length&&$(this).find(".fc-filters-dialog-holder .fc-filters-dialog").clone().appendTo($(this).find(".fc-lower-head-tools")));var e=.6*parseInt($(this).find(".fc-content").innerHeight());e=e<300?300:e,$(this).find(".fc-lower-head-tools .fc-filters-dialog").find(".fbd-unchecked").css("max-height",e+"px"),$(this).find(".fc-filters-dialog .fbd-tabs").on("click",function(e){$(this).parent().parent().find(".fbd-tabs").removeClass("fbd-active-tab").end().find(".fbd-tabs-panel").hide().end().find($(this).find("a").data("tab-target")).show(),$(this).addClass("fbd-active-tab")}).first().trigger("click"),$(this).find('.fbd-cell input[type="checkbox"]').attr("checked",!1),$(this).find('.fbd-cell input[type="checkbox"]').on("click",function(e){if($(this).is(":checked"))n=$(this).parent().parent().parent().parent().find(".fbd-checked");else var n=$(this).parent().parent().parent().parent().find(".fbd-unchecked");t($(this).parent().parent(),n)}),$(this).find(".fullCalendar .fbd-dg-apply,.fullCalendar .fbd-dg-remove").attr("rel",$(this).attr("id")),$(this).find(".fullCalendar .fbd-dg-apply").on("click",function(e){return methods.apply_filter.apply($(this),[])}),$(this).find(".fbd-close-tooltip a").unbind("click").click(function(e){$(this).parents(".fullCalendar").find(".fc-button-rhc_search").trigger("click")}),$(this).find(".fullCalendar .fbd-dg-remove").on("click",function(e){$(this).parents(".rhc_holder").find("input[name=s]").val("").trigger("change"),$("#"+$(this).attr("rel")).find("input[type=checkbox].fbd-filter").each(function(e,n){if(void 0!==$(n).attr("checked")){$(n).attr("checked",!1);var a=$(this).parent().parent().parent().parent().find(".fbd-unchecked");t($(this).parents(".fbd-cell"),a)}}).end().find(".fbd-dg-apply").trigger("click"),$(this).closest(".fullCalendar").fullCalendar("gotoDate",$(this).closest(".fullCalendar").data("starting_date")),$(this).parents(".fullCalendar").find(".fc-button-rhc_search").trigger("click")}),$(this).find(".fullCalendar .fc-header").on("click",function(e){$(".fct-tooltip").trigger("close-tooltip")}),$(document).keyup(function(e){27==e.keyCode&&($(".fct-tooltip").trigger("close-tooltip"),$(".fc-filters-dialog:visible").stop().find(".fbd-unchecked").css("overflow-y","hidden").end().animate({opacity:0,top:-10},"fast","linear",function(){$(this).hide()}))}),0==$(this).find("fc-view-loading-bottom").length&&$(this).find(".fullCalendar .fc-footer").before($('<div class="fc-view-loading-bottom"></div>').append($('<div class="fc-view-loading-bottom-1"><div class="fc-view-loading-bottom-2 fc-next-arrow"></div></div>').click(function(e){$(this).parents(".rhc_holder").find(".fullCalendar").fullCalendar("next")}))),$(this).trigger("rhc_loaded")}})}},mode:function(e){var t=this,n=$(this).data("Calendarize");if(n&&n.modes){var a=$.extend(n.common,n.modes[e].options);preload_events(this,a),a.for_widget?(a.eventRender=function(e,t,n){return cb_event_render(i,!0,e,t,n,a)},a.eventAfterAllRender=function(e){return hide_widget_event_list(i,!1,null,null,e,a),cb_event_render_all(i,!0,null,null,e,a)},a.dayClick=function(e,n,r,i){return cb_dayclick(e,n,r,i,a,t)}):(a.eventRender=function(e,t,n){return"rhc_grid"!=n.name&&$(".fc-event-title",t).html(e.title),cb_event_render(i,!1,e,t,n,a)},a.eventAfterAllRender=function(e){return cb_event_render_all(i,!1,null,null,e,a)}),a.loading=function(e,n){return cb_events_loading(t,this,e,n,i,a)},a.eventDataTransform=function(e){if(e.start&&e.start.getFullYear){e.terms||(e.terms=[]);var t=parseInt(e.start.getMonth()),n={filter_type:"AND",term_priority:t,description:$.fullCalendar.formatDate(e.start,"MMMM",a),taxonomy:"core_month",taxonomy_label:a.tax_filter_label&&a.tax_filter_label.month?a.tax_filter_label.month:"month",slug:$.fullCalendar.formatDate(e.start,"M",a)};e.terms.unshift(n);var r=e.start.getFullYear(),n={filter_type:"AND",term_priority:parseInt(r),description:r,taxonomy:"core_year",taxonomy_label:a.tax_filter_label&&a.tax_filter_label.year?a.tax_filter_label.year:"year",slug:parseInt(r)};if(e.terms.unshift(n),e.end){for(year_end=e.end.getFullYear(),current_year=r,i=0;i++<10&&year_end>current_year;){current_year++;n={filter_type:"AND",term_priority:parseInt(current_year),description:current_year,taxonomy:"core_year",taxonomy_label:a.tax_filter_label&&a.tax_filter_label.year?a.tax_filter_label.year:"year",slug:parseInt(current_year)};e.terms.unshift(n)}if(month_end=parseInt(e.end.getMonth()),start_date=new Date(r,t,15,0,0,0,0),end_date=new Date(year_end,month_end,15,0,0,0,0),current_date=new Date(new Date(start_date).setMonth(start_date.getMonth()+1)),end_date.getTime()>start_date.getTime())for(var i=0;i<11;i++){n={filter_type:"AND",term_priority:parseInt(current_date.getMonth()),description:$.fullCalendar.formatDate(current_date,"MMMM",a),taxonomy:"core_month",taxonomy_label:a.tax_filter_label&&a.tax_filter_label.month?a.tax_filter_label.month:"month",slug:$.fullCalendar.formatDate(current_date,"M",a)};if(e.terms.unshift(n),!(end_date.getTime()>current_date.getTime()))break;current_date=new Date(new Date(current_date).setMonth(current_date.getMonth()+1))}}}return e};a.eventSources=[],"1"!=a.json_only&&a.eventSources.push(function(e,t,n){$.fn.Calendarize.events_source(e,t,n,a)}),a.json_feed&&a.json_feed.length>0&&("1"==a.json_only&&(a.events=null,a.singleSource=null),a.json_feed&&a.json_feed.length>0&&$.each(a.json_feed,function(e,t){if(t.rhc_feed&&"1"==t.rhc_feed){a.eventSources[a.eventSources.length]=function(e,n,r){$.fn.Calendarize.rhc_feed_src(e,n,r,t,a)}}else{a.eventSources[a.eventSources.length]=function(e,n,r){$.fn.Calendarize.ext_events_source(e,n,r,t,a)}}})),a.viewRender=function(e,t){cb_view_display(a.for_widget,i,e,t)},a.eventMouseover=function(e,t,n){cb_event_mouseover(e,t,n),a.tooltip_on_hover&&"1"==a.tooltip_on_hover&&"view"==e.fc_click_link&&$(t.target).closest("a").click(),$(t.target).closest("a").addClass("event-hovered")},a.eventMouseout=function(e,t,n){$(t.target).closest("a").removeClass("event-hovered")},a.calendar_id=$(this).attr("id"),f=$(this).find(".fullCalendar").fullCalendar(a),n.editable&&0==f.find(".fc-edit-tools").length&&f.prepend('<div class="fc-edit-tools"></div>'),0==f.find(".fc-footer").length&&(f.append('<div class="fc-footer"></div>'),a.icalendar_align&&$(".fc-footer").css("text-align",a.icalendar_align).addClass("dlg-align-"+a.icalendar_align)),a.header&&0==(a.header.center+a.header.left+a.header.right).length&&($(this).find(".fc-header").css("display","none"),$(this).find(".fc-edit-tools").css("display","none"),$(this).find(".fc-head-control").css("display","none"),$(this).find(".fc-lower-head-tools").css("display","none"),$(this).find(".fc-header").attr("hello",1));var r=f.find(".fc-footer"),i=f,o=a.theme?"ui":"fc";if($(".ical-tooltip-template").length>0){var s=$(".ical-tooltip-template").first().data("button_text");add_footer_button({calendar:f,calendarize:t,e:r,tm:o,label:s,buttonName:"icalendar",buttonClick:ical_footer_button_click})}a.gotodate&&""!=a.gotodate&&$(this).find(".fullCalendar").fullCalendar("gotoDate",$.fullCalendar.parseDate(a.gotodate)),$(this).find(".fullCalendar").data("starting_date",$(this).find(".fullCalendar").fullCalendar("getDate")),render_tax_filters.apply(this,[a])}},destroy:function(){return this.each(function(){var e=$(this),t=e.data("Calendarize");$(window).unbind(".Calendarize"),t.Calendarize.remove(),e.removeData("Calendarize")})},apply_filter:function(e){return e=void 0===e||e,this.each(function(){var t="#"+$(this).attr("rel");$(t+" .fullCalendar").find(".bg_matched").each(function(e,t){$(t).css("background-color",$(t).data("original_bg")||"")});var n=[];$(t+" .fullCalendar").find(".fbd-filter-group").each(function(e,t){var a=[];$(t).find("input[type=checkbox].fbd-filter:checked").each(function(e,t){a[a.length]=$(t).val()}),a.length>0&&(n[n.length]={taxonomy:$(this).data("taxonomy"),terms:a.join(","),terms_array:a})});var a=$(t).data("Calendarize"),r=a.modes[a.mode].options;r.calendar_id=$(t).attr("id");var i=$(t+" .fullCalendar"),o=i.fullCalendar("getView");o.clear_events=!0,"rhc_year"==o.name&&(o.clearEvents(),i.find(".fc-have-event").removeClass("fc-have-event"));var s="";if(n&&$.each(n,function(e,t){r.replace_square_brackets?s+="&tax%5B"+t.taxonomy+"%5D="+t.terms:s+="&tax["+t.taxonomy+"]="+t.terms}),$(t).find(".fc-lower-head-tools  input[name=s]").length){var l=$(t).find(".fc-lower-head-tools  input[name=s]").val();""!=l&&(s+="&s="+escape(l))}r.events_source_query_original=r.events_source_query_original?r.events_source_query_original:r.events_source_query,""!=s?(i.fullCalendar("removeEventSources"),r.events_source_query=r.events_source_query_original+s):(i.fullCalendar("removeEventSources"),r.events_source_query=r.events_source_query_original);if(i.fullCalendar("addEventSource",function(e,t,n){$.fn.Calendarize.events_source(e,t,n,r)}),0==n.length)r.json_feed&&r.json_feed.length>0&&$.each(r.json_feed,function(e,t){if(t.rhc_feed&&"1"==t.rhc_feed){i.fullCalendar("addEventSource",function(e,n,a){$.fn.Calendarize.rhc_feed_src(e,n,a,t,r)})}else{i.fullCalendar("addEventSource",function(e,n,a){$.fn.Calendarize.ext_events_source(e,n,a,t,r)})}});else{var d=[];$.each(n,function(e,t){$.each(t.terms_array,function(e,n){r.json_feed&&r.json_feed.length>0&&$.each(r.json_feed,function(e,a){if(!($.inArray(a,d)>-1)&&a.terms&&a.terms.length>0)for(var e=0;e<a.terms.length;e++)if(a.terms[e].taxonomy==t.taxonomy&&a.terms[e].slug==n)return void(-1==$.inArray(a,d)&&d.push(a))})})}),$.each(d,function(e,t){if(t.rhc_feed&&"1"==t.rhc_feed){i.fullCalendar("addEventSource",function(e,n,a){$.fn.Calendarize.rhc_feed_src(e,n,a,t,r)})}else{i.fullCalendar("addEventSource",function(e,n,a){$.fn.Calendarize.ext_events_source(e,n,a,t,r)})}})}"rhc_gmap"!=o.name&&"rhc_grid"!=o.name||(o.clear_events=!0,$(this).closest(".fullCalendar").fullCalendar("gotoDate",$(this).closest(".fullCalendar").data("starting_date"))),e&&$(this).parents(".fullCalendar").find(".fc-button-rhc_search").trigger("click"),$(this).closest(".fullCalendar").find(".fc-no-list-events-message").hide()})}};$.fn.Calendarize=function(e){return methods[e]?methods[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void $.error("Method "+e+" does not exist on jQuery.Calendarize"):methods.init.apply(this,arguments)};var rhc_events_cache=[];$.fn.Calendarize.rhc_feed_src=function(e,t,n,a,r){jQuery(document).ready(function(i){for(var o=[],s=new Date,l=RHC.last_modified&&""!=RHC.last_modified?RHC.last_modified:s.getTime(),d={start:Math.round(e.getTime()/1e3),end:Math.round(t.getTime()/1e3),_:l,"data[]":o},c=0;c<rhc_events_cache.length;c++)if(rhc_events_cache[c].start<=d.start&&rhc_events_cache[c].end>=d.end&&rhc_events_cache[c].url==a.url)return parseInt(r.debugjs)&&rhc_console("rhc_feed_src.  Loading from rhc_events_cache."),void n(rhc_events_cache[c].events);var f=d;f.url=a.url,i.post(a.url,d,function(a){if("OK"==a.R){var r=[];r=rhc_events_to_fc_events(e,t,a,!1),f.events=r,in_rhc_events_cache(f.start,f.end,f.url)||(rhc_events_cache[rhc_events_cache.length]=f),n(r)}else a.R},"json")})},$.fn.Calendarize.ext_events_source=function(e,t,n,a,r){jQuery(document).ready(function(i){for(var o=[],s=new Date,l=RHC.last_modified&&""!=RHC.last_modified?RHC.last_modified:s.getTime(),d={start:Math.round(e.getTime()/1e3),end:Math.round(t.getTime()/1e3),_:l,"data[]":o},c=0;c<rhc_events_cache.length;c++)if(rhc_events_cache[c].start<=d.start&&rhc_events_cache[c].end>=d.end&&rhc_events_cache[c].url==a.url)return parseInt(r.debugjs)&&rhc_console("rhc_feed_src.  Loading from rhc_events_cache."),void n(rhc_events_cache[c].events);var f=d;f.url=a.url,i.post(a.url,d,function(e){f.events=e,in_rhc_events_cache(f.start,f.end,f.url)||(rhc_events_cache[rhc_events_cache.length]=f),n(f.events)},"json")})},$.fn.Calendarize.events_source=function(e,t,n,a){jQuery(document).ready(function(r){function i(r){if("OK"==r.R){var i=[];i=allday_group(i=handle_local_tz(i=rhc_events_to_fc_events(e,t,r,!0),a,r),a),u.events=i,in_rhc_events_cache(u.start,u.end,u.url)||(rhc_events_cache[rhc_events_cache.length]=u),n(i)}else r.R}var o=[];r(".calendarize_meta_data").each(function(e,t){"checkbox"==t.type?o[o.length]=[t.name,r(t).is(":checked")?1:0]:o[o.length]=[t.name,r(t).val()]});var s=a.events_source+a.events_source_query;"undefined"!=typeof icl_lang?s+="&lang="+icl_lang:"undefined"!=typeof icl_vars&&icl_vars.current_language&&(s+="&lang="+icl_vars.current_language),a.calendar_id&&""!=a.calendar_id?(vo=r("#"+a.calendar_id).find(".fullCalendar").fullCalendar("getView"),view_name=vo.name):view_name="";for(var l=new Date,d=RHC.last_modified&&""!=RHC.last_modified?RHC.last_modified:l.getTime(),c={start:Math.round(e.getTime()/1e3),end:Math.round(t.getTime()/1e3),rhc_shrink:a.shrink?parseInt(a.shrink):"",view:view_name,ver:d,_:"","data[]":o},f=0;f<rhc_events_cache.length;f++)if(rhc_events_cache[f].start<=c.start&&rhc_events_cache[f].end>=c.end&&rhc_events_cache[f].url==s)return parseInt(a.debugjs)&&rhc_console("Loading from rhc_events_cache."),void n(rhc_events_cache[f].events);var u=c;u.url=s,s=s+"&start="+c.start+"&end="+c.end+"&rhc_shrink="+c.rhc_shrink+"&view="+c.view+"&ver="+c.ver,o.length>0&&r.each(o,function(e,t){s=s+"&data["+e+"][0]="+t[0],s=s+"&data["+e+"][1]="+t[1]}),queryString=s.substring(s.indexOf("?")+1),hash=CryptoJS.MD5(queryString),c._=hash.toString(CryptoJS.enc.Hex),s=s+"&_="+c._,r.ajax({url:s,type:"GET",contentType:"application/json; charset=utf-8",dataType:"json",cache:!0,success:function(e){i(e)},error:function(e,t,n){if("parsererror"==t){var a=!1;try{response=e.responseText.replace(/<!--[\s\S]*?-->/g,""),i(o=r.parseJSON(response)),a=!0}catch(e){}if(!a)try{if(j=e.responseText.indexOf('{"R":'),j>0){var s=e.responseText;s=s.substring(j),i(o=r.parseJSON(s)),a=!0}else-1==j&&console.log("RHC:ajax response is not valid.  Try using the Api url option in the troubleshooting section")}catch(e){}a||console.log("RHC:Could not recover data from bad ajax response; try turning on the option Catch php warnings in troubleshooting.  Or disable php warnings.")}}})})},$.fn.RHCLink=function(e,t){var n=t,a=t.calendar,r=a.options,i=($.extend({eventClick:"fc_click"},r),e.fc_click_target||"_self");return e.gcal||""==e.url?$(this):e.direct_link?$(this).wrap($("<a></a>").attr("href",e.url).attr("target",i)).parent():$(this).wrap($("<a></a>").attr("target",i).attr("href",e.url).unbind("click").bind("click",function(t){return(a.options.eventClick?a.options.eventClick:fc_click)(e,t,n)})).parent()};var sidelist_events=[]}(jQuery),function(e){var t={init:function(t){var n=e.extend({draggable:!0},t);return this.each(function(){e(this).data("CalendarizeDialog")||(e(this).data("CalendarizeDialog",n),n.draggable&&e(this).draggable({handle:".ui-widget-header"}),e(this).find(".ui-dialog-titlebar-close").on("click",function(t){e(this).parent().parent().parent().CalendarizeDialog("close")}),j),e(this).hide()})},open:function(t){opacity=e(this).css("opacity"),e(this).css("opacity",0).show().css("margin-left",0).offset(t.offset).css("margin-left",t.margin_left);var n=this.get()[0].getBoundingClientRect();n.right>e(window).width()&&(margin_left=t.margin_left+-1*(5+n.right-e(window).width()),e(this).css("margin-left",margin_left)),e(this).animate({opacity:opacity},200,function(){})},close:function(){e(this).hide()}};e.fn.CalendarizeDialog=function(n){return t[n]?t[n].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof n&&n?void e.error("Method "+n+" does not exist on jQuery.CalendarizeDialog"):t.init.apply(this,arguments)}}(jQuery),function(e){function t(t){var n=[];return t.children().each(function(t,a){n.push({name:e(a).html(),lon:e(a).data("glon"),lat:e(a).data("glat"),info:e(a).data("ginfo"),address:e(a).data("gaddress"),marker_active:e(a).data("marker_active"),marker_inactive:e(a).data("marker_active"),marker_size:e(a).data("marker_size")})}),n}function n(t,a,r){if(++r>10)return!1;if("interactive"!=t.data("type"))return!1;if(0==a.length)return!1;for(var i=0;i<a.length;i++)if(!a[i].lat&&!a[i].lon&&a[i].address)return void(new google.maps.Geocoder).geocode({address:a[i].address},function(e,a){return function(i,o){return o==google.maps.GeocoderStatus.OK&&(latlng=i[0].geometry.location,e[a].lat=latlng.lat(),e[a].lon=latlng.lng()),n(t,e,r)}}(a,i));t.uniqueId(),ratio=t.data("ratio"),ratio=""==ratio?"4:3":ratio,ratio_arr=ratio.split(":"),h=t.width()*ratio_arr[1]/ratio_arr[0],t.height(h),maptype=t.data("maptype")||"ROADMAP",settings={mapTypeId:google.maps.MapTypeId[maptype],center:new google.maps.LatLng(a[0].lat,a[0].lon)},t.data("zoom")&&(settings.zoom=t.data("zoom"));var o=new google.maps.Map(t.get(0),settings),s=new google.maps.LatLngBounds,l=new google.maps.InfoWindow;e.each(a,function(e,t){marker=new google.maps.Marker({position:new google.maps.LatLng(t.lat,t.lon),map:o}),s.extend(marker.position),google.maps.event.addListener(marker,"click",function(e,n){return function(){l.setContent(t.info||t.name||t.address),l.open(o,e)}}(marker))}),a.length>1&&o.fitBounds(s)}var a={init:function(a){e.extend({todo:!1},a);return this.each(function(){var a=e(this);if(!a.data("rhc_gmap"))return a.data("rhc_gmap",!0),n(a,t(a),0),!0})}};e.fn.rhcGmap=function(t){return a[t]?a[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void e.error("Method "+t+" does not exist on jQuery.rhcGmap"):a.init.apply(this,arguments)}}(jQuery),jQuery(document).ready(function(e){init_rhc(),init_rhc_date_local_tz();try{window.matchMedia("print").addListener(function(){try{e(".rhc_holder .fullCalendar").fullCalendar("refetchEvents"),e(".rhc_holder .fullCalendar").fullCalendar("render")}catch(e){console.log("error",e)}})}catch(e){console.log(e)}});